<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://unpkg.com/@tailwindcss/browser@4"></script>
    <title>Inference Results</title>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const slider = document.getElementById("stepsRange");
            const steps = document.querySelectorAll(".step");
            slider.addEventListener("input", function () {
                steps.forEach(step => step.classList.remove("active"));
                steps[slider.value].classList.add("active");
            });
        });
    </script>
</head>
<body>
    {% for step in steps %}
    <div
        class="{% if forloop.first %} flex items-start gap-5 text-center h-[90vh] {% else %} hidden {% endif %}"
        id="step-{{ forloop.counter0 }}"
    >
        <div class="content-center w-1/2 h-full">
            <img class="max-w-full h-auto" src="{{ step.image.url }}" alt="Step Image">
        </div>
        <div class="border border-gray-300 p-2 w-1/2 m-auto max-h-[80vh] overflow-y-scroll">
            <h2>Step {{ step.number }}</h2>
            {% for agent_step in step.agent_steps.all %}
                <div>
                    <p class="flex justify-evenly">
                        <span><strong>Agent:</strong> {{ agent_step.agent }}</span>
                        <span><strong>Action:</strong> {{ agent_step.action }}</span>
                        <span><strong>Reward:</strong> {{ agent_step.reward }}</span>
                    </p>
                    <p><strong>Observation Space</strong></p>
                    <p>
                        <pre class="bg-gray-100 p-3 rounded-md font-mono whitespace-pre-wrap text-justify text-sm">
                            {{ agent_step.observation_space }}
                        </pre>
                    </p>
                    <hr>
                </div>
            {% empty %}
                <p>End of episode</p>
            {% endfor %}
        </div>
    </div>
    {% endfor %}
    <div>
        <input type="range" id="stepsRange" min="0" max="{{ steps|length|add:'-1' }}" value="0" class="w-full">
    </div>
</body>
</html>
