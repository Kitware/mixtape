<div
  x-data="{
    data: [],
    layout: {
      title: {text: 'Agent Observations Timeline'},
      height: 150,
      margin: {r: 0, t: 25},
    },
    plot: null,
  }"
  x-init="
    data = [
      {
        z: plotData.clustering.episode_clusters,
        type: 'heatmap',
        showscale: false,
        colorscale: 'YlGnBu',
      },
      {
        x: [[currentStep, currentStep]],
        y: [[0, plotData.clustering.episode_clusters.length - 1]],
        type: 'scatter',
        mode: 'lines',
        showlegend: false,
        line: {
          color: 'red',
          width: 4,
          opacity: 0.5,
        },
      }
    ];
    plot = Plotly.newPlot($refs.allManifolds, data, layout, {displayModeBar: false})"
  x-effect="
    if (plot) {
      // Get the current plot data from the DOM element
      const plotElement = $refs.allManifolds;
      const currentData = plotElement.data;
      const yMin = currentData[0]._extremes.y.min[0].val;
      const yMax = currentData[0]._extremes.y.max[0].val;
      Plotly.update($refs.allManifolds, {
        x: [[currentStep, currentStep]],
        y: [[yMin, yMax]],
      }, {}, [1]);
    }"
>
  <div x-ref="allManifolds"></div>
</div>
