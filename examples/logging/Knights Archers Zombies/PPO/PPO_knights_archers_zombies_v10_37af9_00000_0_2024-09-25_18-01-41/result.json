{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4560126387514174, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": -0.17462185101467184, "policy_loss": -0.0025945222470909355, "vf_loss": 0.02784295215115833, "vf_explained_var": -0.5702546812593937, "kl": 0.0006330929250566442, "entropy": 1.7911468207836152, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 160.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 512, "num_env_steps_trained": 512, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048, "num_env_steps_sampled": 512, "num_env_steps_trained": 512, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 234.05038284830857, "num_env_steps_trained_throughput_per_sec": 234.05038284830857, "timesteps_total": 512, "num_env_steps_sampled_lifetime": 512, "num_agent_steps_sampled_lifetime": 2048, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 2048, "timers": {"training_iteration_time_ms": 2187.573, "restore_workers_time_ms": 0.024, "training_step_time_ms": 2187.508, "sample_time_ms": 1303.648, "load_time_ms": 0.233, "load_throughput": 2200290.623, "learn_time_ms": 872.868, "learn_throughput": 586.572, "synch_weights_time_ms": 10.443}, "counters": {"num_env_steps_sampled": 512, "num_env_steps_trained": 512, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048}, "done": false, "training_iteration": 1, "trial_id": "37af9_00000", "date": "2024-09-25_18-01-49", "timestamp": 1727287309, "time_this_iter_s": 2.191530466079712, "time_total_s": 2.191530466079712, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2.191530466079712, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 12.75, "ram_util_percent": 26.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5380269223163204, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 2e-05, "total_loss": -0.18015127648268978, "policy_loss": -0.008414731111617819, "vf_loss": 0.02778866455412372, "vf_explained_var": -0.31374044226061915, "kl": 0.0013940123380228714, "entropy": 1.788231094037333, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 475.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled": 4056, "num_agent_steps_trained": 4056}, "env_runners": {"episode_reward_max": 6.0, "episode_reward_min": 2.0, "episode_reward_mean": 4.333333333333333, "episode_len_mean": 203.0, "episode_media": {}, "episodes_timesteps_total": 609, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 3.0}, "policy_reward_mean": {"default_policy": 1.0833333333333333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0], "episode_lengths": [183, 243, 183], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 49.28884648472728, "mean_inference_ms": 1.2381268537152756, "mean_action_processing_ms": 0.21578613113027292, "mean_env_wait_ms": 2.1313912828299473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010355313618977865, "StateBufferConnector_ms": 0.006453196207682292, "ViewRequirementAgentConnector_ms": 0.18425782521565756}, "num_episodes": 3, "episode_return_max": 6.0, "episode_return_min": 2.0, "episode_return_mean": 4.333333333333333, "episodes_this_iter": 3}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4056, "num_agent_steps_trained": 4056, "num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 33.56960598643096, "num_env_steps_trained_throughput_per_sec": 33.56960598643096, "timesteps_total": 1024, "num_env_steps_sampled_lifetime": 1024, "num_agent_steps_sampled_lifetime": 4056, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 4056, "timers": {"training_iteration_time_ms": 8719.738, "restore_workers_time_ms": 0.023, "training_step_time_ms": 8719.678, "sample_time_ms": 7855.876, "load_time_ms": 0.208, "load_throughput": 2455670.266, "learn_time_ms": 854.802, "learn_throughput": 598.969, "synch_weights_time_ms": 8.523}, "counters": {"num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled": 4056, "num_agent_steps_trained": 4056}, "done": false, "training_iteration": 2, "trial_id": "37af9_00000", "date": "2024-09-25_18-02-04", "timestamp": 1727287324, "time_this_iter_s": 15.256181478500366, "time_total_s": 17.447711944580078, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17.447711944580078, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 15.828571428571431, "ram_util_percent": 29.62857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.597717881600062, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": -0.17908816318774673, "policy_loss": -0.007397530923287074, "vf_loss": 0.0260996352902536, "vf_explained_var": -0.3966175417105357, "kl": 0.000563854570705189, "entropy": 1.7824373169740042, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 780.5, "diff_num_grad_updates_vs_sampler_policy": 149.5}}, "num_env_steps_sampled": 1536, "num_env_steps_trained": 1536, "num_agent_steps_sampled": 6025, "num_agent_steps_trained": 6025}, "env_runners": {"episode_reward_max": 11.0, "episode_reward_min": 2.0, "episode_reward_mean": 5.6, "episode_len_mean": 223.0, "episode_media": {}, "episodes_timesteps_total": 1115, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 6.0}, "policy_reward_mean": {"default_policy": 1.4}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0], "episode_lengths": [183, 243, 183, 343, 163], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 51.507355565040214, "mean_inference_ms": 1.2277217814677637, "mean_action_processing_ms": 0.21299385603998652, "mean_env_wait_ms": 2.117201934607034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009322166442871094, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.18491268157958984}, "num_episodes": 2, "episode_return_max": 11.0, "episode_return_min": 2.0, "episode_return_mean": 5.6, "episodes_this_iter": 2}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6025, "num_agent_steps_trained": 6025, "num_env_steps_sampled": 1536, "num_env_steps_trained": 1536, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 25.2769881455967, "num_env_steps_trained_throughput_per_sec": 25.2769881455967, "timesteps_total": 1536, "num_env_steps_sampled_lifetime": 1536, "num_agent_steps_sampled_lifetime": 6025, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 6025, "timers": {"training_iteration_time_ms": 12565.021, "restore_workers_time_ms": 0.021, "training_step_time_ms": 12564.966, "sample_time_ms": 11722.094, "load_time_ms": 0.24, "load_throughput": 2129735.849, "learn_time_ms": 833.404, "learn_throughput": 614.348, "synch_weights_time_ms": 8.976}, "counters": {"num_env_steps_sampled": 1536, "num_env_steps_trained": 1536, "num_agent_steps_sampled": 6025, "num_agent_steps_trained": 6025}, "done": false, "training_iteration": 3, "trial_id": "37af9_00000", "date": "2024-09-25_18-02-24", "timestamp": 1727287344, "time_this_iter_s": 20.25877285003662, "time_total_s": 37.7064847946167, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 37.7064847946167, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 11.406896551724138, "ram_util_percent": 29.31379310344828}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5399539864592013, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 2e-05, "total_loss": -0.1753742198549932, "policy_loss": -0.006392655641801896, "vf_loss": 0.03507045718457272, "vf_explained_var": -0.15645228220570473, "kl": 0.0009606635988991604, "entropy": 1.7777319181349969, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1085.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 8035, "num_agent_steps_trained": 8035}, "env_runners": {"episode_reward_max": 11.0, "episode_reward_min": 2.0, "episode_reward_mean": 4.857142857142857, "episode_len_mean": 217.28571428571428, "episode_media": {}, "episodes_timesteps_total": 1521, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 6.0}, "policy_reward_mean": {"default_policy": 1.2142857142857142}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 51.204373176939576, "mean_inference_ms": 1.22790218706695, "mean_action_processing_ms": 0.21195948935680456, "mean_env_wait_ms": 2.1113379765226465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009288106645856584, "StateBufferConnector_ms": 0.006045613970075335, "ViewRequirementAgentConnector_ms": 0.1789093017578125}, "num_episodes": 2, "episode_return_max": 11.0, "episode_return_min": 2.0, "episode_return_mean": 4.857142857142857, "episodes_this_iter": 2}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8035, "num_agent_steps_trained": 8035, "num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 35.88481126826745, "num_env_steps_trained_throughput_per_sec": 35.88481126826745, "timesteps_total": 2048, "num_env_steps_sampled_lifetime": 2048, "num_agent_steps_sampled_lifetime": 8035, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 8035, "timers": {"training_iteration_time_ms": 12990.737, "restore_workers_time_ms": 0.021, "training_step_time_ms": 12990.684, "sample_time_ms": 12143.648, "load_time_ms": 0.227, "load_throughput": 2252802.148, "learn_time_ms": 838.181, "learn_throughput": 610.847, "synch_weights_time_ms": 8.388}, "counters": {"num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 8035, "num_agent_steps_trained": 8035}, "done": false, "training_iteration": 4, "trial_id": "37af9_00000", "date": "2024-09-25_18-02-38", "timestamp": 1727287358, "time_this_iter_s": 14.270811557769775, "time_total_s": 51.977296352386475, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 51.977296352386475, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 14.51, "ram_util_percent": 28.970000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6699362769362427, "cur_kl_coeff": 0.012499999999999999, "cur_lr": 2e-05, "total_loss": -0.17311580002137963, "policy_loss": -0.007133907320037965, "vf_loss": 0.04263371203804479, "vf_explained_var": -0.053823383969645346, "kl": 0.0020688233685449073, "entropy": 1.7666617685748685, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 2560, "num_env_steps_trained": 2560, "num_agent_steps_sampled": 10045, "num_agent_steps_trained": 10045}, "env_runners": {"episode_reward_max": 11.0, "episode_reward_min": 2.0, "episode_reward_mean": 5.363636363636363, "episode_len_mean": 212.0909090909091, "episode_media": {}, "episodes_timesteps_total": 2333, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 6.0}, "policy_reward_mean": {"default_policy": 1.3409090909090908}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 53.050410757903755, "mean_inference_ms": 1.2235402489801936, "mean_action_processing_ms": 0.21056932484878066, "mean_env_wait_ms": 2.1073814564437003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009088082747025923, "StateBufferConnector_ms": 0.006190213290127841, "ViewRequirementAgentConnector_ms": 0.1854419708251953}, "num_episodes": 4, "episode_return_max": 11.0, "episode_return_min": 2.0, "episode_return_mean": 5.363636363636363, "episodes_this_iter": 4}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10045, "num_agent_steps_trained": 10045, "num_env_steps_sampled": 2560, "num_env_steps_trained": 2560, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 31.776984862187383, "num_env_steps_trained_throughput_per_sec": 31.776984862187383, "timesteps_total": 2560, "num_env_steps_sampled_lifetime": 2560, "num_agent_steps_sampled_lifetime": 10045, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 10045, "timers": {"training_iteration_time_ms": 13615.049, "restore_workers_time_ms": 0.019, "training_step_time_ms": 13614.999, "sample_time_ms": 12774.613, "load_time_ms": 0.234, "load_throughput": 2191757.142, "learn_time_ms": 831.253, "learn_throughput": 615.938, "synch_weights_time_ms": 8.657}, "counters": {"num_env_steps_sampled": 2560, "num_env_steps_trained": 2560, "num_agent_steps_sampled": 10045, "num_agent_steps_trained": 10045}, "done": false, "training_iteration": 5, "trial_id": "37af9_00000", "date": "2024-09-25_18-02-54", "timestamp": 1727287374, "time_this_iter_s": 16.11566925048828, "time_total_s": 68.09296560287476, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 68.09296560287476, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 20.804347826086957, "ram_util_percent": 30.095652173913045}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5457607750931094, "cur_kl_coeff": 0.0062499999999999995, "cur_lr": 2e-05, "total_loss": -0.18016348148906422, "policy_loss": -0.007444692632904456, "vf_loss": 0.018530186927490568, "vf_explained_var": -0.29558193068350513, "kl": 0.0017409581693794366, "entropy": 1.7736221798004643, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1705.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_agent_steps_sampled": 12082, "num_agent_steps_trained": 12082}, "env_runners": {"episode_reward_max": 11.0, "episode_reward_min": 0.0, "episode_reward_mean": 4.916666666666667, "episode_len_mean": 208.0, "episode_media": {}, "episodes_timesteps_total": 2496, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 6.0}, "policy_reward_mean": {"default_policy": 1.2291666666666667}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 53.58215139028272, "mean_inference_ms": 1.2219760619906643, "mean_action_processing_ms": 0.21008960784356104, "mean_env_wait_ms": 2.106810992578462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008894999821980795, "StateBufferConnector_ms": 0.006111462910970052, "ViewRequirementAgentConnector_ms": 0.18343329429626465}, "num_episodes": 1, "episode_return_max": 11.0, "episode_return_min": 0.0, "episode_return_mean": 4.916666666666667, "episodes_this_iter": 1}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12082, "num_agent_steps_trained": 12082, "num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 47.43982382073862, "num_env_steps_trained_throughput_per_sec": 47.43982382073862, "timesteps_total": 3072, "num_env_steps_sampled_lifetime": 3072, "num_agent_steps_sampled_lifetime": 12082, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 12082, "timers": {"training_iteration_time_ms": 13144.646, "restore_workers_time_ms": 0.018, "training_step_time_ms": 13144.598, "sample_time_ms": 12310.044, "load_time_ms": 0.246, "load_throughput": 2077204.883, "learn_time_ms": 825.918, "learn_throughput": 619.917, "synch_weights_time_ms": 8.154}, "counters": {"num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_agent_steps_sampled": 12082, "num_agent_steps_trained": 12082}, "done": false, "training_iteration": 6, "trial_id": "37af9_00000", "date": "2024-09-25_18-03-05", "timestamp": 1727287385, "time_this_iter_s": 10.795289039611816, "time_total_s": 78.88825464248657, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 78.88825464248657, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 7.75, "ram_util_percent": 30.16875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5493519953917712, "cur_kl_coeff": 0.0031249999999999997, "cur_lr": 2e-05, "total_loss": -0.17702055343206666, "policy_loss": -0.003861635777866468, "vf_loss": 0.017097294289851562, "vf_explained_var": -0.3871794959530234, "kl": 0.0018065978412747153, "entropy": 1.7743888385593891, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2020.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 3584, "num_env_steps_trained": 3584, "num_agent_steps_sampled": 14130, "num_agent_steps_trained": 14130}, "env_runners": {"episode_reward_max": 11.0, "episode_reward_min": 0.0, "episode_reward_mean": 4.666666666666667, "episode_len_mean": 204.33333333333334, "episode_media": {}, "episodes_timesteps_total": 3065, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 6.0}, "policy_reward_mean": {"default_policy": 1.1666666666666667}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 53.49408146926619, "mean_inference_ms": 1.2130353479629314, "mean_action_processing_ms": 0.20909075669354227, "mean_env_wait_ms": 2.097710594640932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008977254231770834, "StateBufferConnector_ms": 0.006206830342610677, "ViewRequirementAgentConnector_ms": 0.18884976704915366}, "num_episodes": 3, "episode_return_max": 11.0, "episode_return_min": 0.0, "episode_return_mean": 4.666666666666667, "episodes_this_iter": 3}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14130, "num_agent_steps_trained": 14130, "num_env_steps_sampled": 3584, "num_env_steps_trained": 3584, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 39.79976217445539, "num_env_steps_trained_throughput_per_sec": 39.79976217445539, "timesteps_total": 3584, "num_env_steps_sampled_lifetime": 3584, "num_agent_steps_sampled_lifetime": 14130, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 14130, "timers": {"training_iteration_time_ms": 13104.611, "restore_workers_time_ms": 0.017, "training_step_time_ms": 13104.566, "sample_time_ms": 12266.502, "load_time_ms": 0.254, "load_throughput": 2012906.472, "learn_time_ms": 829.733, "learn_throughput": 617.066, "synch_weights_time_ms": 7.843}, "counters": {"num_env_steps_sampled": 3584, "num_env_steps_trained": 3584, "num_agent_steps_sampled": 14130, "num_agent_steps_trained": 14130}, "done": false, "training_iteration": 7, "trial_id": "37af9_00000", "date": "2024-09-25_18-03-18", "timestamp": 1727287398, "time_this_iter_s": 12.868178844451904, "time_total_s": 91.75643348693848, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 91.75643348693848, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 16.68888888888889, "ram_util_percent": 29.966666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5652798243107334, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 2e-05, "total_loss": -0.17291732422046124, "policy_loss": -0.0019267647376944941, "vf_loss": 0.026432821000813535, "vf_explained_var": -0.1971080828097559, "kl": 0.00021752774792316228, "entropy": 1.7759909872085817, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2335.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled": 16120, "num_agent_steps_trained": 16120}, "env_runners": {"episode_reward_max": 11.0, "episode_reward_min": 0.0, "episode_reward_mean": 4.388888888888889, "episode_len_mean": 203.0, "episode_media": {}, "episodes_timesteps_total": 3654, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 6.0}, "policy_reward_mean": {"default_policy": 1.0972222222222223}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 54.06549289877966, "mean_inference_ms": 1.2061352304788537, "mean_action_processing_ms": 0.20796248946897125, "mean_env_wait_ms": 2.0891894563543363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008760558234320747, "StateBufferConnector_ms": 0.006053182813856337, "ViewRequirementAgentConnector_ms": 0.18494129180908203}, "num_episodes": 3, "episode_return_max": 11.0, "episode_return_min": 0.0, "episode_return_mean": 4.388888888888889, "episodes_this_iter": 3}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16120, "num_agent_steps_trained": 16120, "num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 39.41933053884405, "num_env_steps_trained_throughput_per_sec": 39.41933053884405, "timesteps_total": 4096, "num_env_steps_sampled_lifetime": 4096, "num_agent_steps_sampled_lifetime": 16120, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 16120, "timers": {"training_iteration_time_ms": 13090.105, "restore_workers_time_ms": 0.017, "training_step_time_ms": 13090.06, "sample_time_ms": 12254.534, "load_time_ms": 0.263, "load_throughput": 1946065.834, "learn_time_ms": 827.475, "learn_throughput": 618.75, "synch_weights_time_ms": 7.557}, "counters": {"num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled": 16120, "num_agent_steps_trained": 16120}, "done": false, "training_iteration": 8, "trial_id": "37af9_00000", "date": "2024-09-25_18-03-31", "timestamp": 1727287411, "time_this_iter_s": 12.992974519729614, "time_total_s": 104.74940800666809, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 104.74940800666809, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 17.357894736842105, "ram_util_percent": 30.373684210526317}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5682038233645501, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": -0.17341630802820288, "policy_loss": -0.0035224205709152643, "vf_loss": 0.03179282784478874, "vf_explained_var": 0.004609732666323262, "kl": 0.0013183389930042444, "entropy": 1.7784312052111473, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2645.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 4608, "num_env_steps_trained": 4608, "num_agent_steps_sampled": 18121, "num_agent_steps_trained": 18121}, "env_runners": {"episode_reward_max": 13.0, "episode_reward_min": 0.0, "episode_reward_mean": 4.571428571428571, "episode_len_mean": 206.8095238095238, "episode_media": {}, "episodes_timesteps_total": 4343, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 7.0}, "policy_reward_mean": {"default_policy": 1.1428571428571428}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 54.84295485946028, "mean_inference_ms": 1.2020397386399884, "mean_action_processing_ms": 0.20748700051308316, "mean_env_wait_ms": 2.08449198700969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008732931954520089, "StateBufferConnector_ms": 0.006059237888881138, "ViewRequirementAgentConnector_ms": 0.18606072380429223}, "num_episodes": 3, "episode_return_max": 13.0, "episode_return_min": 0.0, "episode_return_mean": 4.571428571428571, "episodes_this_iter": 3}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18121, "num_agent_steps_trained": 18121, "num_env_steps_sampled": 4608, "num_env_steps_trained": 4608, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 23.26413029346816, "num_env_steps_trained_throughput_per_sec": 23.26413029346816, "timesteps_total": 4608, "num_env_steps_sampled_lifetime": 4608, "num_agent_steps_sampled_lifetime": 18121, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 18121, "timers": {"training_iteration_time_ms": 14080.998, "restore_workers_time_ms": 0.017, "training_step_time_ms": 14080.954, "sample_time_ms": 13246.862, "load_time_ms": 0.261, "load_throughput": 1963962.284, "learn_time_ms": 825.758, "learn_throughput": 620.036, "synch_weights_time_ms": 7.84}, "counters": {"num_env_steps_sampled": 4608, "num_env_steps_trained": 4608, "num_agent_steps_sampled": 18121, "num_agent_steps_trained": 18121}, "done": false, "training_iteration": 9, "trial_id": "37af9_00000", "date": "2024-09-25_18-03-53", "timestamp": 1727287433, "time_this_iter_s": 22.011718034744263, "time_total_s": 126.76112604141235, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 126.76112604141235, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 12.822580645161288, "ram_util_percent": 30.716129032258067}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5759574546208305, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 2e-05, "total_loss": -0.17536156780514567, "policy_loss": -0.004480258195150283, "vf_loss": 0.027146462505709592, "vf_explained_var": -0.24648809202255742, "kl": 0.0005381248481722511, "entropy": 1.7766813212825405, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2955.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled": 20129, "num_agent_steps_trained": 20129}, "env_runners": {"episode_reward_max": 13.0, "episode_reward_min": 0.0, "episode_reward_mean": 4.863636363636363, "episode_len_mean": 211.1818181818182, "episode_media": {}, "episodes_timesteps_total": 4646, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 7.0}, "policy_reward_mean": {"default_policy": 1.2159090909090908}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 55.06311685483577, "mean_inference_ms": 1.2010108770465306, "mean_action_processing_ms": 0.20721647964053558, "mean_env_wait_ms": 2.083913426162043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008681687441739168, "StateBufferConnector_ms": 0.006054748188365589, "ViewRequirementAgentConnector_ms": 0.18694292415272107}, "num_episodes": 1, "episode_return_max": 13.0, "episode_return_min": 0.0, "episode_return_mean": 4.863636363636363, "episodes_this_iter": 1}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20129, "num_agent_steps_trained": 20129, "num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 27.193716710632604, "num_env_steps_trained_throughput_per_sec": 27.193716710632604, "timesteps_total": 5120, "num_env_steps_sampled_lifetime": 5120, "num_agent_steps_sampled_lifetime": 20129, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 20129, "timers": {"training_iteration_time_ms": 14555.687, "restore_workers_time_ms": 0.017, "training_step_time_ms": 14555.643, "sample_time_ms": 13712.273, "load_time_ms": 0.265, "load_throughput": 1929281.869, "learn_time_ms": 835.258, "learn_throughput": 612.984, "synch_weights_time_ms": 7.618}, "counters": {"num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled": 20129, "num_agent_steps_trained": 20129}, "done": false, "training_iteration": 10, "trial_id": "37af9_00000", "date": "2024-09-25_18-04-12", "timestamp": 1727287452, "time_this_iter_s": 18.861215114593506, "time_total_s": 145.62234115600586, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 145.62234115600586, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 8.070370370370371, "ram_util_percent": 31.44814814814815}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6435772220519456, "cur_kl_coeff": 0.00019531249999999996, "cur_lr": 1.9999999999999998e-05, "total_loss": -0.17691987796940586, "policy_loss": -0.006990890560502356, "vf_loss": 0.028315761750105372, "vf_explained_var": -0.09122591705033273, "kl": 0.003275269816275499, "entropy": 1.770085660977797, "entropy_coeff": 0.09999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3275.5, "diff_num_grad_updates_vs_sampler_policy": 164.5}}, "num_env_steps_sampled": 5632, "num_env_steps_trained": 5632, "num_agent_steps_sampled": 22247, "num_agent_steps_trained": 22247}, "env_runners": {"episode_reward_max": 13.0, "episode_reward_min": 0.0, "episode_reward_mean": 4.84, "episode_len_mean": 210.2, "episode_media": {}, "episodes_timesteps_total": 5255, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 7.0}, "policy_reward_mean": {"default_policy": 1.21}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 55.37235453367608, "mean_inference_ms": 1.1971332415044122, "mean_action_processing_ms": 0.20675960331132268, "mean_env_wait_ms": 2.0796511770991724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008522987365722656, "StateBufferConnector_ms": 0.00605010986328125, "ViewRequirementAgentConnector_ms": 0.1877880096435547}, "num_episodes": 3, "episode_return_max": 13.0, "episode_return_min": 0.0, "episode_return_mean": 4.84, "episodes_this_iter": 3}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22247, "num_agent_steps_trained": 22247, "num_env_steps_sampled": 5632, "num_env_steps_trained": 5632, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 33.74962347470382, "num_env_steps_trained_throughput_per_sec": 33.74962347470382, "timesteps_total": 5632, "num_env_steps_sampled_lifetime": 5632, "num_agent_steps_sampled_lifetime": 22247, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 22247, "timers": {"training_iteration_time_ms": 15853.984, "restore_workers_time_ms": 0.016, "training_step_time_ms": 15853.942, "sample_time_ms": 15009.11, "load_time_ms": 0.273, "load_throughput": 1875040.293, "learn_time_ms": 836.776, "learn_throughput": 611.872, "synch_weights_time_ms": 7.561}, "counters": {"num_env_steps_sampled": 5632, "num_env_steps_trained": 5632, "num_agent_steps_sampled": 22247, "num_agent_steps_trained": 22247}, "done": false, "training_iteration": 11, "trial_id": "37af9_00000", "date": "2024-09-25_18-04-27", "timestamp": 1727287467, "time_this_iter_s": 15.173283338546753, "time_total_s": 160.7956244945526, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 160.7956244945526, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 14.395238095238094, "ram_util_percent": 30.52380952380951}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6582301072535977, "cur_kl_coeff": 9.765624999999999e-05, "cur_lr": 2e-05, "total_loss": -0.17831685022120514, "policy_loss": -0.006080941234024302, "vf_loss": 0.019253182279006128, "vf_explained_var": 0.2562690823308883, "kl": 0.002362868063956641, "entropy": 1.7704943076256783, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3595.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 24293, "num_agent_steps_trained": 24293}, "env_runners": {"episode_reward_max": 13.0, "episode_reward_min": 0.0, "episode_reward_mean": 4.464285714285714, "episode_len_mean": 206.57142857142858, "episode_media": {}, "episodes_timesteps_total": 5784, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 7.0}, "policy_reward_mean": {"default_policy": 1.1160714285714286}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 55.70588486506043, "mean_inference_ms": 1.1930868015145124, "mean_action_processing_ms": 0.20617054586690506, "mean_env_wait_ms": 2.0763602620341612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008646079472133092, "StateBufferConnector_ms": 0.006062643868582589, "ViewRequirementAgentConnector_ms": 0.18896290234157018}, "num_episodes": 3, "episode_return_max": 13.0, "episode_return_min": 0.0, "episode_return_mean": 4.464285714285714, "episodes_this_iter": 3}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24293, "num_agent_steps_trained": 24293, "num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 39.11672234671666, "num_env_steps_trained_throughput_per_sec": 39.11672234671666, "timesteps_total": 6144, "num_env_steps_sampled_lifetime": 6144, "num_agent_steps_sampled_lifetime": 24293, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 24293, "timers": {"training_iteration_time_ms": 15637.698, "restore_workers_time_ms": 0.016, "training_step_time_ms": 15637.656, "sample_time_ms": 14792.954, "load_time_ms": 0.287, "load_throughput": 1781257.173, "learn_time_ms": 836.388, "learn_throughput": 612.156, "synch_weights_time_ms": 7.801}, "counters": {"num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 24293, "num_agent_steps_trained": 24293}, "done": false, "training_iteration": 12, "trial_id": "37af9_00000", "date": "2024-09-25_18-04-40", "timestamp": 1727287480, "time_this_iter_s": 13.092245817184448, "time_total_s": 173.88787031173706, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 173.88787031173706, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 14.126315789473686, "ram_util_percent": 29.889473684210518}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5907251636107121, "cur_kl_coeff": 4.8828124999999996e-05, "cur_lr": 2e-05, "total_loss": -0.1730431727618129, "policy_loss": -0.002161794786732043, "vf_loss": 0.02677289814661978, "vf_explained_var": 0.006010707347623764, "kl": 0.001009137337550581, "entropy": 1.7757464793420608, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3905.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 6656, "num_env_steps_trained": 6656, "num_agent_steps_sampled": 26281, "num_agent_steps_trained": 26281}, "env_runners": {"episode_reward_max": 13.0, "episode_reward_min": 0.0, "episode_reward_mean": 4.32258064516129, "episode_len_mean": 204.29032258064515, "episode_media": {}, "episodes_timesteps_total": 6333, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 7.0}, "policy_reward_mean": {"default_policy": 1.0806451612903225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 56.009563778177125, "mean_inference_ms": 1.1893538780292807, "mean_action_processing_ms": 0.20563996918253175, "mean_env_wait_ms": 2.072308248639475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008462321373724168, "StateBufferConnector_ms": 0.005987382704211819, "ViewRequirementAgentConnector_ms": 0.18741546138640372}, "num_episodes": 3, "episode_return_max": 13.0, "episode_return_min": 0.0, "episode_return_mean": 4.32258064516129, "episodes_this_iter": 3}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26281, "num_agent_steps_trained": 26281, "num_env_steps_sampled": 6656, "num_env_steps_trained": 6656, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 39.00081472822909, "num_env_steps_trained_throughput_per_sec": 39.00081472822909, "timesteps_total": 6656, "num_env_steps_sampled_lifetime": 6656, "num_agent_steps_sampled_lifetime": 26281, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 26281, "timers": {"training_iteration_time_ms": 14924.933, "restore_workers_time_ms": 0.016, "training_step_time_ms": 14924.892, "sample_time_ms": 14069.441, "load_time_ms": 0.28, "load_throughput": 1826712.868, "learn_time_ms": 847.471, "learn_throughput": 604.151, "synch_weights_time_ms": 7.471}, "counters": {"num_env_steps_sampled": 6656, "num_env_steps_trained": 6656, "num_agent_steps_sampled": 26281, "num_agent_steps_trained": 26281}, "done": false, "training_iteration": 13, "trial_id": "37af9_00000", "date": "2024-09-25_18-04-54", "timestamp": 1727287494, "time_this_iter_s": 13.131184101104736, "time_total_s": 187.0190544128418, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 187.0190544128418, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 15.805263157894734, "ram_util_percent": 29.810526315789478}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5244166021700949, "cur_kl_coeff": 2.4414062499999998e-05, "cur_lr": 2e-05, "total_loss": -0.17412634194188287, "policy_loss": -0.0015969402506016196, "vf_loss": 0.02184527961908316, "vf_explained_var": -0.03612156324088574, "kl": 0.0005300321964086585, "entropy": 1.779907275363803, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4220.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_agent_steps_sampled": 28329, "num_agent_steps_trained": 28329}, "env_runners": {"episode_reward_max": 13.0, "episode_reward_min": 0.0, "episode_reward_mean": 4.34375, "episode_len_mean": 206.125, "episode_media": {}, "episodes_timesteps_total": 6596, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 7.0}, "policy_reward_mean": {"default_policy": 1.0859375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 56.12304485382181, "mean_inference_ms": 1.1884215642807643, "mean_action_processing_ms": 0.20558242906859614, "mean_env_wait_ms": 2.0717419415092593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008422881364822388, "StateBufferConnector_ms": 0.006002932786941528, "ViewRequirementAgentConnector_ms": 0.18797889351844788}, "num_episodes": 1, "episode_return_max": 13.0, "episode_return_min": 0.0, "episode_return_mean": 4.34375, "episodes_this_iter": 1}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28329, "num_agent_steps_trained": 28329, "num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 30.89784139058294, "num_env_steps_trained_throughput_per_sec": 30.89784139058294, "timesteps_total": 7168, "num_env_steps_sampled_lifetime": 7168, "num_agent_steps_sampled_lifetime": 28329, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 28329, "timers": {"training_iteration_time_ms": 15155.222, "restore_workers_time_ms": 0.016, "training_step_time_ms": 15155.177, "sample_time_ms": 14299.957, "load_time_ms": 0.292, "load_throughput": 1754766.831, "learn_time_ms": 847.138, "learn_throughput": 604.388, "synch_weights_time_ms": 7.56}, "counters": {"num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_agent_steps_sampled": 28329, "num_agent_steps_trained": 28329}, "done": false, "training_iteration": 14, "trial_id": "37af9_00000", "date": "2024-09-25_18-05-10", "timestamp": 1727287510, "time_this_iter_s": 16.574124336242676, "time_total_s": 203.59317874908447, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 203.59317874908447, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 7.173913043478261, "ram_util_percent": 29.578260869565206}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5977546039367876, "cur_kl_coeff": 1.2207031249999999e-05, "cur_lr": 2e-05, "total_loss": -0.1752758790979222, "policy_loss": -0.007870827293804577, "vf_loss": 0.04189112466748714, "vf_explained_var": -0.23727786194893621, "kl": 0.0008185976614940396, "entropy": 1.7787784437979421, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4535.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 7680, "num_env_steps_trained": 7680, "num_agent_steps_sampled": 30323, "num_agent_steps_trained": 30323}, "env_runners": {"episode_reward_max": 13.0, "episode_reward_min": 0.0, "episode_reward_mean": 4.294117647058823, "episode_len_mean": 204.1764705882353, "episode_media": {}, "episodes_timesteps_total": 6942, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 7.0}, "policy_reward_mean": {"default_policy": 1.0735294117647058}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 56.23679860008676, "mean_inference_ms": 1.1852348712247445, "mean_action_processing_ms": 0.205157400018802, "mean_env_wait_ms": 2.0691523085150254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008458950940300436, "StateBufferConnector_ms": 0.006002538344439338, "ViewRequirementAgentConnector_ms": 0.18866132287418141}, "num_episodes": 2, "episode_return_max": 13.0, "episode_return_min": 0.0, "episode_return_mean": 4.294117647058823, "episodes_this_iter": 2}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30323, "num_agent_steps_trained": 30323, "num_env_steps_sampled": 7680, "num_env_steps_trained": 7680, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 41.99623660009178, "num_env_steps_trained_throughput_per_sec": 41.99623660009178, "timesteps_total": 7680, "num_env_steps_sampled_lifetime": 7680, "num_agent_steps_sampled_lifetime": 30323, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 30323, "timers": {"training_iteration_time_ms": 14763.15, "restore_workers_time_ms": 0.017, "training_step_time_ms": 14763.105, "sample_time_ms": 13906.219, "load_time_ms": 0.291, "load_throughput": 1761821.026, "learn_time_ms": 849.208, "learn_throughput": 602.915, "synch_weights_time_ms": 7.162}, "counters": {"num_env_steps_sampled": 7680, "num_env_steps_trained": 7680, "num_agent_steps_sampled": 30323, "num_agent_steps_trained": 30323}, "done": false, "training_iteration": 15, "trial_id": "37af9_00000", "date": "2024-09-25_18-05-22", "timestamp": 1727287522, "time_this_iter_s": 12.195047855377197, "time_total_s": 215.78822660446167, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 215.78822660446167, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 12.25, "ram_util_percent": 30.400000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5935929625024718, "cur_kl_coeff": 6.1035156249999995e-06, "cur_lr": 2e-05, "total_loss": -0.17224584252483421, "policy_loss": -0.0019977713484437237, "vf_loss": 0.03216214119381602, "vf_explained_var": 0.3881625167785152, "kl": 0.0007060338373699163, "entropy": 1.7828860494398302, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4845.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled": 32332, "num_agent_steps_trained": 32332}, "env_runners": {"episode_reward_max": 13.0, "episode_reward_min": 0.0, "episode_reward_mean": 4.555555555555555, "episode_len_mean": 210.22222222222223, "episode_media": {}, "episodes_timesteps_total": 7568, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 7.0}, "policy_reward_mean": {"default_policy": 1.1388888888888888}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 56.344663265826625, "mean_inference_ms": 1.183427324217795, "mean_action_processing_ms": 0.20498924491324744, "mean_env_wait_ms": 2.066750849013948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008347299363878038, "StateBufferConnector_ms": 0.0059286753336588545, "ViewRequirementAgentConnector_ms": 0.18541614214579263}, "num_episodes": 2, "episode_return_max": 13.0, "episode_return_min": 0.0, "episode_return_mean": 4.555555555555555, "episodes_this_iter": 2}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32332, "num_agent_steps_trained": 32332, "num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 21.28164004910304, "num_env_steps_trained_throughput_per_sec": 21.28164004910304, "timesteps_total": 8192, "num_env_steps_sampled_lifetime": 8192, "num_agent_steps_sampled_lifetime": 32332, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 32332, "timers": {"training_iteration_time_ms": 16089.717, "restore_workers_time_ms": 0.016, "training_step_time_ms": 16089.672, "sample_time_ms": 15229.657, "load_time_ms": 0.289, "load_throughput": 1774193.364, "learn_time_ms": 851.907, "learn_throughput": 601.005, "synch_weights_time_ms": 7.589}, "counters": {"num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled": 32332, "num_agent_steps_trained": 32332}, "done": false, "training_iteration": 16, "trial_id": "37af9_00000", "date": "2024-09-25_18-05-46", "timestamp": 1727287546, "time_this_iter_s": 24.061173677444458, "time_total_s": 239.84940028190613, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 239.84940028190613, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 10.808823529411763, "ram_util_percent": 31.602941176470587}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.594430589796074, "cur_kl_coeff": 3.0517578124999997e-06, "cur_lr": 2e-05, "total_loss": -0.17604021066949974, "policy_loss": -0.005490963197042865, "vf_loss": 0.02880456215540518, "vf_explained_var": 0.17560315612823732, "kl": 0.0005541297272016312, "entropy": 1.7775038761477318, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5155.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 8704, "num_env_steps_trained": 8704, "num_agent_steps_sampled": 34372, "num_agent_steps_trained": 34372}, "env_runners": {"episode_reward_max": 13.0, "episode_reward_min": 0.0, "episode_reward_mean": 4.538461538461538, "episode_len_mean": 208.12820512820514, "episode_media": {}, "episodes_timesteps_total": 8117, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 7.0}, "policy_reward_mean": {"default_policy": 1.1346153846153846}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 56.541098368799716, "mean_inference_ms": 1.1799615397624859, "mean_action_processing_ms": 0.20465172390040545, "mean_env_wait_ms": 2.063146444622089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008342816279484676, "StateBufferConnector_ms": 0.0059482378837389825, "ViewRequirementAgentConnector_ms": 0.18659127064240286}, "num_episodes": 3, "episode_return_max": 13.0, "episode_return_min": 0.0, "episode_return_mean": 4.538461538461538, "episodes_this_iter": 3}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34372, "num_agent_steps_trained": 34372, "num_env_steps_sampled": 8704, "num_env_steps_trained": 8704, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 34.644898029246065, "num_env_steps_trained_throughput_per_sec": 34.644898029246065, "timesteps_total": 8704, "num_env_steps_sampled_lifetime": 8704, "num_agent_steps_sampled_lifetime": 34372, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 34372, "timers": {"training_iteration_time_ms": 16281.129, "restore_workers_time_ms": 0.017, "training_step_time_ms": 16281.082, "sample_time_ms": 15423.382, "load_time_ms": 0.283, "load_throughput": 1812069.571, "learn_time_ms": 849.54, "learn_throughput": 602.679, "synch_weights_time_ms": 7.648}, "counters": {"num_env_steps_sampled": 8704, "num_env_steps_trained": 8704, "num_agent_steps_sampled": 34372, "num_agent_steps_trained": 34372}, "done": false, "training_iteration": 17, "trial_id": "37af9_00000", "date": "2024-09-25_18-06-01", "timestamp": 1727287561, "time_this_iter_s": 14.78213620185852, "time_total_s": 254.63153648376465, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 254.63153648376465, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 13.547619047619047, "ram_util_percent": 31.123809523809523}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5766819825395941, "cur_kl_coeff": 1.5258789062499999e-06, "cur_lr": 2e-05, "total_loss": -0.17459553890803364, "policy_loss": -0.003613600807148032, "vf_loss": 0.026865744167116644, "vf_explained_var": -0.006741506233811379, "kl": 0.0009648488520527021, "entropy": 1.7769837368279695, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5470.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_agent_steps_sampled": 36420, "num_agent_steps_trained": 36420}, "env_runners": {"episode_reward_max": 14.0, "episode_reward_min": 0.0, "episode_reward_mean": 4.761904761904762, "episode_len_mean": 211.57142857142858, "episode_media": {}, "episodes_timesteps_total": 8886, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 8.0}, "policy_reward_mean": {"default_policy": 1.1904761904761905}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 56.78593947258677, "mean_inference_ms": 1.176496646554342, "mean_action_processing_ms": 0.20424299346127647, "mean_env_wait_ms": 2.060250400643117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008416175842285156, "StateBufferConnector_ms": 0.005955355507986886, "ViewRequirementAgentConnector_ms": 0.18765188398815336}, "num_episodes": 3, "episode_return_max": 14.0, "episode_return_min": 0.0, "episode_return_mean": 4.761904761904762, "episodes_this_iter": 3}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36420, "num_agent_steps_trained": 36420, "num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 19.213203424666187, "num_env_steps_trained_throughput_per_sec": 19.213203424666187, "timesteps_total": 9216, "num_env_steps_sampled_lifetime": 9216, "num_agent_steps_sampled_lifetime": 36420, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 36420, "timers": {"training_iteration_time_ms": 17647.108, "restore_workers_time_ms": 0.018, "training_step_time_ms": 17647.06, "sample_time_ms": 16785.794, "load_time_ms": 0.272, "load_throughput": 1879142.149, "learn_time_ms": 853.012, "learn_throughput": 600.226, "synch_weights_time_ms": 7.753}, "counters": {"num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_agent_steps_sampled": 36420, "num_agent_steps_trained": 36420}, "done": false, "training_iteration": 18, "trial_id": "37af9_00000", "date": "2024-09-25_18-06-28", "timestamp": 1727287588, "time_this_iter_s": 26.651208639144897, "time_total_s": 281.28274512290955, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 281.28274512290955, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 10.871052631578948, "ram_util_percent": 31.165789473684214}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5927420490421355, "cur_kl_coeff": 7.629394531249999e-07, "cur_lr": 2e-05, "total_loss": -0.17130442990455777, "policy_loss": -0.005848864791914821, "vf_loss": 0.04902050463715568, "vf_explained_var": -0.2071911260485649, "kl": 0.0028317585505150513, "entropy": 1.777106910943985, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5790.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 9728, "num_env_steps_trained": 9728, "num_agent_steps_sampled": 38468, "num_agent_steps_trained": 38468}, "env_runners": {"episode_reward_max": 14.0, "episode_reward_min": 0.0, "episode_reward_mean": 4.790697674418604, "episode_len_mean": 210.90697674418604, "episode_media": {}, "episodes_timesteps_total": 9069, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 8.0}, "policy_reward_mean": {"default_policy": 1.197674418604651}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 56.87803707759126, "mean_inference_ms": 1.1749946240705915, "mean_action_processing_ms": 0.20408904090996366, "mean_env_wait_ms": 2.0591511578000463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00840065091155296, "StateBufferConnector_ms": 0.005955474321232285, "ViewRequirementAgentConnector_ms": 0.18800691116687862}, "num_episodes": 1, "episode_return_max": 14.0, "episode_return_min": 0.0, "episode_return_mean": 4.790697674418604, "episodes_this_iter": 1}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38468, "num_agent_steps_trained": 38468, "num_env_steps_sampled": 9728, "num_env_steps_trained": 9728, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 41.6896054685065, "num_env_steps_trained_throughput_per_sec": 41.6896054685065, "timesteps_total": 9728, "num_env_steps_sampled_lifetime": 9728, "num_agent_steps_sampled_lifetime": 38468, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 38468, "timers": {"training_iteration_time_ms": 16674.419, "restore_workers_time_ms": 0.018, "training_step_time_ms": 16674.37, "sample_time_ms": 15809.118, "load_time_ms": 0.266, "load_throughput": 1925821.584, "learn_time_ms": 857.363, "learn_throughput": 597.18, "synch_weights_time_ms": 7.399}, "counters": {"num_env_steps_sampled": 9728, "num_env_steps_trained": 9728, "num_agent_steps_sampled": 38468, "num_agent_steps_trained": 38468}, "done": false, "training_iteration": 19, "trial_id": "37af9_00000", "date": "2024-09-25_18-06-40", "timestamp": 1727287600, "time_this_iter_s": 12.285430431365967, "time_total_s": 293.5681755542755, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 293.5681755542755, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 8.276470588235293, "ram_util_percent": 32.07647058823529}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5697265168351512, "cur_kl_coeff": 3.8146972656249997e-07, "cur_lr": 2e-05, "total_loss": -0.16627493958559728, "policy_loss": 0.003969708434306085, "vf_loss": 0.028110871012810797, "vf_explained_var": 0.2612143293503792, "kl": 0.0007219797436722878, "entropy": 1.7727236297822768, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6105.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled": 40498, "num_agent_steps_trained": 40498}, "env_runners": {"episode_reward_max": 14.0, "episode_reward_min": 0.0, "episode_reward_mean": 4.891304347826087, "episode_len_mean": 213.0, "episode_media": {}, "episodes_timesteps_total": 9798, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 8.0}, "policy_reward_mean": {"default_policy": 1.2228260869565217}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 56.98700072172715, "mean_inference_ms": 1.1726574416280575, "mean_action_processing_ms": 0.20387770067596525, "mean_env_wait_ms": 2.0567657967344113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008511024972666864, "StateBufferConnector_ms": 0.005964092586351478, "ViewRequirementAgentConnector_ms": 0.18843775210173233}, "num_episodes": 3, "episode_return_max": 14.0, "episode_return_min": 0.0, "episode_return_mean": 4.891304347826087, "episodes_this_iter": 3}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40498, "num_agent_steps_trained": 40498, "num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 26.172149805285645, "num_env_steps_trained_throughput_per_sec": 26.172149805285645, "timesteps_total": 10240, "num_env_steps_sampled_lifetime": 10240, "num_agent_steps_sampled_lifetime": 40498, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 40498, "timers": {"training_iteration_time_ms": 16747.909, "restore_workers_time_ms": 0.018, "training_step_time_ms": 16747.861, "sample_time_ms": 15892.85, "load_time_ms": 0.254, "load_throughput": 2014524.998, "learn_time_ms": 847.106, "learn_throughput": 604.411, "synch_weights_time_ms": 7.426}, "counters": {"num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled": 40498, "num_agent_steps_trained": 40498}, "done": false, "training_iteration": 20, "trial_id": "37af9_00000", "date": "2024-09-25_18-07-00", "timestamp": 1727287620, "time_this_iter_s": 19.566528797149658, "time_total_s": 313.13470435142517, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 313.13470435142517, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 13.521428571428572, "ram_util_percent": 30.535714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6079076531529427, "cur_kl_coeff": 1.9073486328124998e-07, "cur_lr": 2e-05, "total_loss": -0.1746690721406291, "policy_loss": -0.006927613963683446, "vf_loss": 0.04047143596922979, "vf_explained_var": 0.22408978263537088, "kl": 0.0024887396765045605, "entropy": 1.7785931293169657, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6410.5, "diff_num_grad_updates_vs_sampler_policy": 149.5}}, "num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled": 42480, "num_agent_steps_trained": 42480}, "env_runners": {"episode_reward_max": 14.0, "episode_reward_min": 0.0, "episode_reward_mean": 4.795918367346939, "episode_len_mean": 211.57142857142858, "episode_media": {}, "episodes_timesteps_total": 10367, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 8.0}, "policy_reward_mean": {"default_policy": 1.1989795918367347}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 57.13097541653255, "mean_inference_ms": 1.1698063551267905, "mean_action_processing_ms": 0.20358827324452458, "mean_env_wait_ms": 2.0539932843208506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008480402888083945, "StateBufferConnector_ms": 0.005915213604362643, "ViewRequirementAgentConnector_ms": 0.18673818938586176}, "num_episodes": 3, "episode_return_max": 14.0, "episode_return_min": 0.0, "episode_return_mean": 4.795918367346939, "episodes_this_iter": 3}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42480, "num_agent_steps_trained": 42480, "num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 35.44693148721998, "num_env_steps_trained_throughput_per_sec": 35.44693148721998, "timesteps_total": 10752, "num_env_steps_sampled_lifetime": 10752, "num_agent_steps_sampled_lifetime": 42480, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 42480, "timers": {"training_iteration_time_ms": 16675.268, "restore_workers_time_ms": 0.018, "training_step_time_ms": 16675.22, "sample_time_ms": 15828.407, "load_time_ms": 0.241, "load_throughput": 2120971.504, "learn_time_ms": 839.313, "learn_throughput": 610.023, "synch_weights_time_ms": 7.032}, "counters": {"num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled": 42480, "num_agent_steps_trained": 42480}, "done": false, "training_iteration": 21, "trial_id": "37af9_00000", "date": "2024-09-25_18-07-14", "timestamp": 1727287634, "time_this_iter_s": 14.449212312698364, "time_total_s": 327.58391666412354, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 327.58391666412354, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 13.657142857142858, "ram_util_percent": 29.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4984891168292492, "cur_kl_coeff": 9.536743164062499e-08, "cur_lr": 2e-05, "total_loss": -0.1768028371051074, "policy_loss": -0.007169713218125605, "vf_loss": 0.034071386480448586, "vf_explained_var": 0.10481564152625299, "kl": 0.0006587961451004737, "entropy": 1.781509667827237, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6715.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_agent_steps_sampled": 44508, "num_agent_steps_trained": 44508}, "env_runners": {"episode_reward_max": 14.0, "episode_reward_min": 0.0, "episode_reward_mean": 4.84, "episode_len_mean": 212.2, "episode_media": {}, "episodes_timesteps_total": 10610, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 8.0}, "policy_reward_mean": {"default_policy": 1.21}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 57.177877832154074, "mean_inference_ms": 1.1692540253064592, "mean_action_processing_ms": 0.2035450437437278, "mean_env_wait_ms": 2.053374121302374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008518695831298828, "StateBufferConnector_ms": 0.005929470062255859, "ViewRequirementAgentConnector_ms": 0.18712091445922852}, "num_episodes": 1, "episode_return_max": 14.0, "episode_return_min": 0.0, "episode_return_mean": 4.84, "episodes_this_iter": 1}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44508, "num_agent_steps_trained": 44508, "num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 33.62184906078078, "num_env_steps_trained_throughput_per_sec": 33.62184906078078, "timesteps_total": 11264, "num_env_steps_sampled_lifetime": 11264, "num_agent_steps_sampled_lifetime": 44508, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 44508, "timers": {"training_iteration_time_ms": 16889.184, "restore_workers_time_ms": 0.017, "training_step_time_ms": 16889.138, "sample_time_ms": 16042.141, "load_time_ms": 0.239, "load_throughput": 2142983.383, "learn_time_ms": 839.7, "learn_throughput": 609.742, "synch_weights_time_ms": 6.835}, "counters": {"num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_agent_steps_sampled": 44508, "num_agent_steps_trained": 44508}, "done": false, "training_iteration": 22, "trial_id": "37af9_00000", "date": "2024-09-25_18-07-29", "timestamp": 1727287649, "time_this_iter_s": 15.231737613677979, "time_total_s": 342.8156542778015, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 342.8156542778015, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 8.414285714285715, "ram_util_percent": 29.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5738971061101465, "cur_kl_coeff": 4.768371582031249e-08, "cur_lr": 1.9999999999999998e-05, "total_loss": -0.1681476584325234, "policy_loss": 0.0021084576111399765, "vf_loss": 0.0305388212948332, "vf_explained_var": 0.2126217023892836, "kl": 0.0007267628641484821, "entropy": 1.7789082292354468, "entropy_coeff": 0.09999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7035.5, "diff_num_grad_updates_vs_sampler_policy": 164.5}}, "num_env_steps_sampled": 11776, "num_env_steps_trained": 11776, "num_agent_steps_sampled": 46648, "num_agent_steps_trained": 46648}, "env_runners": {"episode_reward_max": 14.0, "episode_reward_min": 0.0, "episode_reward_mean": 4.777777777777778, "episode_len_mean": 211.5185185185185, "episode_media": {}, "episodes_timesteps_total": 11422, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 8.0}, "policy_reward_mean": {"default_policy": 1.1944444444444444}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 57.32324103106458, "mean_inference_ms": 1.166285387139167, "mean_action_processing_ms": 0.2032847668452495, "mean_env_wait_ms": 2.0504991003928477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008649737746627242, "StateBufferConnector_ms": 0.005921169563576027, "ViewRequirementAgentConnector_ms": 0.18715637701529045}, "num_episodes": 4, "episode_return_max": 14.0, "episode_return_min": 0.0, "episode_return_mean": 4.777777777777778, "episodes_this_iter": 4}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46648, "num_agent_steps_trained": 46648, "num_env_steps_sampled": 11776, "num_env_steps_trained": 11776, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 36.04701311587483, "num_env_steps_trained_throughput_per_sec": 36.04701311587483, "timesteps_total": 11776, "num_env_steps_sampled_lifetime": 11776, "num_agent_steps_sampled_lifetime": 46648, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 46648, "timers": {"training_iteration_time_ms": 16996.758, "restore_workers_time_ms": 0.017, "training_step_time_ms": 16996.713, "sample_time_ms": 16151.955, "load_time_ms": 0.237, "load_throughput": 2163275.56, "learn_time_ms": 837.54, "learn_throughput": 611.314, "synch_weights_time_ms": 6.763}, "counters": {"num_env_steps_sampled": 11776, "num_env_steps_trained": 11776, "num_agent_steps_sampled": 46648, "num_agent_steps_trained": 46648}, "done": false, "training_iteration": 23, "trial_id": "37af9_00000", "date": "2024-09-25_18-07-44", "timestamp": 1727287664, "time_this_iter_s": 14.208622455596924, "time_total_s": 357.02427673339844, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 357.02427673339844, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 19.31904761904762, "ram_util_percent": 30.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6232561458135024, "cur_kl_coeff": 2.3841857910156248e-08, "cur_lr": 2e-05, "total_loss": -0.1739056667080149, "policy_loss": -0.007760271802544594, "vf_loss": 0.04509561921859131, "vf_explained_var": 0.02284319382160902, "kl": 0.0035060033600203154, "entropy": 1.774192927032709, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7360.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_agent_steps_sampled": 48696, "num_agent_steps_trained": 48696}, "env_runners": {"episode_reward_max": 14.0, "episode_reward_min": 0.0, "episode_reward_mean": 4.818181818181818, "episode_len_mean": 211.72727272727272, "episode_media": {}, "episodes_timesteps_total": 11645, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 8.0}, "policy_reward_mean": {"default_policy": 1.2045454545454546}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 57.38003863412608, "mean_inference_ms": 1.1656359960353815, "mean_action_processing_ms": 0.20320315464250796, "mean_env_wait_ms": 2.0500119653878666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008698376742276278, "StateBufferConnector_ms": 0.0059344551780007105, "ViewRequirementAgentConnector_ms": 0.18785650079900568}, "num_episodes": 1, "episode_return_max": 14.0, "episode_return_min": 0.0, "episode_return_mean": 4.818181818181818, "episodes_this_iter": 1}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48696, "num_agent_steps_trained": 48696, "num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 35.921648425300035, "num_env_steps_trained_throughput_per_sec": 35.921648425300035, "timesteps_total": 12288, "num_env_steps_sampled_lifetime": 12288, "num_agent_steps_sampled_lifetime": 48696, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 48696, "timers": {"training_iteration_time_ms": 16765.006, "restore_workers_time_ms": 0.016, "training_step_time_ms": 16764.964, "sample_time_ms": 15919.79, "load_time_ms": 0.23, "load_throughput": 2230456.635, "learn_time_ms": 838.226, "learn_throughput": 610.814, "synch_weights_time_ms": 6.502}, "counters": {"num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_agent_steps_sampled": 48696, "num_agent_steps_trained": 48696}, "done": false, "training_iteration": 24, "trial_id": "37af9_00000", "date": "2024-09-25_18-07-58", "timestamp": 1727287678, "time_this_iter_s": 14.255825519561768, "time_total_s": 371.2801022529602, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 371.2801022529602, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 8.425, "ram_util_percent": 30.794999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.644333553866994, "cur_kl_coeff": 1.1920928955078124e-08, "cur_lr": 2e-05, "total_loss": -0.17380306119129302, "policy_loss": -0.007023799090435909, "vf_loss": 0.040472900709550404, "vf_explained_var": 0.21699055913955934, "kl": 0.0010503381967503578, "entropy": 1.7689748598683266, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7675.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_agent_steps_sampled": 50724, "num_agent_steps_trained": 50724}, "env_runners": {"episode_reward_max": 14.0, "episode_reward_min": 0.0, "episode_reward_mean": 4.894736842105263, "episode_len_mean": 213.17543859649123, "episode_media": {}, "episodes_timesteps_total": 12151, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 8.0}, "policy_reward_mean": {"default_policy": 1.2236842105263157}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 57.450348766313304, "mean_inference_ms": 1.1646425100539046, "mean_action_processing_ms": 0.20316688329765725, "mean_env_wait_ms": 2.04878623328056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008766692981385348, "StateBufferConnector_ms": 0.005926583942614104, "ViewRequirementAgentConnector_ms": 0.1878734220538223}, "num_episodes": 2, "episode_return_max": 14.0, "episode_return_min": 0.0, "episode_return_mean": 4.894736842105263, "episodes_this_iter": 2}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50724, "num_agent_steps_trained": 50724, "num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 28.947380809583056, "num_env_steps_trained_throughput_per_sec": 28.947380809583056, "timesteps_total": 12800, "num_env_steps_sampled_lifetime": 12800, "num_agent_steps_sampled_lifetime": 50724, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 50724, "timers": {"training_iteration_time_ms": 17314.576, "restore_workers_time_ms": 0.016, "training_step_time_ms": 17314.535, "sample_time_ms": 16459.481, "load_time_ms": 0.228, "load_throughput": 2241398.234, "learn_time_ms": 848.134, "learn_throughput": 603.678, "synch_weights_time_ms": 6.476}, "counters": {"num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_agent_steps_sampled": 50724, "num_agent_steps_trained": 50724}, "done": false, "training_iteration": 25, "trial_id": "37af9_00000", "date": "2024-09-25_18-08-16", "timestamp": 1727287696, "time_this_iter_s": 17.69058060646057, "time_total_s": 388.9706828594208, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 388.9706828594208, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 11.356000000000002, "ram_util_percent": 31.244}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5931795331258928, "cur_kl_coeff": 5.960464477539062e-09, "cur_lr": 2e-05, "total_loss": -0.1730761836613378, "policy_loss": -0.00249575677838537, "vf_loss": 0.028510168510594316, "vf_explained_var": 0.09040683700192359, "kl": 0.0016591363977443419, "entropy": 1.7770796510481066, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7985.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_agent_steps_sampled": 52761, "num_agent_steps_trained": 52761}, "env_runners": {"episode_reward_max": 15.0, "episode_reward_min": 0.0, "episode_reward_mean": 5.05, "episode_len_mean": 217.0, "episode_media": {}, "episodes_timesteps_total": 13020, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 10.0}, "policy_reward_mean": {"default_policy": 1.2625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 57.61017670445209, "mean_inference_ms": 1.1627649975913132, "mean_action_processing_ms": 0.2030058930498918, "mean_env_wait_ms": 2.0474156285453264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008688767751057943, "StateBufferConnector_ms": 0.005932251612345378, "ViewRequirementAgentConnector_ms": 0.18857796986897787}, "num_episodes": 3, "episode_return_max": 15.0, "episode_return_min": 0.0, "episode_return_mean": 5.05, "episodes_this_iter": 3}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52761, "num_agent_steps_trained": 52761, "num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 20.117205728355888, "num_env_steps_trained_throughput_per_sec": 20.117205728355888, "timesteps_total": 13312, "num_env_steps_sampled_lifetime": 13312, "num_agent_steps_sampled_lifetime": 52761, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 52761, "timers": {"training_iteration_time_ms": 17453.831, "restore_workers_time_ms": 0.016, "training_step_time_ms": 17453.79, "sample_time_ms": 16598.607, "load_time_ms": 0.229, "load_throughput": 2237894.589, "learn_time_ms": 848.562, "learn_throughput": 603.374, "synch_weights_time_ms": 6.182}, "counters": {"num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_agent_steps_sampled": 52761, "num_agent_steps_trained": 52761}, "done": false, "training_iteration": 26, "trial_id": "37af9_00000", "date": "2024-09-25_18-08-41", "timestamp": 1727287721, "time_this_iter_s": 25.45411515235901, "time_total_s": 414.4247980117798, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 414.4247980117798, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 12.11111111111111, "ram_util_percent": 31.994444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6109044628161373, "cur_kl_coeff": 2.9802322387695306e-09, "cur_lr": 1.9999999999999998e-05, "total_loss": -0.18110992600153566, "policy_loss": -0.01249310744531227, "vf_loss": 0.030692444441162727, "vf_explained_var": 0.18075814192945308, "kl": 0.003256096659179885, "entropy": 1.7628992394967513, "entropy_coeff": 0.09999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8305.5, "diff_num_grad_updates_vs_sampler_policy": 164.5}}, "num_env_steps_sampled": 13824, "num_env_steps_trained": 13824, "num_agent_steps_sampled": 54909, "num_agent_steps_trained": 54909}, "env_runners": {"episode_reward_max": 15.0, "episode_reward_min": 0.0, "episode_reward_mean": 5.049180327868853, "episode_len_mean": 217.0983606557377, "episode_media": {}, "episodes_timesteps_total": 13243, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 10.0}, "policy_reward_mean": {"default_policy": 1.2622950819672132}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 57.61476128997601, "mean_inference_ms": 1.162187546749474, "mean_action_processing_ms": 0.20299193419433828, "mean_env_wait_ms": 2.04667921617242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008666710775406634, "StateBufferConnector_ms": 0.00592528796586834, "ViewRequirementAgentConnector_ms": 0.18850271819067782}, "num_episodes": 1, "episode_return_max": 15.0, "episode_return_min": 0.0, "episode_return_mean": 5.049180327868853, "episodes_this_iter": 1}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54909, "num_agent_steps_trained": 54909, "num_env_steps_sampled": 13824, "num_env_steps_trained": 13824, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 36.691476410302094, "num_env_steps_trained_throughput_per_sec": 36.691476410302094, "timesteps_total": 13824, "num_env_steps_sampled_lifetime": 13824, "num_agent_steps_sampled_lifetime": 54909, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 54909, "timers": {"training_iteration_time_ms": 17371.399, "restore_workers_time_ms": 0.015, "training_step_time_ms": 17371.36, "sample_time_ms": 16511.333, "load_time_ms": 0.228, "load_throughput": 2242568.555, "learn_time_ms": 853.56, "learn_throughput": 599.841, "synch_weights_time_ms": 6.03}, "counters": {"num_env_steps_sampled": 13824, "num_env_steps_trained": 13824, "num_agent_steps_sampled": 54909, "num_agent_steps_trained": 54909}, "done": false, "training_iteration": 27, "trial_id": "37af9_00000", "date": "2024-09-25_18-08-55", "timestamp": 1727287735, "time_this_iter_s": 13.95746660232544, "time_total_s": 428.3822646141052, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 428.3822646141052, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 8.485, "ram_util_percent": 30.915}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6621903270002334, "cur_kl_coeff": 1.4901161193847655e-09, "cur_lr": 2e-05, "total_loss": -0.1671127213300356, "policy_loss": -0.00419864462267968, "vf_loss": 0.05293018780648708, "vf_explained_var": 0.15399258213658487, "kl": 0.0019035719793524116, "entropy": 1.7614661532063638, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8625.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_agent_steps_sampled": 56949, "num_agent_steps_trained": 56949}, "env_runners": {"episode_reward_max": 15.0, "episode_reward_min": 0.0, "episode_reward_mean": 5.0625, "episode_len_mean": 215.5, "episode_media": {}, "episodes_timesteps_total": 13792, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 10.0}, "policy_reward_mean": {"default_policy": 1.265625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 57.704009030544455, "mean_inference_ms": 1.1605211817869958, "mean_action_processing_ms": 0.20286655632681927, "mean_env_wait_ms": 2.0456441556180764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008652731776237488, "StateBufferConnector_ms": 0.00592842698097229, "ViewRequirementAgentConnector_ms": 0.18887072801589966}, "num_episodes": 3, "episode_return_max": 15.0, "episode_return_min": 0.0, "episode_return_mean": 5.0625, "episodes_this_iter": 3}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56949, "num_agent_steps_trained": 56949, "num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 34.904048859864176, "num_env_steps_trained_throughput_per_sec": 34.904048859864176, "timesteps_total": 14336, "num_env_steps_sampled_lifetime": 14336, "num_agent_steps_sampled_lifetime": 56949, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 56949, "timers": {"training_iteration_time_ms": 16173.443, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16173.405, "sample_time_ms": 15314.899, "load_time_ms": 0.225, "load_throughput": 2275358.813, "learn_time_ms": 852.14, "learn_throughput": 600.84, "synch_weights_time_ms": 5.932}, "counters": {"num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_agent_steps_sampled": 56949, "num_agent_steps_trained": 56949}, "done": false, "training_iteration": 28, "trial_id": "37af9_00000", "date": "2024-09-25_18-09-10", "timestamp": 1727287750, "time_this_iter_s": 14.673115491867065, "time_total_s": 443.0553801059723, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 443.0553801059723, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 13.728571428571426, "ram_util_percent": 30.861904761904764}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.698132506085019, "cur_kl_coeff": 7.450580596923828e-10, "cur_lr": 2e-05, "total_loss": -0.17331329156314174, "policy_loss": -0.006846204266372708, "vf_loss": 0.03906956594099381, "vf_explained_var": 0.136396768400746, "kl": 0.002333421380040495, "entropy": 1.7623447529731258, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8935.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 14848, "num_env_steps_trained": 14848, "num_agent_steps_sampled": 58939, "num_agent_steps_trained": 58939}, "env_runners": {"episode_reward_max": 15.0, "episode_reward_min": 0.0, "episode_reward_mean": 5.03030303030303, "episode_len_mean": 215.12121212121212, "episode_media": {}, "episodes_timesteps_total": 14198, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 10.0}, "policy_reward_mean": {"default_policy": 1.2575757575757576}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 57.79842342253437, "mean_inference_ms": 1.15942155594958, "mean_action_processing_ms": 0.20279639647250922, "mean_env_wait_ms": 2.0449210037431653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008650620778401693, "StateBufferConnector_ms": 0.005911697040904652, "ViewRequirementAgentConnector_ms": 0.1881740309975364}, "num_episodes": 2, "episode_return_max": 15.0, "episode_return_min": 0.0, "episode_return_mean": 5.03030303030303, "episodes_this_iter": 2}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58939, "num_agent_steps_trained": 58939, "num_env_steps_sampled": 14848, "num_env_steps_trained": 14848, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 37.70848999376747, "num_env_steps_trained_throughput_per_sec": 37.70848999376747, "timesteps_total": 14848, "num_env_steps_sampled_lifetime": 14848, "num_agent_steps_sampled_lifetime": 58939, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 58939, "timers": {"training_iteration_time_ms": 16303.103, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16303.067, "sample_time_ms": 15447.902, "load_time_ms": 0.224, "load_throughput": 2289672.298, "learn_time_ms": 848.901, "learn_throughput": 603.133, "synch_weights_time_ms": 5.831}, "counters": {"num_env_steps_sampled": 14848, "num_env_steps_trained": 14848, "num_agent_steps_sampled": 58939, "num_agent_steps_trained": 58939}, "done": false, "training_iteration": 29, "trial_id": "37af9_00000", "date": "2024-09-25_18-09-23", "timestamp": 1727287763, "time_this_iter_s": 13.580759763717651, "time_total_s": 456.63613986968994, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 456.63613986968994, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 13.284210526315789, "ram_util_percent": 31.515789473684215}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5870786448474974, "cur_kl_coeff": 3.725290298461914e-10, "cur_lr": 2e-05, "total_loss": -0.1698848748463206, "policy_loss": -0.0044075400299334435, "vf_loss": 0.03863129886849492, "vf_explained_var": 0.018384678289294243, "kl": 0.004245894285310925, "entropy": 1.7513515409082174, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9250.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_agent_steps_sampled": 60987, "num_agent_steps_trained": 60987}, "env_runners": {"episode_reward_max": 17.0, "episode_reward_min": 0.0, "episode_reward_mean": 5.279411764705882, "episode_len_mean": 218.58823529411765, "episode_media": {}, "episodes_timesteps_total": 14864, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 10.0}, "policy_reward_mean": {"default_policy": 1.3198529411764706}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 57.83203127194486, "mean_inference_ms": 1.1584180502066976, "mean_action_processing_ms": 0.20273845283909328, "mean_env_wait_ms": 2.044065792703819, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00861813040340648, "StateBufferConnector_ms": 0.005920844919541303, "ViewRequirementAgentConnector_ms": 0.18859505653381348}, "num_episodes": 2, "episode_return_max": 17.0, "episode_return_min": 0.0, "episode_return_mean": 5.279411764705882, "episodes_this_iter": 2}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60987, "num_agent_steps_trained": 60987, "num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 20.48090140686028, "num_env_steps_trained_throughput_per_sec": 20.48090140686028, "timesteps_total": 15360, "num_env_steps_sampled_lifetime": 15360, "num_agent_steps_sampled_lifetime": 60987, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 60987, "timers": {"training_iteration_time_ms": 16846.715, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16846.679, "sample_time_ms": 15988.457, "load_time_ms": 0.235, "load_throughput": 2179965.128, "learn_time_ms": 851.889, "learn_throughput": 601.017, "synch_weights_time_ms": 5.888}, "counters": {"num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_agent_steps_sampled": 60987, "num_agent_steps_trained": 60987}, "done": false, "training_iteration": 30, "trial_id": "37af9_00000", "date": "2024-09-25_18-09-48", "timestamp": 1727287788, "time_this_iter_s": 25.002162218093872, "time_total_s": 481.6383020877838, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 481.6383020877838, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 10.030555555555555, "ram_util_percent": 31.633333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6409230443018098, "cur_kl_coeff": 1.862645149230957e-10, "cur_lr": 2e-05, "total_loss": -0.16412376551137817, "policy_loss": -0.0027345169222943726, "vf_loss": 0.055754737112288094, "vf_explained_var": 0.20780912695392487, "kl": 0.0008799176813586347, "entropy": 1.7532793245007914, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9565.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 15872, "num_env_steps_trained": 15872, "num_agent_steps_sampled": 62979, "num_agent_steps_trained": 62979}, "env_runners": {"episode_reward_max": 17.0, "episode_reward_min": 0.0, "episode_reward_mean": 5.319444444444445, "episode_len_mean": 217.44444444444446, "episode_media": {}, "episodes_timesteps_total": 15656, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 10.0}, "policy_reward_mean": {"default_policy": 1.3298611111111112}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 57.95305245227342, "mean_inference_ms": 1.1564895773403532, "mean_action_processing_ms": 0.2026183664681451, "mean_env_wait_ms": 2.042590352435183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008568167686462402, "StateBufferConnector_ms": 0.005913443035549588, "ViewRequirementAgentConnector_ms": 0.1882178915871514}, "num_episodes": 4, "episode_return_max": 17.0, "episode_return_min": 0.0, "episode_return_mean": 5.319444444444445, "episodes_this_iter": 4}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62979, "num_agent_steps_trained": 62979, "num_env_steps_sampled": 15872, "num_env_steps_trained": 15872, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 30.01127004092059, "num_env_steps_trained_throughput_per_sec": 30.01127004092059, "timesteps_total": 15872, "num_env_steps_sampled_lifetime": 15872, "num_agent_steps_sampled_lifetime": 62979, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 62979, "timers": {"training_iteration_time_ms": 17108.328, "restore_workers_time_ms": 0.014, "training_step_time_ms": 17108.292, "sample_time_ms": 16247.391, "load_time_ms": 0.248, "load_throughput": 2068268.947, "learn_time_ms": 854.368, "learn_throughput": 599.274, "synch_weights_time_ms": 6.082}, "counters": {"num_env_steps_sampled": 15872, "num_env_steps_trained": 15872, "num_agent_steps_sampled": 62979, "num_agent_steps_trained": 62979}, "done": false, "training_iteration": 31, "trial_id": "37af9_00000", "date": "2024-09-25_18-10-05", "timestamp": 1727287805, "time_this_iter_s": 17.06412100791931, "time_total_s": 498.7024230957031, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 498.7024230957031, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 15.895833333333334, "ram_util_percent": 30.808333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.674417364693457, "cur_kl_coeff": 9.313225746154784e-11, "cur_lr": 2e-05, "total_loss": -0.16874085740456657, "policy_loss": 0.0010198086379997191, "vf_loss": 0.021344571870248463, "vf_explained_var": 0.21070041752630664, "kl": 0.000968365027910672, "entropy": 1.7509680601858324, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9875.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_agent_steps_sampled": 65015, "num_agent_steps_trained": 65015}, "env_runners": {"episode_reward_max": 17.0, "episode_reward_min": 0.0, "episode_reward_mean": 5.256756756756757, "episode_len_mean": 215.97297297297297, "episode_media": {}, "episodes_timesteps_total": 15982, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 10.0}, "policy_reward_mean": {"default_policy": 1.3141891891891893}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 58.011504886858546, "mean_inference_ms": 1.1558223008154322, "mean_action_processing_ms": 0.20256613175181382, "mean_env_wait_ms": 2.0420702125904735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008533774195490656, "StateBufferConnector_ms": 0.00592373512886666, "ViewRequirementAgentConnector_ms": 0.18863839072150154}, "num_episodes": 2, "episode_return_max": 17.0, "episode_return_min": 0.0, "episode_return_mean": 5.256756756756757, "episodes_this_iter": 2}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65015, "num_agent_steps_trained": 65015, "num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 46.56737194238422, "num_env_steps_trained_throughput_per_sec": 46.56737194238422, "timesteps_total": 16384, "num_env_steps_sampled_lifetime": 16384, "num_agent_steps_sampled_lifetime": 65015, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 65015, "timers": {"training_iteration_time_ms": 16684.991, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16684.955, "sample_time_ms": 15823.942, "load_time_ms": 0.245, "load_throughput": 2092452.156, "learn_time_ms": 854.649, "learn_throughput": 599.076, "synch_weights_time_ms": 5.91}, "counters": {"num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_agent_steps_sampled": 65015, "num_agent_steps_trained": 65015}, "done": false, "training_iteration": 32, "trial_id": "37af9_00000", "date": "2024-09-25_18-10-17", "timestamp": 1727287817, "time_this_iter_s": 10.999166488647461, "time_total_s": 509.7015895843506, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 509.7015895843506, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 14.44375, "ram_util_percent": 30.39375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6969289945607836, "cur_kl_coeff": 4.6566128730773915e-11, "cur_lr": 1.9999999999999998e-05, "total_loss": -0.1658424353283463, "policy_loss": -0.0029928535420560474, "vf_loss": 0.042277200147509575, "vf_explained_var": 0.33306378053896357, "kl": 0.0009562888376077547, "entropy": 1.734188811345534, "entropy_coeff": 0.09999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10195.5, "diff_num_grad_updates_vs_sampler_policy": 164.5}}, "num_env_steps_sampled": 16896, "num_env_steps_trained": 16896, "num_agent_steps_sampled": 67148, "num_agent_steps_trained": 67148}, "env_runners": {"episode_reward_max": 17.0, "episode_reward_min": 0.0, "episode_reward_mean": 5.25, "episode_len_mean": 215.3684210526316, "episode_media": {}, "episodes_timesteps_total": 16368, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 10.0}, "policy_reward_mean": {"default_policy": 1.3125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 58.054847455442136, "mean_inference_ms": 1.154803672589563, "mean_action_processing_ms": 0.20309107491491005, "mean_env_wait_ms": 2.041321443446458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008525346454821135, "StateBufferConnector_ms": 0.005927525068584241, "ViewRequirementAgentConnector_ms": 0.18898844718933105}, "num_episodes": 2, "episode_return_max": 17.0, "episode_return_min": 0.0, "episode_return_mean": 5.25, "episodes_this_iter": 2}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67148, "num_agent_steps_trained": 67148, "num_env_steps_sampled": 16896, "num_env_steps_trained": 16896, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 38.201131028920386, "num_env_steps_trained_throughput_per_sec": 38.201131028920386, "timesteps_total": 16896, "num_env_steps_sampled_lifetime": 16896, "num_agent_steps_sampled_lifetime": 67148, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 67148, "timers": {"training_iteration_time_ms": 16604.899, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16604.861, "sample_time_ms": 15741.656, "load_time_ms": 0.256, "load_throughput": 2001382.71, "learn_time_ms": 856.644, "learn_throughput": 597.681, "synch_weights_time_ms": 6.091}, "counters": {"num_env_steps_sampled": 16896, "num_env_steps_trained": 16896, "num_agent_steps_sampled": 67148, "num_agent_steps_trained": 67148}, "done": false, "training_iteration": 33, "trial_id": "37af9_00000", "date": "2024-09-25_18-10-30", "timestamp": 1727287830, "time_this_iter_s": 13.405771493911743, "time_total_s": 523.1073610782623, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 523.1073610782623, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 13.85263157894737, "ram_util_percent": 30.631578947368414}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7231265473269647, "cur_kl_coeff": 2.328306436538696e-11, "cur_lr": 2e-05, "total_loss": -0.15984866482115562, "policy_loss": 0.00036108875496973915, "vf_loss": 0.05461490736568286, "vf_explained_var": 0.19790995870867084, "kl": 0.001091056054616914, "entropy": 1.738634761687248, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10515.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_agent_steps_sampled": 69188, "num_agent_steps_trained": 69188}, "env_runners": {"episode_reward_max": 17.0, "episode_reward_min": 0.0, "episode_reward_mean": 5.35, "episode_len_mean": 215.75, "episode_media": {}, "episodes_timesteps_total": 17260, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 10.0}, "policy_reward_mean": {"default_policy": 1.3375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 58.170557692841, "mean_inference_ms": 1.1535020837085315, "mean_action_processing_ms": 0.20353331164829394, "mean_env_wait_ms": 2.040573828278614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008593499660491943, "StateBufferConnector_ms": 0.005953311920166016, "ViewRequirementAgentConnector_ms": 0.18974840641021729}, "num_episodes": 4, "episode_return_max": 17.0, "episode_return_min": 0.0, "episode_return_mean": 5.35, "episodes_this_iter": 4}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69188, "num_agent_steps_trained": 69188, "num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 28.131889801171067, "num_env_steps_trained_throughput_per_sec": 28.131889801171067, "timesteps_total": 17408, "num_env_steps_sampled_lifetime": 17408, "num_agent_steps_sampled_lifetime": 69188, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 69188, "timers": {"training_iteration_time_ms": 16999.573, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16999.536, "sample_time_ms": 16116.574, "load_time_ms": 0.263, "load_throughput": 1949599.317, "learn_time_ms": 876.218, "learn_throughput": 584.33, "synch_weights_time_ms": 6.26}, "counters": {"num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_agent_steps_sampled": 69188, "num_agent_steps_trained": 69188}, "done": false, "training_iteration": 34, "trial_id": "37af9_00000", "date": "2024-09-25_18-10-48", "timestamp": 1727287848, "time_this_iter_s": 18.20435094833374, "time_total_s": 541.3117120265961, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 541.3117120265961, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 19.173076923076927, "ram_util_percent": 30.588461538461537}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.677604038757272, "cur_kl_coeff": 1.164153218269348e-11, "cur_lr": 2e-05, "total_loss": -0.17071526392610395, "policy_loss": -0.004807832551887259, "vf_loss": 0.0325640225517418, "vf_explained_var": -0.05116199254989624, "kl": 0.0026334957120221604, "entropy": 1.7404843360185622, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10830.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 17920, "num_env_steps_trained": 17920, "num_agent_steps_sampled": 71236, "num_agent_steps_trained": 71236}, "env_runners": {"episode_reward_max": 17.0, "episode_reward_min": 0.0, "episode_reward_mean": 5.333333333333333, "episode_len_mean": 215.09876543209876, "episode_media": {}, "episodes_timesteps_total": 17423, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 10.0}, "policy_reward_mean": {"default_policy": 1.3333333333333333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 58.19906841713508, "mean_inference_ms": 1.153402806063339, "mean_action_processing_ms": 0.20376251846907098, "mean_env_wait_ms": 2.0404842629801263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008629280843852479, "StateBufferConnector_ms": 0.005965468324260947, "ViewRequirementAgentConnector_ms": 0.1901176240709093}, "num_episodes": 1, "episode_return_max": 17.0, "episode_return_min": 0.0, "episode_return_mean": 5.333333333333333, "episodes_this_iter": 1}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71236, "num_agent_steps_trained": 71236, "num_env_steps_sampled": 17920, "num_env_steps_trained": 17920, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 46.77334427471284, "num_env_steps_trained_throughput_per_sec": 46.77334427471284, "timesteps_total": 17920, "num_env_steps_sampled_lifetime": 17920, "num_agent_steps_sampled_lifetime": 71236, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 71236, "timers": {"training_iteration_time_ms": 16325.487, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16325.449, "sample_time_ms": 15444.781, "load_time_ms": 0.278, "load_throughput": 1841436.844, "learn_time_ms": 873.684, "learn_throughput": 586.024, "synch_weights_time_ms": 6.479}, "counters": {"num_env_steps_sampled": 17920, "num_env_steps_trained": 17920, "num_agent_steps_sampled": 71236, "num_agent_steps_trained": 71236}, "done": false, "training_iteration": 35, "trial_id": "37af9_00000", "date": "2024-09-25_18-10-59", "timestamp": 1727287859, "time_this_iter_s": 10.951268911361694, "time_total_s": 552.2629809379578, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 552.2629809379578, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 8.706666666666667, "ram_util_percent": 30.339999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.680059072471434, "cur_kl_coeff": 5.82076609134674e-12, "cur_lr": 2e-05, "total_loss": -0.14495606039981207, "policy_loss": 0.021038765859820188, "vf_loss": 0.03222951696990358, "vf_explained_var": 0.29671692079113376, "kl": 0.0017516622088255792, "entropy": 1.7405219924065374, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11145.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_agent_steps_sampled": 73265, "num_agent_steps_trained": 73265}, "env_runners": {"episode_reward_max": 17.0, "episode_reward_min": 0.0, "episode_reward_mean": 5.313253012048193, "episode_len_mean": 215.289156626506, "episode_media": {}, "episodes_timesteps_total": 17869, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 10.0}, "policy_reward_mean": {"default_policy": 1.3283132530120483}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 58.24439159241859, "mean_inference_ms": 1.1527047115972127, "mean_action_processing_ms": 0.20418642170017212, "mean_env_wait_ms": 2.040106142407943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008685617561799934, "StateBufferConnector_ms": 0.005972816283444324, "ViewRequirementAgentConnector_ms": 0.19042118486151638}, "num_episodes": 2, "episode_return_max": 17.0, "episode_return_min": 0.0, "episode_return_mean": 5.313253012048193, "episodes_this_iter": 2}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 73265, "num_agent_steps_trained": 73265, "num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 34.53404301023878, "num_env_steps_trained_throughput_per_sec": 34.53404301023878, "timesteps_total": 18432, "num_env_steps_sampled_lifetime": 18432, "num_agent_steps_sampled_lifetime": 73265, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 73265, "timers": {"training_iteration_time_ms": 15262.997, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15262.958, "sample_time_ms": 14380.361, "load_time_ms": 0.279, "load_throughput": 1834672.062, "learn_time_ms": 875.735, "learn_throughput": 584.652, "synch_weights_time_ms": 6.352}, "counters": {"num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_agent_steps_sampled": 73265, "num_agent_steps_trained": 73265}, "done": false, "training_iteration": 36, "trial_id": "37af9_00000", "date": "2024-09-25_18-11-14", "timestamp": 1727287874, "time_this_iter_s": 14.829187154769897, "time_total_s": 567.0921680927277, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 567.0921680927277, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 12.381818181818177, "ram_util_percent": 30.75454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5832307143317115, "cur_kl_coeff": 2.91038304567337e-12, "cur_lr": 2e-05, "total_loss": -0.16677538716204224, "policy_loss": -0.0018786439484345817, "vf_loss": 0.04357879273687309, "vf_explained_var": 0.16417633064331547, "kl": 0.0024803751345689787, "entropy": 1.7579143931788783, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11455.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 18944, "num_env_steps_trained": 18944, "num_agent_steps_sampled": 75295, "num_agent_steps_trained": 75295}, "env_runners": {"episode_reward_max": 17.0, "episode_reward_min": 0.0, "episode_reward_mean": 5.333333333333333, "episode_len_mean": 215.183908045977, "episode_media": {}, "episodes_timesteps_total": 18721, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 10.0}, "policy_reward_mean": {"default_policy": 1.3333333333333333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 58.33578586793339, "mean_inference_ms": 1.1520781824839867, "mean_action_processing_ms": 0.20472760591413253, "mean_env_wait_ms": 2.0398745689794944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008683917166172773, "StateBufferConnector_ms": 0.005988142956262347, "ViewRequirementAgentConnector_ms": 0.19094752169203486}, "num_episodes": 4, "episode_return_max": 17.0, "episode_return_min": 0.0, "episode_return_mean": 5.333333333333333, "episodes_this_iter": 4}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75295, "num_agent_steps_trained": 75295, "num_env_steps_sampled": 18944, "num_env_steps_trained": 18944, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 29.307163658807593, "num_env_steps_trained_throughput_per_sec": 29.307163658807593, "timesteps_total": 18944, "num_env_steps_sampled_lifetime": 18944, "num_agent_steps_sampled_lifetime": 75295, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 75295, "timers": {"training_iteration_time_ms": 15614.591, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15614.551, "sample_time_ms": 14735.195, "load_time_ms": 0.291, "load_throughput": 1757927.02, "learn_time_ms": 872.012, "learn_throughput": 587.148, "synch_weights_time_ms": 6.814}, "counters": {"num_env_steps_sampled": 18944, "num_env_steps_trained": 18944, "num_agent_steps_sampled": 75295, "num_agent_steps_trained": 75295}, "done": false, "training_iteration": 37, "trial_id": "37af9_00000", "date": "2024-09-25_18-11-31", "timestamp": 1727287891, "time_this_iter_s": 17.473814249038696, "time_total_s": 584.5659823417664, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 584.5659823417664, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 18.833333333333332, "ram_util_percent": 30.462499999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6401047887047753, "cur_kl_coeff": 1.455191522836685e-12, "cur_lr": 2e-05, "total_loss": -0.17501242707367054, "policy_loss": -0.00802377546497155, "vf_loss": 0.032517383268532284, "vf_explained_var": 0.06460717357695103, "kl": 0.005442361383576966, "entropy": 1.7511799704283475, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11770.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_agent_steps_sampled": 77343, "num_agent_steps_trained": 77343}, "env_runners": {"episode_reward_max": 17.0, "episode_reward_min": 0.0, "episode_reward_mean": 5.303370786516854, "episode_len_mean": 214.46067415730337, "episode_media": {}, "episodes_timesteps_total": 19087, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 10.0}, "policy_reward_mean": {"default_policy": 1.3258426966292134}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 58.37923615571927, "mean_inference_ms": 1.1520889516482145, "mean_action_processing_ms": 0.20486590233841512, "mean_env_wait_ms": 2.039987980287577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008714065123140142, "StateBufferConnector_ms": 0.006010827053798719, "ViewRequirementAgentConnector_ms": 0.19185382328676373}, "num_episodes": 2, "episode_return_max": 17.0, "episode_return_min": 0.0, "episode_return_mean": 5.303370786516854, "episodes_this_iter": 2}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 77343, "num_agent_steps_trained": 77343, "num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 40.336931327349475, "num_env_steps_trained_throughput_per_sec": 40.336931327349475, "timesteps_total": 19456, "num_env_steps_sampled_lifetime": 19456, "num_agent_steps_sampled_lifetime": 77343, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 77343, "timers": {"training_iteration_time_ms": 15417.021, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15416.98, "sample_time_ms": 14532.316, "load_time_ms": 0.305, "load_throughput": 1677590.538, "learn_time_ms": 877.065, "learn_throughput": 583.765, "synch_weights_time_ms": 7.051}, "counters": {"num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_agent_steps_sampled": 77343, "num_agent_steps_trained": 77343}, "done": false, "training_iteration": 38, "trial_id": "37af9_00000", "date": "2024-09-25_18-11-44", "timestamp": 1727287904, "time_this_iter_s": 12.697259426116943, "time_total_s": 597.2632417678833, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 597.2632417678833, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 12.916666666666666, "ram_util_percent": 30.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7556216299533844, "cur_kl_coeff": 1.455191522836685e-12, "cur_lr": 2e-05, "total_loss": -0.16616358640453507, "policy_loss": -0.005424277159956194, "vf_loss": 0.046007429668679836, "vf_explained_var": -0.10407902713744871, "kl": 0.0030258003177457047, "entropy": 1.7224116340760263, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12085.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 19968, "num_env_steps_trained": 19968, "num_agent_steps_sampled": 79377, "num_agent_steps_trained": 79377}, "env_runners": {"episode_reward_max": 17.0, "episode_reward_min": 0.0, "episode_reward_mean": 5.260869565217392, "episode_len_mean": 213.0, "episode_media": {}, "episodes_timesteps_total": 19596, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 10.0}, "policy_reward_mean": {"default_policy": 1.315217391304348}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 58.45865904237489, "mean_inference_ms": 1.1517626855023013, "mean_action_processing_ms": 0.20511991280764028, "mean_env_wait_ms": 2.0400960936635584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008709016053572945, "StateBufferConnector_ms": 0.006017218465390412, "ViewRequirementAgentConnector_ms": 0.19204772037008536}, "num_episodes": 3, "episode_return_max": 17.0, "episode_return_min": 0.0, "episode_return_mean": 5.260869565217392, "episodes_this_iter": 3}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 79377, "num_agent_steps_trained": 79377, "num_env_steps_sampled": 19968, "num_env_steps_trained": 19968, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 41.31064105388701, "num_env_steps_trained_throughput_per_sec": 41.31064105388701, "timesteps_total": 19968, "num_env_steps_sampled_lifetime": 19968, "num_agent_steps_sampled_lifetime": 79377, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 79377, "timers": {"training_iteration_time_ms": 15298.626, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15298.586, "sample_time_ms": 14411.565, "load_time_ms": 0.313, "load_throughput": 1634932.355, "learn_time_ms": 879.205, "learn_throughput": 582.344, "synch_weights_time_ms": 7.253}, "counters": {"num_env_steps_sampled": 19968, "num_env_steps_trained": 19968, "num_agent_steps_sampled": 79377, "num_agent_steps_trained": 79377}, "done": false, "training_iteration": 39, "trial_id": "37af9_00000", "date": "2024-09-25_18-11-57", "timestamp": 1727287917, "time_this_iter_s": 12.397597551345825, "time_total_s": 609.6608393192291, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 609.6608393192291, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 17.12777777777778, "ram_util_percent": 30.627777777777776}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6248866328969598, "cur_kl_coeff": 7.275957614183425e-13, "cur_lr": 2e-05, "total_loss": -0.16665636791149155, "policy_loss": -0.0012834184526582249, "vf_loss": 0.028245860164133774, "vf_explained_var": -0.03233628645539284, "kl": 0.0004236745749320203, "entropy": 1.7243440940976142, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12400.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_agent_steps_sampled": 81425, "num_agent_steps_trained": 81425}, "env_runners": {"episode_reward_max": 17.0, "episode_reward_min": 0.0, "episode_reward_mean": 5.26595744680851, "episode_len_mean": 213.2127659574468, "episode_media": {}, "episodes_timesteps_total": 20042, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 10.0}, "policy_reward_mean": {"default_policy": 1.3164893617021276}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 58.49307100789547, "mean_inference_ms": 1.1512999371194277, "mean_action_processing_ms": 0.20543162164883202, "mean_env_wait_ms": 2.039949336181701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008728149089407413, "StateBufferConnector_ms": 0.006027931862689079, "ViewRequirementAgentConnector_ms": 0.1924938343940897}, "num_episodes": 2, "episode_return_max": 17.0, "episode_return_min": 0.0, "episode_return_mean": 5.26595744680851, "episodes_this_iter": 2}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 81425, "num_agent_steps_trained": 81425, "num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 28.965367771455345, "num_env_steps_trained_throughput_per_sec": 28.965367771455345, "timesteps_total": 20480, "num_env_steps_sampled_lifetime": 20480, "num_agent_steps_sampled_lifetime": 81425, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 81425, "timers": {"training_iteration_time_ms": 14566.365, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14566.323, "sample_time_ms": 13675.316, "load_time_ms": 0.316, "load_throughput": 1619520.097, "learn_time_ms": 883.265, "learn_throughput": 579.667, "synch_weights_time_ms": 7.173}, "counters": {"num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_agent_steps_sampled": 81425, "num_agent_steps_trained": 81425}, "done": false, "training_iteration": 40, "trial_id": "37af9_00000", "date": "2024-09-25_18-12-14", "timestamp": 1727287934, "time_this_iter_s": 17.679813623428345, "time_total_s": 627.3406529426575, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 627.3406529426575, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 10.767999999999999, "ram_util_percent": 30.504}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.684493925037884, "cur_kl_coeff": 3.6379788070917126e-13, "cur_lr": 2e-05, "total_loss": -0.16382866953649827, "policy_loss": 0.0009900621258683742, "vf_loss": 0.03838160803594116, "vf_explained_var": 0.39546561721832524, "kl": 0.0017992328503034347, "entropy": 1.7441412944947519, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12715.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 20992, "num_env_steps_trained": 20992, "num_agent_steps_sampled": 83444, "num_agent_steps_trained": 83444}, "env_runners": {"episode_reward_max": 17.0, "episode_reward_min": 0.0, "episode_reward_mean": 5.216494845360825, "episode_len_mean": 212.48453608247422, "episode_media": {}, "episodes_timesteps_total": 20611, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 10.0}, "policy_reward_mean": {"default_policy": 1.3041237113402062}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 58.532133043778764, "mean_inference_ms": 1.151305002008318, "mean_action_processing_ms": 0.2057152417817273, "mean_env_wait_ms": 2.0401351699246515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008745783383084326, "StateBufferConnector_ms": 0.006052390816285438, "ViewRequirementAgentConnector_ms": 0.1935808928971438}, "num_episodes": 3, "episode_return_max": 17.0, "episode_return_min": 0.0, "episode_return_mean": 5.216494845360825, "episodes_this_iter": 3}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83444, "num_agent_steps_trained": 83444, "num_env_steps_sampled": 20992, "num_env_steps_trained": 20992, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 36.15095453976539, "num_env_steps_trained_throughput_per_sec": 36.15095453976539, "timesteps_total": 20992, "num_env_steps_sampled_lifetime": 20992, "num_agent_steps_sampled_lifetime": 83444, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 83444, "timers": {"training_iteration_time_ms": 14276.623, "restore_workers_time_ms": 0.016, "training_step_time_ms": 14276.58, "sample_time_ms": 13383.903, "load_time_ms": 0.319, "load_throughput": 1607277.635, "learn_time_ms": 885.18, "learn_throughput": 578.413, "synch_weights_time_ms": 6.922}, "counters": {"num_env_steps_sampled": 20992, "num_env_steps_trained": 20992, "num_agent_steps_sampled": 83444, "num_agent_steps_trained": 83444}, "done": false, "training_iteration": 41, "trial_id": "37af9_00000", "date": "2024-09-25_18-12-28", "timestamp": 1727287948, "time_this_iter_s": 14.168092012405396, "time_total_s": 641.5087449550629, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 641.5087449550629, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 16.490000000000002, "ram_util_percent": 30.175000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6533875399269163, "cur_kl_coeff": 1.8189894035458563e-13, "cur_lr": 2e-05, "total_loss": -0.17994355250702937, "policy_loss": -0.014154330069140996, "vf_loss": 0.03684818552665092, "vf_explained_var": 0.016569668240845204, "kl": 0.0071725644795475494, "entropy": 1.750012657418847, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13030.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled": 85544, "num_agent_steps_trained": 85544}, "env_runners": {"episode_reward_max": 17.0, "episode_reward_min": 0.0, "episode_reward_mean": 5.214285714285714, "episode_len_mean": 212.59183673469389, "episode_media": {}, "episodes_timesteps_total": 20834, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 10.0}, "policy_reward_mean": {"default_policy": 1.3035714285714286}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0], "episode_lengths": [183, 243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 58.55978066263643, "mean_inference_ms": 1.151004964274566, "mean_action_processing_ms": 0.20581280113812328, "mean_env_wait_ms": 2.040085418325661, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00877015444697166, "StateBufferConnector_ms": 0.006049749802569954, "ViewRequirementAgentConnector_ms": 0.1935647458446269}, "num_episodes": 1, "episode_return_max": 17.0, "episode_return_min": 0.0, "episode_return_mean": 5.214285714285714, "episodes_this_iter": 1}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 85544, "num_agent_steps_trained": 85544, "num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 34.391671998417344, "num_env_steps_trained_throughput_per_sec": 34.391671998417344, "timesteps_total": 21504, "num_env_steps_sampled_lifetime": 21504, "num_agent_steps_sampled_lifetime": 85544, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 85544, "timers": {"training_iteration_time_ms": 14665.873, "restore_workers_time_ms": 0.016, "training_step_time_ms": 14665.831, "sample_time_ms": 13768.869, "load_time_ms": 0.322, "load_throughput": 1588963.114, "learn_time_ms": 889.288, "learn_throughput": 575.741, "synch_weights_time_ms": 7.096}, "counters": {"num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled": 85544, "num_agent_steps_trained": 85544}, "done": false, "training_iteration": 42, "trial_id": "37af9_00000", "date": "2024-09-25_18-12-43", "timestamp": 1727287963, "time_this_iter_s": 14.891162633895874, "time_total_s": 656.3999075889587, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 656.3999075889587, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 8.722727272727273, "ram_util_percent": 30.522727272727266}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6508166889660061, "cur_kl_coeff": 1.8189894035458563e-13, "cur_lr": 2e-05, "total_loss": -0.17310985249641817, "policy_loss": -0.00489686086657457, "vf_loss": 0.02840146433300106, "vf_explained_var": 0.12466584853827953, "kl": 0.003451090906479237, "entropy": 1.7531335782259703, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13350.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 22016, "num_env_steps_trained": 22016, "num_agent_steps_sampled": 87592, "num_agent_steps_trained": 87592}, "env_runners": {"episode_reward_max": 17.0, "episode_reward_min": 0.0, "episode_reward_mean": 5.2, "episode_len_mean": 212.2, "episode_media": {}, "episodes_timesteps_total": 21220, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 10.0}, "policy_reward_mean": {"default_policy": 1.3}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0, 6.0, 11.0, 4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0], "episode_lengths": [243, 183, 343, 163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223], "policy_default_policy_reward": [2.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 6.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 58.747583071043664, "mean_inference_ms": 1.1498490178340972, "mean_action_processing_ms": 0.20590716766621506, "mean_env_wait_ms": 2.0398202491299493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008748054504394531, "StateBufferConnector_ms": 0.006074428558349609, "ViewRequirementAgentConnector_ms": 0.1943669319152832}, "num_episodes": 3, "episode_return_max": 17.0, "episode_return_min": 0.0, "episode_return_mean": 5.2, "episodes_this_iter": 3}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 87592, "num_agent_steps_trained": 87592, "num_env_steps_sampled": 22016, "num_env_steps_trained": 22016, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 35.128843650263896, "num_env_steps_trained_throughput_per_sec": 35.128843650263896, "timesteps_total": 22016, "num_env_steps_sampled_lifetime": 22016, "num_agent_steps_sampled_lifetime": 87592, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 87592, "timers": {"training_iteration_time_ms": 14783.09, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14783.049, "sample_time_ms": 13885.07, "load_time_ms": 0.319, "load_throughput": 1606916.827, "learn_time_ms": 890.3, "learn_throughput": 575.087, "synch_weights_time_ms": 7.104}, "counters": {"num_env_steps_sampled": 22016, "num_env_steps_trained": 22016, "num_agent_steps_sampled": 87592, "num_agent_steps_trained": 87592}, "done": false, "training_iteration": 43, "trial_id": "37af9_00000", "date": "2024-09-25_18-12-58", "timestamp": 1727287978, "time_this_iter_s": 14.579630613327026, "time_total_s": 670.9795382022858, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 670.9795382022858, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 16.689999999999998, "ram_util_percent": 30.93}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6542373754316941, "cur_kl_coeff": 9.094947017729282e-14, "cur_lr": 2e-05, "total_loss": -0.17863756861770524, "policy_loss": -0.013871894765179605, "vf_loss": 0.03675153630356363, "vf_explained_var": 0.1299805175513029, "kl": 0.013000923681730493, "entropy": 1.7395355377346278, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13670.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 22528, "num_env_steps_trained": 22528, "num_agent_steps_sampled": 89640, "num_agent_steps_trained": 89640}, "env_runners": {"episode_reward_max": 17.0, "episode_reward_min": 0.0, "episode_reward_mean": 5.1, "episode_len_mean": 210.0, "episode_media": {}, "episodes_timesteps_total": 21000, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 10.0}, "policy_reward_mean": {"default_policy": 1.275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.0, 4.0, 2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0], "episode_lengths": [163, 223, 183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163], "policy_default_policy_reward": [4.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 59.01044516142383, "mean_inference_ms": 1.1476593548066882, "mean_action_processing_ms": 0.20590174461856034, "mean_env_wait_ms": 2.03773666716403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008747339248657227, "StateBufferConnector_ms": 0.006093263626098633, "ViewRequirementAgentConnector_ms": 0.19549274444580078}, "num_episodes": 3, "episode_return_max": 17.0, "episode_return_min": 0.0, "episode_return_mean": 5.1, "episodes_this_iter": 3}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 89640, "num_agent_steps_trained": 89640, "num_env_steps_sampled": 22528, "num_env_steps_trained": 22528, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 35.1372026666452, "num_env_steps_trained_throughput_per_sec": 35.1372026666452, "timesteps_total": 22528, "num_env_steps_sampled_lifetime": 22528, "num_agent_steps_sampled_lifetime": 89640, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 89640, "timers": {"training_iteration_time_ms": 14420.237, "restore_workers_time_ms": 0.016, "training_step_time_ms": 14420.194, "sample_time_ms": 13536.676, "load_time_ms": 0.32, "load_throughput": 1598305.781, "learn_time_ms": 875.83, "learn_throughput": 584.588, "synch_weights_time_ms": 7.116}, "counters": {"num_env_steps_sampled": 22528, "num_env_steps_trained": 22528, "num_agent_steps_sampled": 89640, "num_agent_steps_trained": 89640}, "done": false, "training_iteration": 44, "trial_id": "37af9_00000", "date": "2024-09-25_18-13-13", "timestamp": 1727287993, "time_this_iter_s": 14.574588060379028, "time_total_s": 685.5541262626648, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 685.5541262626648, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 17.638095238095236, "ram_util_percent": 31.723809523809532}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6291644376702606, "cur_kl_coeff": 9.094947017729282e-14, "cur_lr": 2e-05, "total_loss": -0.1642832134035416, "policy_loss": -0.003359819669276476, "vf_loss": 0.05307152975583449, "vf_explained_var": -0.02369542568922043, "kl": 0.002241231869054161, "entropy": 1.7419127020984888, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13990.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 23040, "num_env_steps_trained": 23040, "num_agent_steps_sampled": 91688, "num_agent_steps_trained": 91688}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 0.0, "episode_reward_mean": 5.28, "episode_len_mean": 213.2, "episode_media": {}, "episodes_timesteps_total": 21320, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 12.0}, "policy_reward_mean": {"default_policy": 1.32}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0], "episode_lengths": [183, 183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163], "policy_default_policy_reward": [0.0, 1.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 59.15639539395971, "mean_inference_ms": 1.1460175064557725, "mean_action_processing_ms": 0.20605958949521258, "mean_env_wait_ms": 2.036776094100012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008811235427856445, "StateBufferConnector_ms": 0.006108283996582031, "ViewRequirementAgentConnector_ms": 0.19649529457092285}, "num_episodes": 2, "episode_return_max": 22.0, "episode_return_min": 0.0, "episode_return_mean": 5.28, "episodes_this_iter": 2}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91688, "num_agent_steps_trained": 91688, "num_env_steps_sampled": 23040, "num_env_steps_trained": 23040, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 15.71858858428281, "num_env_steps_trained_throughput_per_sec": 15.71858858428281, "timesteps_total": 23040, "num_env_steps_sampled_lifetime": 23040, "num_agent_steps_sampled_lifetime": 91688, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 91688, "timers": {"training_iteration_time_ms": 16582.886, "restore_workers_time_ms": 0.016, "training_step_time_ms": 16582.843, "sample_time_ms": 15700.78, "load_time_ms": 0.307, "load_throughput": 1668596.463, "learn_time_ms": 874.125, "learn_throughput": 585.729, "synch_weights_time_ms": 7.375}, "counters": {"num_env_steps_sampled": 23040, "num_env_steps_trained": 23040, "num_agent_steps_sampled": 91688, "num_agent_steps_trained": 91688}, "done": false, "training_iteration": 45, "trial_id": "37af9_00000", "date": "2024-09-25_18-13-45", "timestamp": 1727288025, "time_this_iter_s": 32.57644605636597, "time_total_s": 718.1305723190308, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 718.1305723190308, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 9.748936170212767, "ram_util_percent": 32.21702127659576}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7254656219389289, "cur_kl_coeff": 4.547473508864641e-14, "cur_lr": 2e-05, "total_loss": -0.16606036240409594, "policy_loss": -0.004015469204750844, "vf_loss": 0.04422222106368281, "vf_explained_var": -0.1400648456066847, "kl": 0.0008252447505739724, "entropy": 1.73100447319448, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14310.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 23552, "num_env_steps_trained": 23552, "num_agent_steps_sampled": 93736, "num_agent_steps_trained": 93736}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 0.0, "episode_reward_mean": 5.3, "episode_len_mean": 213.0, "episode_media": {}, "episodes_timesteps_total": 21300, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 12.0}, "policy_reward_mean": {"default_policy": 1.325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.0, 7.0, 3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0], "episode_lengths": [183, 223, 163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163], "policy_default_policy_reward": [4.0, 3.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 59.23791335545109, "mean_inference_ms": 1.1454881048122516, "mean_action_processing_ms": 0.20598879332651499, "mean_env_wait_ms": 2.036275520322289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008788585662841797, "StateBufferConnector_ms": 0.0061054229736328125, "ViewRequirementAgentConnector_ms": 0.1966545581817627}, "num_episodes": 1, "episode_return_max": 22.0, "episode_return_min": 0.0, "episode_return_mean": 5.3, "episodes_this_iter": 1}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 93736, "num_agent_steps_trained": 93736, "num_env_steps_sampled": 23552, "num_env_steps_trained": 23552, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 46.891501018312105, "num_env_steps_trained_throughput_per_sec": 46.891501018312105, "timesteps_total": 23552, "num_env_steps_sampled_lifetime": 23552, "num_agent_steps_sampled_lifetime": 93736, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 93736, "timers": {"training_iteration_time_ms": 16192.174, "restore_workers_time_ms": 0.017, "training_step_time_ms": 16192.129, "sample_time_ms": 15306.887, "load_time_ms": 0.302, "load_throughput": 1696676.66, "learn_time_ms": 877.029, "learn_throughput": 583.789, "synch_weights_time_ms": 7.651}, "counters": {"num_env_steps_sampled": 23552, "num_env_steps_trained": 23552, "num_agent_steps_sampled": 93736, "num_agent_steps_trained": 93736}, "done": false, "training_iteration": 46, "trial_id": "37af9_00000", "date": "2024-09-25_18-13-56", "timestamp": 1727288036, "time_this_iter_s": 10.922243118286133, "time_total_s": 729.0528154373169, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 729.0528154373169, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 10.780000000000001, "ram_util_percent": 30.90666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7413416888099164, "cur_kl_coeff": 2.2737367544323204e-14, "cur_lr": 2e-05, "total_loss": -0.16620801907629357, "policy_loss": -0.004880707538541173, "vf_loss": 0.04793144389295776, "vf_explained_var": -0.025517834536731242, "kl": 0.002732623806686263, "entropy": 1.7331016577780247, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14630.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 24064, "num_env_steps_trained": 24064, "num_agent_steps_sampled": 95784, "num_agent_steps_trained": 95784}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 0.0, "episode_reward_mean": 5.25, "episode_len_mean": 212.4, "episode_media": {}, "episodes_timesteps_total": 21240, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 12.0}, "policy_reward_mean": {"default_policy": 1.3125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0, 8.0, 0.0, 4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0], "episode_lengths": [163, 243, 163, 183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183], "policy_default_policy_reward": [0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 59.329912094436494, "mean_inference_ms": 1.1444145701807047, "mean_action_processing_ms": 0.2060555733722089, "mean_env_wait_ms": 2.0359357986152613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008823633193969727, "StateBufferConnector_ms": 0.006108999252319336, "ViewRequirementAgentConnector_ms": 0.19699668884277344}, "num_episodes": 2, "episode_return_max": 22.0, "episode_return_min": 0.0, "episode_return_mean": 5.25, "episodes_this_iter": 2}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 95784, "num_agent_steps_trained": 95784, "num_env_steps_sampled": 24064, "num_env_steps_trained": 24064, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 42.04733957554909, "num_env_steps_trained_throughput_per_sec": 42.04733957554909, "timesteps_total": 24064, "num_env_steps_sampled_lifetime": 24064, "num_agent_steps_sampled_lifetime": 95784, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 95784, "timers": {"training_iteration_time_ms": 15662.836, "restore_workers_time_ms": 0.017, "training_step_time_ms": 15662.79, "sample_time_ms": 14773.818, "load_time_ms": 0.291, "load_throughput": 1761531.989, "learn_time_ms": 881.219, "learn_throughput": 581.013, "synch_weights_time_ms": 7.206}, "counters": {"num_env_steps_sampled": 24064, "num_env_steps_trained": 24064, "num_agent_steps_sampled": 95784, "num_agent_steps_trained": 95784}, "done": false, "training_iteration": 47, "trial_id": "37af9_00000", "date": "2024-09-25_18-14-08", "timestamp": 1727288048, "time_this_iter_s": 12.179972887039185, "time_total_s": 741.2327883243561, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 741.2327883243561, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 12.511764705882353, "ram_util_percent": 32.023529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7141407646704465, "cur_kl_coeff": 1.1368683772161602e-14, "cur_lr": 2e-05, "total_loss": -0.16648670781578404, "policy_loss": -0.005119796196231619, "vf_loss": 0.05277054421712819, "vf_explained_var": 0.00475172158330679, "kl": 0.0036236507523909724, "entropy": 1.745595433562994, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14950.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_agent_steps_sampled": 97832, "num_agent_steps_trained": 97832}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 0.0, "episode_reward_mean": 5.53, "episode_len_mean": 216.8, "episode_media": {}, "episodes_timesteps_total": 21680, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.3825}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.0, 5.0, 2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0], "episode_lengths": [183, 203, 183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183], "policy_default_policy_reward": [1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 59.40699820340017, "mean_inference_ms": 1.142363209599001, "mean_action_processing_ms": 0.20634277840752996, "mean_env_wait_ms": 2.0340496918053654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008833885192871094, "StateBufferConnector_ms": 0.0061321258544921875, "ViewRequirementAgentConnector_ms": 0.1981520652770996}, "num_episodes": 3, "episode_return_max": 22.0, "episode_return_min": 0.0, "episode_return_mean": 5.53, "episodes_this_iter": 3}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 97832, "num_agent_steps_trained": 97832, "num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 16.485057507687813, "num_env_steps_trained_throughput_per_sec": 16.485057507687813, "timesteps_total": 24576, "num_env_steps_sampled_lifetime": 24576, "num_agent_steps_sampled_lifetime": 97832, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 97832, "timers": {"training_iteration_time_ms": 17499.371, "restore_workers_time_ms": 0.017, "training_step_time_ms": 17499.324, "sample_time_ms": 16608.804, "load_time_ms": 0.294, "load_throughput": 1740967.692, "learn_time_ms": 882.559, "learn_throughput": 580.131, "synch_weights_time_ms": 7.407}, "counters": {"num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_agent_steps_sampled": 97832, "num_agent_steps_trained": 97832}, "done": false, "training_iteration": 48, "trial_id": "37af9_00000", "date": "2024-09-25_18-14-39", "timestamp": 1727288079, "time_this_iter_s": 31.06211519241333, "time_total_s": 772.2949035167694, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 772.2949035167694, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 12.804444444444442, "ram_util_percent": 32.98888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5997855474473909, "cur_kl_coeff": 5.684341886080801e-15, "cur_lr": 2e-05, "total_loss": -0.17108701823744923, "policy_loss": -0.0033305849472526463, "vf_loss": 0.02940795557151432, "vf_explained_var": 0.013401390425860882, "kl": 0.0008599818872280452, "entropy": 1.7510842017829418, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15270.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 25088, "num_env_steps_trained": 25088, "num_agent_steps_sampled": 99880, "num_agent_steps_trained": 99880}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 0.0, "episode_reward_mean": 5.54, "episode_len_mean": 217.2, "episode_media": {}, "episodes_timesteps_total": 21720, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 2.0, 2.0, 3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0], "episode_lengths": [183, 203, 183, 203, 163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243], "policy_default_policy_reward": [1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 59.552077664035544, "mean_inference_ms": 1.1420671382230874, "mean_action_processing_ms": 0.206504426897441, "mean_env_wait_ms": 2.0343707115862233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00881814956665039, "StateBufferConnector_ms": 0.006131172180175781, "ViewRequirementAgentConnector_ms": 0.19815778732299805}, "num_episodes": 2, "episode_return_max": 22.0, "episode_return_min": 0.0, "episode_return_mean": 5.54, "episodes_this_iter": 2}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 99880, "num_agent_steps_trained": 99880, "num_env_steps_sampled": 25088, "num_env_steps_trained": 25088, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 32.538095437665184, "num_env_steps_trained_throughput_per_sec": 32.538095437665184, "timesteps_total": 25088, "num_env_steps_sampled_lifetime": 25088, "num_agent_steps_sampled_lifetime": 99880, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 99880, "timers": {"training_iteration_time_ms": 17833.521, "restore_workers_time_ms": 0.018, "training_step_time_ms": 17833.473, "sample_time_ms": 16938.853, "load_time_ms": 0.296, "load_throughput": 1730027.913, "learn_time_ms": 886.819, "learn_throughput": 577.344, "synch_weights_time_ms": 7.245}, "counters": {"num_env_steps_sampled": 25088, "num_env_steps_trained": 25088, "num_agent_steps_sampled": 99880, "num_agent_steps_trained": 99880}, "done": false, "training_iteration": 49, "trial_id": "37af9_00000", "date": "2024-09-25_18-14-55", "timestamp": 1727288095, "time_this_iter_s": 15.738202810287476, "time_total_s": 788.0331063270569, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 788.0331063270569, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 12.895454545454548, "ram_util_percent": 32.718181818181826}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6193880987353623, "cur_kl_coeff": 2.8421709430404005e-15, "cur_lr": 2e-05, "total_loss": -0.16309914778685197, "policy_loss": -0.0019672196271130816, "vf_loss": 0.048733707252358725, "vf_explained_var": 0.3107003616169095, "kl": 0.00041167719571859606, "entropy": 1.733153523132205, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15590.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_agent_steps_sampled": 101928, "num_agent_steps_trained": 101928}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 0.0, "episode_reward_mean": 5.72, "episode_len_mean": 218.6, "episode_media": {}, "episodes_timesteps_total": 21860, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.43}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0], "episode_lengths": [163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303], "policy_default_policy_reward": [1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 59.73684593983886, "mean_inference_ms": 1.1411597961775695, "mean_action_processing_ms": 0.206899593411088, "mean_env_wait_ms": 2.034492565552029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008908510208129883, "StateBufferConnector_ms": 0.0061626434326171875, "ViewRequirementAgentConnector_ms": 0.19946670532226562}, "num_episodes": 4, "episode_return_max": 22.0, "episode_return_min": 0.0, "episode_return_mean": 5.72, "episodes_this_iter": 4}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 101928, "num_agent_steps_trained": 101928, "num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 26.575975358097754, "num_env_steps_trained_throughput_per_sec": 26.575975358097754, "timesteps_total": 25600, "num_env_steps_sampled_lifetime": 25600, "num_agent_steps_sampled_lifetime": 101928, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 101928, "timers": {"training_iteration_time_ms": 17992.445, "restore_workers_time_ms": 0.018, "training_step_time_ms": 17992.397, "sample_time_ms": 17096.922, "load_time_ms": 0.294, "load_throughput": 1741250.019, "learn_time_ms": 887.368, "learn_throughput": 576.987, "synch_weights_time_ms": 7.551}, "counters": {"num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_agent_steps_sampled": 101928, "num_agent_steps_trained": 101928}, "done": false, "training_iteration": 50, "trial_id": "37af9_00000", "date": "2024-09-25_18-15-14", "timestamp": 1727288114, "time_this_iter_s": 19.26969861984253, "time_total_s": 807.3028049468994, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 807.3028049468994, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 17.681481481481484, "ram_util_percent": 33.129629629629626}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6344227882334963, "cur_kl_coeff": 1.4210854715202003e-15, "cur_lr": 2e-05, "total_loss": -0.17077571503687067, "policy_loss": -0.004542476694041397, "vf_loss": 0.03512632057336305, "vf_explained_var": -0.33510410971939564, "kl": 0.0014926273040209992, "entropy": 1.7501481484621764, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15910.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 26112, "num_env_steps_trained": 26112, "num_agent_steps_sampled": 103976, "num_agent_steps_trained": 103976}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 0.0, "episode_reward_mean": 5.72, "episode_len_mean": 218.6, "episode_media": {}, "episodes_timesteps_total": 21860, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.43}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0, 1.0, 13.0, 11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0], "episode_lengths": [163, 163, 363, 303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303], "policy_default_policy_reward": [1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 59.73684593983886, "mean_inference_ms": 1.1411597961775695, "mean_action_processing_ms": 0.206899593411088, "mean_env_wait_ms": 2.034492565552029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008908510208129883, "StateBufferConnector_ms": 0.0061626434326171875, "ViewRequirementAgentConnector_ms": 0.19946670532226562}, "num_episodes": 0, "episode_return_max": 22.0, "episode_return_min": 0.0, "episode_return_mean": 5.72, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 103976, "num_agent_steps_trained": 103976, "num_env_steps_sampled": 26112, "num_env_steps_trained": 26112, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 245.14989337753485, "num_env_steps_trained_throughput_per_sec": 245.14989337753485, "timesteps_total": 26112, "num_env_steps_sampled_lifetime": 26112, "num_agent_steps_sampled_lifetime": 103976, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 103976, "timers": {"training_iteration_time_ms": 16785.014, "restore_workers_time_ms": 0.019, "training_step_time_ms": 16784.964, "sample_time_ms": 15886.287, "load_time_ms": 0.279, "load_throughput": 1833732.088, "learn_time_ms": 890.497, "learn_throughput": 574.96, "synch_weights_time_ms": 7.64}, "counters": {"num_env_steps_sampled": 26112, "num_env_steps_trained": 26112, "num_agent_steps_sampled": 103976, "num_agent_steps_trained": 103976}, "done": false, "training_iteration": 51, "trial_id": "37af9_00000", "date": "2024-09-25_18-15-16", "timestamp": 1727288116, "time_this_iter_s": 2.0931403636932373, "time_total_s": 809.3959453105927, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 809.3959453105927, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 15.866666666666665, "ram_util_percent": 32.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.697175125152834, "cur_kl_coeff": 7.105427357601001e-16, "cur_lr": 2e-05, "total_loss": -0.17378926528767952, "policy_loss": -0.008346848946905905, "vf_loss": 0.038703464021185234, "vf_explained_var": 0.23070165264991022, "kl": 0.005378712356118117, "entropy": 1.7511828422546387, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16225.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 26624, "num_env_steps_trained": 26624, "num_agent_steps_sampled": 106004, "num_agent_steps_trained": 106004}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 0.0, "episode_reward_mean": 5.68, "episode_len_mean": 217.4, "episode_media": {}, "episodes_timesteps_total": 21740, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.42}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.0, 9.0, 3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0], "episode_lengths": [303, 243, 183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203], "policy_default_policy_reward": [5.0, 6.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 59.75117535100961, "mean_inference_ms": 1.1406169696179926, "mean_action_processing_ms": 0.20715899545058988, "mean_env_wait_ms": 2.0347819576788684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008925437927246094, "StateBufferConnector_ms": 0.006179094314575195, "ViewRequirementAgentConnector_ms": 0.19999432563781738}, "num_episodes": 3, "episode_return_max": 22.0, "episode_return_min": 0.0, "episode_return_mean": 5.68, "episodes_this_iter": 3}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 106004, "num_agent_steps_trained": 106004, "num_env_steps_sampled": 26624, "num_env_steps_trained": 26624, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 37.75208649767667, "num_env_steps_trained_throughput_per_sec": 37.75208649767667, "timesteps_total": 26624, "num_env_steps_sampled_lifetime": 26624, "num_agent_steps_sampled_lifetime": 106004, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 106004, "timers": {"training_iteration_time_ms": 16652.498, "restore_workers_time_ms": 0.018, "training_step_time_ms": 16652.448, "sample_time_ms": 15758.636, "load_time_ms": 0.266, "load_throughput": 1923579.047, "learn_time_ms": 885.732, "learn_throughput": 578.053, "synch_weights_time_ms": 7.556}, "counters": {"num_env_steps_sampled": 26624, "num_env_steps_trained": 26624, "num_agent_steps_sampled": 106004, "num_agent_steps_trained": 106004}, "done": false, "training_iteration": 52, "trial_id": "37af9_00000", "date": "2024-09-25_18-15-30", "timestamp": 1727288130, "time_this_iter_s": 13.566832304000854, "time_total_s": 822.9627776145935, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 822.9627776145935, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 16.860000000000003, "ram_util_percent": 32.915}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6864469480235129, "cur_kl_coeff": 7.105427357601001e-16, "cur_lr": 2e-05, "total_loss": -0.17899737297702814, "policy_loss": -0.013357555244874674, "vf_loss": 0.032913230097983616, "vf_explained_var": 0.20447599403560163, "kl": 0.009896801247220565, "entropy": 1.7386812143027783, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16540.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 27136, "num_env_steps_trained": 27136, "num_agent_steps_sampled": 108052, "num_agent_steps_trained": 108052}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 0.0, "episode_reward_mean": 5.66, "episode_len_mean": 218.2, "episode_media": {}, "episodes_timesteps_total": 21820, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.415}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0, 2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0], "episode_lengths": [183, 183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223], "policy_default_policy_reward": [2.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 59.797348699622844, "mean_inference_ms": 1.1400328387684109, "mean_action_processing_ms": 0.2072585192789923, "mean_env_wait_ms": 2.0350672544818607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008940458297729492, "StateBufferConnector_ms": 0.006190299987792969, "ViewRequirementAgentConnector_ms": 0.20017242431640625}, "num_episodes": 2, "episode_return_max": 22.0, "episode_return_min": 0.0, "episode_return_mean": 5.66, "episodes_this_iter": 2}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108052, "num_agent_steps_trained": 108052, "num_env_steps_sampled": 27136, "num_env_steps_trained": 27136, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 20.809822799545316, "num_env_steps_trained_throughput_per_sec": 20.809822799545316, "timesteps_total": 27136, "num_env_steps_sampled_lifetime": 27136, "num_agent_steps_sampled_lifetime": 108052, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 108052, "timers": {"training_iteration_time_ms": 17655.383, "restore_workers_time_ms": 0.019, "training_step_time_ms": 17655.333, "sample_time_ms": 16767.303, "load_time_ms": 0.26, "load_throughput": 1969626.385, "learn_time_ms": 880.057, "learn_throughput": 581.781, "synch_weights_time_ms": 7.458}, "counters": {"num_env_steps_sampled": 27136, "num_env_steps_trained": 27136, "num_agent_steps_sampled": 108052, "num_agent_steps_trained": 108052}, "done": false, "training_iteration": 53, "trial_id": "37af9_00000", "date": "2024-09-25_18-15-55", "timestamp": 1727288155, "time_this_iter_s": 24.607895851135254, "time_total_s": 847.5706734657288, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 847.5706734657288, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 10.44857142857143, "ram_util_percent": 32.93714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7172508922871202, "cur_kl_coeff": 7.105427357601001e-16, "cur_lr": 2e-05, "total_loss": -0.16853703342494555, "policy_loss": -0.0038985149469226597, "vf_loss": 0.0318502045734931, "vf_explained_var": -0.19485786650329828, "kl": 0.0016235296897363582, "entropy": 1.7260106805711986, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16860.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 27648, "num_env_steps_trained": 27648, "num_agent_steps_sampled": 110100, "num_agent_steps_trained": 110100}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 0.0, "episode_reward_mean": 5.67, "episode_len_mean": 218.6, "episode_media": {}, "episodes_timesteps_total": 21860, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.4175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 3.0, 1.0, 0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0], "episode_lengths": [183, 203, 163, 163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223], "policy_default_policy_reward": [1.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 59.82459803038007, "mean_inference_ms": 1.1401168407936892, "mean_action_processing_ms": 0.2074648837256742, "mean_env_wait_ms": 2.0352887539849327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008946895599365234, "StateBufferConnector_ms": 0.006200551986694336, "ViewRequirementAgentConnector_ms": 0.2005155086517334}, "num_episodes": 1, "episode_return_max": 22.0, "episode_return_min": 0.0, "episode_return_mean": 5.67, "episodes_this_iter": 1}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 110100, "num_agent_steps_trained": 110100, "num_env_steps_sampled": 27648, "num_env_steps_trained": 27648, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 36.158576644803034, "num_env_steps_trained_throughput_per_sec": 36.158576644803034, "timesteps_total": 27648, "num_env_steps_sampled_lifetime": 27648, "num_agent_steps_sampled_lifetime": 110100, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 110100, "timers": {"training_iteration_time_ms": 17614.222, "restore_workers_time_ms": 0.018, "training_step_time_ms": 17614.173, "sample_time_ms": 16731.787, "load_time_ms": 0.249, "load_throughput": 2058356.799, "learn_time_ms": 874.566, "learn_throughput": 585.433, "synch_weights_time_ms": 7.322}, "counters": {"num_env_steps_sampled": 27648, "num_env_steps_trained": 27648, "num_agent_steps_sampled": 110100, "num_agent_steps_trained": 110100}, "done": false, "training_iteration": 54, "trial_id": "37af9_00000", "date": "2024-09-25_18-16-09", "timestamp": 1727288169, "time_this_iter_s": 14.162859439849854, "time_total_s": 861.7335329055786, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 861.7335329055786, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 7.270000000000001, "ram_util_percent": 33.185}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6826305315619515, "cur_kl_coeff": 3.5527136788005006e-16, "cur_lr": 2e-05, "total_loss": -0.16034355177393844, "policy_loss": -0.003196131963763506, "vf_loss": 0.05884818409629647, "vf_explained_var": 0.002540902937612226, "kl": 0.002989490927874825, "entropy": 1.7185946329947441, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17175.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 28160, "num_env_steps_trained": 28160, "num_agent_steps_sampled": 112129, "num_agent_steps_trained": 112129}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 0.0, "episode_reward_mean": 5.9, "episode_len_mean": 221.2, "episode_media": {}, "episodes_timesteps_total": 22120, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.475}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 4.0, 1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0], "episode_lengths": [163, 183, 163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383], "policy_default_policy_reward": [0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 59.90821717686296, "mean_inference_ms": 1.139873294715961, "mean_action_processing_ms": 0.20774897864638223, "mean_env_wait_ms": 2.03582700929624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008973121643066406, "StateBufferConnector_ms": 0.006204366683959961, "ViewRequirementAgentConnector_ms": 0.2006838321685791}, "num_episodes": 3, "episode_return_max": 22.0, "episode_return_min": 0.0, "episode_return_mean": 5.9, "episodes_this_iter": 3}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112129, "num_agent_steps_trained": 112129, "num_env_steps_sampled": 28160, "num_env_steps_trained": 28160, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 21.615510220515112, "num_env_steps_trained_throughput_per_sec": 21.615510220515112, "timesteps_total": 28160, "num_env_steps_sampled_lifetime": 28160, "num_agent_steps_sampled_lifetime": 112129, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 112129, "timers": {"training_iteration_time_ms": 16725.602, "restore_workers_time_ms": 0.018, "training_step_time_ms": 16725.554, "sample_time_ms": 15848.445, "load_time_ms": 0.256, "load_throughput": 2001942.433, "learn_time_ms": 869.4, "learn_throughput": 588.912, "synch_weights_time_ms": 7.207}, "counters": {"num_env_steps_sampled": 28160, "num_env_steps_trained": 28160, "num_agent_steps_sampled": 112129, "num_agent_steps_trained": 112129}, "done": false, "training_iteration": 55, "trial_id": "37af9_00000", "date": "2024-09-25_18-16-33", "timestamp": 1727288193, "time_this_iter_s": 23.690350770950317, "time_total_s": 885.4238836765289, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 885.4238836765289, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 12.48235294117647, "ram_util_percent": 33.51764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6773613831028342, "cur_kl_coeff": 1.7763568394002503e-16, "cur_lr": 2e-05, "total_loss": -0.16916891550063157, "policy_loss": -0.007855438120895997, "vf_loss": 0.04389224408951122, "vf_explained_var": -0.05685118790715933, "kl": 0.004607819829416826, "entropy": 1.7228653497993947, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17490.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 28672, "num_env_steps_trained": 28672, "num_agent_steps_sampled": 114177, "num_agent_steps_trained": 114177}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 1.0, "episode_reward_mean": 6.05, "episode_len_mean": 222.6, "episode_media": {}, "episodes_timesteps_total": 22260, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.5125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.0, 4.0, 5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0], "episode_lengths": [163, 203, 263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163], "policy_default_policy_reward": [0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 59.964159458187794, "mean_inference_ms": 1.1395051494256143, "mean_action_processing_ms": 0.2080094629366668, "mean_env_wait_ms": 2.036028670546689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008944034576416016, "StateBufferConnector_ms": 0.006211996078491211, "ViewRequirementAgentConnector_ms": 0.20108580589294434}, "num_episodes": 2, "episode_return_max": 22.0, "episode_return_min": 1.0, "episode_return_mean": 6.05, "episodes_this_iter": 2}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 114177, "num_agent_steps_trained": 114177, "num_env_steps_sampled": 28672, "num_env_steps_trained": 28672, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 25.473599008406957, "num_env_steps_trained_throughput_per_sec": 25.473599008406957, "timesteps_total": 28672, "num_env_steps_sampled_lifetime": 28672, "num_agent_steps_sampled_lifetime": 114177, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 114177, "timers": {"training_iteration_time_ms": 17643.643, "restore_workers_time_ms": 0.018, "training_step_time_ms": 17643.597, "sample_time_ms": 16768.285, "load_time_ms": 0.25, "load_throughput": 2045027.757, "learn_time_ms": 867.815, "learn_throughput": 589.987, "synch_weights_time_ms": 7.006}, "counters": {"num_env_steps_sampled": 28672, "num_env_steps_trained": 28672, "num_agent_steps_sampled": 114177, "num_agent_steps_trained": 114177}, "done": false, "training_iteration": 56, "trial_id": "37af9_00000", "date": "2024-09-25_18-16-53", "timestamp": 1727288213, "time_this_iter_s": 20.102773189544678, "time_total_s": 905.5266568660736, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 905.5266568660736, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 9.696428571428571, "ram_util_percent": 33.325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.590838976111263, "cur_kl_coeff": 8.881784197001252e-17, "cur_lr": 2e-05, "total_loss": -0.1692636925727129, "policy_loss": -0.00541987142933067, "vf_loss": 0.03753826051142824, "vf_explained_var": 0.1112403767183423, "kl": 0.005712355880783804, "entropy": 1.7322838176041842, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17810.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 29184, "num_env_steps_trained": 29184, "num_agent_steps_sampled": 116225, "num_agent_steps_trained": 116225}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 1.0, "episode_reward_mean": 6.07, "episode_len_mean": 222.4, "episode_media": {}, "episodes_timesteps_total": 22240, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.5175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0, 3.0, 4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0], "episode_lengths": [263, 163, 183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163], "policy_default_policy_reward": [4.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 59.9709941297407, "mean_inference_ms": 1.1397321927411819, "mean_action_processing_ms": 0.2082147914857325, "mean_env_wait_ms": 2.0367659125730277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008988380432128906, "StateBufferConnector_ms": 0.006232500076293945, "ViewRequirementAgentConnector_ms": 0.2017216682434082}, "num_episodes": 2, "episode_return_max": 22.0, "episode_return_min": 1.0, "episode_return_mean": 6.07, "episodes_this_iter": 2}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116225, "num_agent_steps_trained": 116225, "num_env_steps_sampled": 29184, "num_env_steps_trained": 29184, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 42.844650439057766, "num_env_steps_trained_throughput_per_sec": 42.844650439057766, "timesteps_total": 29184, "num_env_steps_sampled_lifetime": 29184, "num_agent_steps_sampled_lifetime": 116225, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 116225, "timers": {"training_iteration_time_ms": 17620.983, "restore_workers_time_ms": 0.017, "training_step_time_ms": 17620.938, "sample_time_ms": 16745.821, "load_time_ms": 0.255, "load_throughput": 2011129.095, "learn_time_ms": 867.453, "learn_throughput": 590.234, "synch_weights_time_ms": 7.173}, "counters": {"num_env_steps_sampled": 29184, "num_env_steps_trained": 29184, "num_agent_steps_sampled": 116225, "num_agent_steps_trained": 116225}, "done": false, "training_iteration": 57, "trial_id": "37af9_00000", "date": "2024-09-25_18-17-05", "timestamp": 1727288225, "time_this_iter_s": 11.954021215438843, "time_total_s": 917.4806780815125, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 917.4806780815125, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 12.805882352941175, "ram_util_percent": 32.51176470588236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6357096533140828, "cur_kl_coeff": 8.881784197001252e-17, "cur_lr": 2e-05, "total_loss": -0.17712808093957363, "policy_loss": -0.011764247988861415, "vf_loss": 0.035797152822206336, "vf_explained_var": 0.011902720697464482, "kl": 0.0015548245096411964, "entropy": 1.7431312422598562, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18125.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 29696, "num_env_steps_trained": 29696, "num_agent_steps_sampled": 118265, "num_agent_steps_trained": 118265}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 1.0, "episode_reward_mean": 6.15, "episode_len_mean": 224.0, "episode_media": {}, "episodes_timesteps_total": 22400, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.5375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.0, 13.0, 5.0, 5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0], "episode_lengths": [183, 403, 223, 163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383], "policy_default_policy_reward": [3.0, 1.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 59.99841506635069, "mean_inference_ms": 1.1397332023020939, "mean_action_processing_ms": 0.20851776342839834, "mean_env_wait_ms": 2.037206408655368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008982419967651367, "StateBufferConnector_ms": 0.0062220096588134766, "ViewRequirementAgentConnector_ms": 0.20149540901184082}, "num_episodes": 2, "episode_return_max": 22.0, "episode_return_min": 1.0, "episode_return_mean": 6.15, "episodes_this_iter": 2}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 118265, "num_agent_steps_trained": 118265, "num_env_steps_sampled": 29696, "num_env_steps_trained": 29696, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 21.704130636272122, "num_env_steps_trained_throughput_per_sec": 21.704130636272122, "timesteps_total": 29696, "num_env_steps_sampled_lifetime": 29696, "num_agent_steps_sampled_lifetime": 118265, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 118265, "timers": {"training_iteration_time_ms": 16874.138, "restore_workers_time_ms": 0.017, "training_step_time_ms": 16874.094, "sample_time_ms": 15997.471, "load_time_ms": 0.252, "load_throughput": 2034372.535, "learn_time_ms": 869.023, "learn_throughput": 589.168, "synch_weights_time_ms": 7.119}, "counters": {"num_env_steps_sampled": 29696, "num_env_steps_trained": 29696, "num_agent_steps_sampled": 118265, "num_agent_steps_trained": 118265}, "done": false, "training_iteration": 58, "trial_id": "37af9_00000", "date": "2024-09-25_18-17-28", "timestamp": 1727288248, "time_this_iter_s": 23.594131231307983, "time_total_s": 941.0748093128204, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 941.0748093128204, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 9.823529411764708, "ram_util_percent": 32.40882352941176}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6352034447249025, "cur_kl_coeff": 4.440892098500626e-17, "cur_lr": 2e-05, "total_loss": -0.17049805120914244, "policy_loss": -0.006990366306854412, "vf_loss": 0.03893473248772352, "vf_explained_var": 0.2935421548783779, "kl": 0.004250842769896934, "entropy": 1.732413635030389, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18440.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 30208, "num_env_steps_trained": 30208, "num_agent_steps_sampled": 120313, "num_agent_steps_trained": 120313}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 1.0, "episode_reward_mean": 6.09, "episode_len_mean": 222.0, "episode_media": {}, "episodes_timesteps_total": 22200, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.5225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0, 6.0, 2.0, 5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0], "episode_lengths": [163, 223, 163, 163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163], "policy_default_policy_reward": [1.0, 4.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.08247219289758, "mean_inference_ms": 1.1397818297723237, "mean_action_processing_ms": 0.2088071504535487, "mean_env_wait_ms": 2.0384456185764814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008994817733764648, "StateBufferConnector_ms": 0.006254434585571289, "ViewRequirementAgentConnector_ms": 0.20296216011047363}, "num_episodes": 3, "episode_return_max": 22.0, "episode_return_min": 1.0, "episode_return_mean": 6.09, "episodes_this_iter": 3}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120313, "num_agent_steps_trained": 120313, "num_env_steps_sampled": 30208, "num_env_steps_trained": 30208, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 28.83132025413858, "num_env_steps_trained_throughput_per_sec": 28.83132025413858, "timesteps_total": 30208, "num_env_steps_sampled_lifetime": 30208, "num_agent_steps_sampled_lifetime": 120313, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 120313, "timers": {"training_iteration_time_ms": 17076.444, "restore_workers_time_ms": 0.016, "training_step_time_ms": 17076.402, "sample_time_ms": 16201.402, "load_time_ms": 0.256, "load_throughput": 2003249.672, "learn_time_ms": 867.244, "learn_throughput": 590.376, "synch_weights_time_ms": 7.275}, "counters": {"num_env_steps_sampled": 30208, "num_env_steps_trained": 30208, "num_agent_steps_sampled": 120313, "num_agent_steps_trained": 120313}, "done": false, "training_iteration": 59, "trial_id": "37af9_00000", "date": "2024-09-25_18-17-46", "timestamp": 1727288266, "time_this_iter_s": 17.761597394943237, "time_total_s": 958.8364067077637, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 958.8364067077637, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 12.744000000000002, "ram_util_percent": 32.536}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.695803368173074, "cur_kl_coeff": 2.220446049250313e-17, "cur_lr": 2e-05, "total_loss": -0.1685759172825783, "policy_loss": -0.008220358902326553, "vf_loss": 0.03752909562826971, "vf_explained_var": -0.07815415486693382, "kl": 0.004543904704285851, "entropy": 1.6973782930523158, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18760.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_agent_steps_sampled": 122361, "num_agent_steps_trained": 122361}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 1.0, "episode_reward_mean": 6.13, "episode_len_mean": 222.8, "episode_media": {}, "episodes_timesteps_total": 22280, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.5325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0, 14.0, 4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0], "episode_lengths": [163, 443, 163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223], "policy_default_policy_reward": [3.0, 2.0, 0.0, 0.0, 8.0, 5.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.12771413296391, "mean_inference_ms": 1.1402300421954819, "mean_action_processing_ms": 0.20914790145724244, "mean_env_wait_ms": 2.0397878503608764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008975505828857422, "StateBufferConnector_ms": 0.006261587142944336, "ViewRequirementAgentConnector_ms": 0.20311355590820312}, "num_episodes": 3, "episode_return_max": 22.0, "episode_return_min": 1.0, "episode_return_mean": 6.13, "episodes_this_iter": 3}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 122361, "num_agent_steps_trained": 122361, "num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 34.040794640411626, "num_env_steps_trained_throughput_per_sec": 34.040794640411626, "timesteps_total": 30720, "num_env_steps_sampled_lifetime": 30720, "num_agent_steps_sampled_lifetime": 122361, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 122361, "timers": {"training_iteration_time_ms": 16653.969, "restore_workers_time_ms": 0.015, "training_step_time_ms": 16653.928, "sample_time_ms": 15782.462, "load_time_ms": 0.255, "load_throughput": 2007556.93, "learn_time_ms": 863.958, "learn_throughput": 592.621, "synch_weights_time_ms": 7.026}, "counters": {"num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_agent_steps_sampled": 122361, "num_agent_steps_trained": 122361}, "done": false, "training_iteration": 60, "trial_id": "37af9_00000", "date": "2024-09-25_18-18-01", "timestamp": 1727288281, "time_this_iter_s": 15.044495820999146, "time_total_s": 973.8809025287628, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 973.8809025287628, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 15.780952380952382, "ram_util_percent": 32.95238095238095}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6836605797852239, "cur_kl_coeff": 1.1102230246251564e-17, "cur_lr": 2e-05, "total_loss": -0.1682692354079336, "policy_loss": -0.006652496995464448, "vf_loss": 0.02777477364889496, "vf_explained_var": 0.21138139559376623, "kl": 0.004858541806421609, "entropy": 1.6856042981147765, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19075.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 31232, "num_env_steps_trained": 31232, "num_agent_steps_sampled": 124396, "num_agent_steps_trained": 124396}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 1.0, "episode_reward_mean": 6.05, "episode_len_mean": 220.8, "episode_media": {}, "episodes_timesteps_total": 22080, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.5125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.0, 6.0, 8.0, 6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0], "episode_lengths": [163, 183, 323, 203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223], "policy_default_policy_reward": [2.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.150368891927116, "mean_inference_ms": 1.1405499062131774, "mean_action_processing_ms": 0.2094943924576112, "mean_env_wait_ms": 2.0404875077288316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008963823318481445, "StateBufferConnector_ms": 0.006259441375732422, "ViewRequirementAgentConnector_ms": 0.20287466049194336}, "num_episodes": 2, "episode_return_max": 22.0, "episode_return_min": 1.0, "episode_return_mean": 6.05, "episodes_this_iter": 2}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124396, "num_agent_steps_trained": 124396, "num_env_steps_sampled": 31232, "num_env_steps_trained": 31232, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 36.563506305375725, "num_env_steps_trained_throughput_per_sec": 36.563506305375725, "timesteps_total": 31232, "num_env_steps_sampled_lifetime": 31232, "num_agent_steps_sampled_lifetime": 124396, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 124396, "timers": {"training_iteration_time_ms": 17845.42, "restore_workers_time_ms": 0.015, "training_step_time_ms": 17845.38, "sample_time_ms": 16978.054, "load_time_ms": 0.269, "load_throughput": 1903291.366, "learn_time_ms": 859.799, "learn_throughput": 595.488, "synch_weights_time_ms": 7.033}, "counters": {"num_env_steps_sampled": 31232, "num_env_steps_trained": 31232, "num_agent_steps_sampled": 124396, "num_agent_steps_trained": 124396}, "done": false, "training_iteration": 61, "trial_id": "37af9_00000", "date": "2024-09-25_18-18-15", "timestamp": 1727288295, "time_this_iter_s": 14.007425308227539, "time_total_s": 987.8883278369904, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 987.8883278369904, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 10.975000000000001, "ram_util_percent": 32.58}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7300953263957655, "cur_kl_coeff": 5.551115123125782e-18, "cur_lr": 2e-05, "total_loss": -0.15844486364343716, "policy_loss": -0.001695539168412647, "vf_loss": 0.0512137416449766, "vf_explained_var": 0.005348804112403623, "kl": 0.002198180596293707, "entropy": 1.6955275604801794, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19385.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 31744, "num_env_steps_trained": 31744, "num_agent_steps_sampled": 126430, "num_agent_steps_trained": 126430}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 1.0, "episode_reward_mean": 5.99, "episode_len_mean": 219.4, "episode_media": {}, "episodes_timesteps_total": 21940, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.4975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0], "episode_lengths": [203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163], "policy_default_policy_reward": [5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.18293459049134, "mean_inference_ms": 1.1409937614166956, "mean_action_processing_ms": 0.2097844760608726, "mean_env_wait_ms": 2.0419832209215256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008960723876953125, "StateBufferConnector_ms": 0.006257534027099609, "ViewRequirementAgentConnector_ms": 0.20271849632263184}, "num_episodes": 3, "episode_return_max": 22.0, "episode_return_min": 1.0, "episode_return_mean": 5.99, "episodes_this_iter": 3}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126430, "num_agent_steps_trained": 126430, "num_env_steps_sampled": 31744, "num_env_steps_trained": 31744, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 38.728909635198484, "num_env_steps_trained_throughput_per_sec": 38.728909635198484, "timesteps_total": 31744, "num_env_steps_sampled_lifetime": 31744, "num_agent_steps_sampled_lifetime": 126430, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 126430, "timers": {"training_iteration_time_ms": 17811.214, "restore_workers_time_ms": 0.015, "training_step_time_ms": 17811.174, "sample_time_ms": 16943.148, "load_time_ms": 0.268, "load_throughput": 1909553.306, "learn_time_ms": 860.17, "learn_throughput": 595.231, "synch_weights_time_ms": 7.364}, "counters": {"num_env_steps_sampled": 31744, "num_env_steps_trained": 31744, "num_agent_steps_sampled": 126430, "num_agent_steps_trained": 126430}, "done": false, "training_iteration": 62, "trial_id": "37af9_00000", "date": "2024-09-25_18-18-28", "timestamp": 1727288308, "time_this_iter_s": 13.224200963973999, "time_total_s": 1001.1125288009644, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1001.1125288009644, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 15.521052631578947, "ram_util_percent": 32.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7259523613844067, "cur_kl_coeff": 2.775557561562891e-18, "cur_lr": 2e-05, "total_loss": -0.16003614884102718, "policy_loss": -0.006861686176853255, "vf_loss": 0.056116396767902185, "vf_explained_var": -0.08546568043529987, "kl": 0.00789204574744815, "entropy": 1.6720355693250895, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19700.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_agent_steps_sampled": 128478, "num_agent_steps_trained": 128478}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 1.0, "episode_reward_mean": 5.99, "episode_len_mean": 219.4, "episode_media": {}, "episodes_timesteps_total": 21940, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.4975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.0, 5.0, 2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0], "episode_lengths": [203, 203, 163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163], "policy_default_policy_reward": [5.0, 1.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.18293459049134, "mean_inference_ms": 1.1409937614166956, "mean_action_processing_ms": 0.2097844760608726, "mean_env_wait_ms": 2.0419832209215256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008960723876953125, "StateBufferConnector_ms": 0.006257534027099609, "ViewRequirementAgentConnector_ms": 0.20271849632263184}, "num_episodes": 0, "episode_return_max": 22.0, "episode_return_min": 1.0, "episode_return_mean": 5.99, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128478, "num_agent_steps_trained": 128478, "num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 249.2042112641161, "num_env_steps_trained_throughput_per_sec": 249.2042112641161, "timesteps_total": 32256, "num_env_steps_sampled_lifetime": 32256, "num_agent_steps_sampled_lifetime": 128478, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 128478, "timers": {"training_iteration_time_ms": 15556.291, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15556.252, "sample_time_ms": 14687.639, "load_time_ms": 0.275, "load_throughput": 1861226.944, "learn_time_ms": 860.805, "learn_throughput": 594.792, "synch_weights_time_ms": 7.309}, "counters": {"num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_agent_steps_sampled": 128478, "num_agent_steps_trained": 128478}, "done": false, "training_iteration": 63, "trial_id": "37af9_00000", "date": "2024-09-25_18-18-30", "timestamp": 1727288310, "time_this_iter_s": 2.0589139461517334, "time_total_s": 1003.1714427471161, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1003.1714427471161, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 14.333333333333334, "ram_util_percent": 32.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6678318060003221, "cur_kl_coeff": 2.775557561562891e-18, "cur_lr": 2e-05, "total_loss": -0.16119442155832076, "policy_loss": -0.004870144138112664, "vf_loss": 0.05856329065700265, "vf_explained_var": 0.1802238890901208, "kl": 0.0021703786595574483, "entropy": 1.709650968387723, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20020.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_agent_steps_sampled": 130526, "num_agent_steps_trained": 130526}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 1.0, "episode_reward_mean": 6.03, "episode_len_mean": 220.6, "episode_media": {}, "episodes_timesteps_total": 22060, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.5075}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 6.0, 2.0, 7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0], "episode_lengths": [163, 223, 183, 243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243], "policy_default_policy_reward": [1.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.208551425425995, "mean_inference_ms": 1.1412948006365815, "mean_action_processing_ms": 0.20995750496511736, "mean_env_wait_ms": 2.0428243835104625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008961677551269531, "StateBufferConnector_ms": 0.006261348724365234, "ViewRequirementAgentConnector_ms": 0.20280742645263672}, "num_episodes": 2, "episode_return_max": 22.0, "episode_return_min": 1.0, "episode_return_mean": 6.03, "episodes_this_iter": 2}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 130526, "num_agent_steps_trained": 130526, "num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 28.681490656066813, "num_env_steps_trained_throughput_per_sec": 28.681490656066813, "timesteps_total": 32768, "num_env_steps_sampled_lifetime": 32768, "num_agent_steps_sampled_lifetime": 130526, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 130526, "timers": {"training_iteration_time_ms": 15925.429, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15925.391, "sample_time_ms": 15056.735, "load_time_ms": 0.271, "load_throughput": 1892556.313, "learn_time_ms": 860.466, "learn_throughput": 595.026, "synch_weights_time_ms": 7.688}, "counters": {"num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_agent_steps_sampled": 130526, "num_agent_steps_trained": 130526}, "done": false, "training_iteration": 64, "trial_id": "37af9_00000", "date": "2024-09-25_18-18-48", "timestamp": 1727288328, "time_this_iter_s": 17.854530096054077, "time_total_s": 1021.0259728431702, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1021.0259728431702, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 11.346153846153847, "ram_util_percent": 33.973076923076924}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6646777678160898, "cur_kl_coeff": 1.3877787807814456e-18, "cur_lr": 2e-05, "total_loss": -0.16932715723110783, "policy_loss": -0.005517040582133397, "vf_loss": 0.03360856115637768, "vf_explained_var": 0.2660271971456466, "kl": 0.0019558007188540537, "entropy": 1.7221225384742982, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20335.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 33280, "num_env_steps_trained": 33280, "num_agent_steps_sampled": 132560, "num_agent_steps_trained": 132560}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 1.0, "episode_reward_mean": 6.27, "episode_len_mean": 225.0, "episode_media": {}, "episodes_timesteps_total": 22500, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.5675}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.0, 4.0, 5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0, 17.0, 14.0, 3.0], "episode_lengths": [243, 223, 203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243, 463, 383, 163], "policy_default_policy_reward": [2.0, 5.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 13.0, 4.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.24835903326397, "mean_inference_ms": 1.1417952029153342, "mean_action_processing_ms": 0.21042032625335902, "mean_env_wait_ms": 2.0441807810404136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008933782577514648, "StateBufferConnector_ms": 0.006281614303588867, "ViewRequirementAgentConnector_ms": 0.2037959098815918}, "num_episodes": 3, "episode_return_max": 22.0, "episode_return_min": 1.0, "episode_return_mean": 6.27, "episodes_this_iter": 3}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132560, "num_agent_steps_trained": 132560, "num_env_steps_sampled": 33280, "num_env_steps_trained": 33280, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 18.587781029373097, "num_env_steps_trained_throughput_per_sec": 18.587781029373097, "timesteps_total": 33280, "num_env_steps_sampled_lifetime": 33280, "num_agent_steps_sampled_lifetime": 132560, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 132560, "timers": {"training_iteration_time_ms": 16311.257, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16311.22, "sample_time_ms": 15443.064, "load_time_ms": 0.261, "load_throughput": 1959919.365, "learn_time_ms": 860.303, "learn_throughput": 595.139, "synch_weights_time_ms": 7.368}, "counters": {"num_env_steps_sampled": 33280, "num_env_steps_trained": 33280, "num_agent_steps_sampled": 132560, "num_agent_steps_trained": 132560}, "done": false, "training_iteration": 65, "trial_id": "37af9_00000", "date": "2024-09-25_18-19-16", "timestamp": 1727288356, "time_this_iter_s": 27.54859948158264, "time_total_s": 1048.5745723247528, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1048.5745723247528, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 13.046153846153844, "ram_util_percent": 34.10769230769232}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6749885842204094, "cur_kl_coeff": 6.938893903907228e-19, "cur_lr": 2e-05, "total_loss": -0.16812220580815787, "policy_loss": -0.005201673605329087, "vf_loss": 0.04216318142622889, "vf_explained_var": 0.4803366864881208, "kl": 0.0049476561029708375, "entropy": 1.7346132463024508, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20645.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 33792, "num_env_steps_trained": 33792, "num_agent_steps_sampled": 134563, "num_agent_steps_trained": 134563}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 1.0, "episode_reward_mean": 6.27, "episode_len_mean": 224.2, "episode_media": {}, "episodes_timesteps_total": 22420, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.5675}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0, 2.0, 5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0, 17.0, 14.0, 3.0, 5.0, 6.0], "episode_lengths": [203, 183, 203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243, 463, 383, 163, 183, 203], "policy_default_policy_reward": [3.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 13.0, 4.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 4.0, 2.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.278059579071844, "mean_inference_ms": 1.1419772439236242, "mean_action_processing_ms": 0.21057539642067372, "mean_env_wait_ms": 2.0451016276475387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00893545150756836, "StateBufferConnector_ms": 0.0062713623046875, "ViewRequirementAgentConnector_ms": 0.20358753204345703}, "num_episodes": 2, "episode_return_max": 22.0, "episode_return_min": 1.0, "episode_return_mean": 6.27, "episodes_this_iter": 2}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 134563, "num_agent_steps_trained": 134563, "num_env_steps_sampled": 33792, "num_env_steps_trained": 33792, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 38.95763430680933, "num_env_steps_trained_throughput_per_sec": 38.95763430680933, "timesteps_total": 33792, "num_env_steps_sampled_lifetime": 33792, "num_agent_steps_sampled_lifetime": 134563, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 134563, "timers": {"training_iteration_time_ms": 15615.581, "restore_workers_time_ms": 0.013, "training_step_time_ms": 15615.545, "sample_time_ms": 14750.684, "load_time_ms": 0.262, "load_throughput": 1950484.694, "learn_time_ms": 856.69, "learn_throughput": 597.649, "synch_weights_time_ms": 7.681}, "counters": {"num_env_steps_sampled": 33792, "num_env_steps_trained": 33792, "num_agent_steps_sampled": 134563, "num_agent_steps_trained": 134563}, "done": false, "training_iteration": 66, "trial_id": "37af9_00000", "date": "2024-09-25_18-19-29", "timestamp": 1727288369, "time_this_iter_s": 13.14600133895874, "time_total_s": 1061.7205736637115, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1061.7205736637115, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 12.926315789473685, "ram_util_percent": 32.48947368421052}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5794625709614446, "cur_kl_coeff": 3.469446951953614e-19, "cur_lr": 2e-05, "total_loss": -0.1618656807293695, "policy_loss": -0.001651820250516457, "vf_loss": 0.04611661880344693, "vf_explained_var": 0.2368328163700719, "kl": 0.0038623218149585947, "entropy": 1.7174301451252352, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20955.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 34304, "num_env_steps_trained": 34304, "num_agent_steps_sampled": 136610, "num_agent_steps_trained": 136610}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 1.0, "episode_reward_mean": 6.36, "episode_len_mean": 225.2, "episode_media": {}, "episodes_timesteps_total": 22520, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.59}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0, 7.0, 7.0, 7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0, 17.0, 14.0, 3.0, 5.0, 6.0, 9.0, 7.0], "episode_lengths": [203, 223, 283, 223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243, 463, 383, 163, 183, 203, 263, 223], "policy_default_policy_reward": [3.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 13.0, 4.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.320196296324966, "mean_inference_ms": 1.1423731229875598, "mean_action_processing_ms": 0.21086888029011622, "mean_env_wait_ms": 2.0459582012149493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008862733840942383, "StateBufferConnector_ms": 0.006280422210693359, "ViewRequirementAgentConnector_ms": 0.2038109302520752}, "num_episodes": 2, "episode_return_max": 22.0, "episode_return_min": 1.0, "episode_return_mean": 6.36, "episodes_this_iter": 2}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136610, "num_agent_steps_trained": 136610, "num_env_steps_sampled": 34304, "num_env_steps_trained": 34304, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 30.83416134635135, "num_env_steps_trained_throughput_per_sec": 30.83416134635135, "timesteps_total": 34304, "num_env_steps_sampled_lifetime": 34304, "num_agent_steps_sampled_lifetime": 136610, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 136610, "timers": {"training_iteration_time_ms": 16081.063, "restore_workers_time_ms": 0.014, "training_step_time_ms": 16081.024, "sample_time_ms": 15219.382, "load_time_ms": 0.264, "load_throughput": 1935890.785, "learn_time_ms": 853.558, "learn_throughput": 599.842, "synch_weights_time_ms": 7.594}, "counters": {"num_env_steps_sampled": 34304, "num_env_steps_trained": 34304, "num_agent_steps_sampled": 136610, "num_agent_steps_trained": 136610}, "done": false, "training_iteration": 67, "trial_id": "37af9_00000", "date": "2024-09-25_18-19-46", "timestamp": 1727288386, "time_this_iter_s": 16.608469009399414, "time_total_s": 1078.329042673111, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1078.329042673111, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 11.130434782608695, "ram_util_percent": 32.547826086956526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7091090828180313, "cur_kl_coeff": 1.7347234759768067e-19, "cur_lr": 1.9999999999999998e-05, "total_loss": -0.1738452147113893, "policy_loss": -0.013305330886082215, "vf_loss": 0.04437676113818518, "vf_explained_var": 0.23850224722515453, "kl": 0.0029229202855379876, "entropy": 1.7163407296845408, "entropy_coeff": 0.09999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21275.5, "diff_num_grad_updates_vs_sampler_policy": 164.5}}, "num_env_steps_sampled": 34816, "num_env_steps_trained": 34816, "num_agent_steps_sampled": 138760, "num_agent_steps_trained": 138760}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 1.0, "episode_reward_mean": 6.33, "episode_len_mean": 224.2, "episode_media": {}, "episodes_timesteps_total": 22420, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.5825}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.0, 15.0, 7.0, 2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0, 17.0, 14.0, 3.0, 5.0, 6.0, 9.0, 7.0, 6.0, 3.0, 7.0], "episode_lengths": [223, 423, 283, 163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243, 463, 383, 163, 183, 203, 263, 223, 183, 183, 243], "policy_default_policy_reward": [4.0, 3.0, 0.0, 0.0, 10.0, 4.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 13.0, 4.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.33754950143313, "mean_inference_ms": 1.1425629715566745, "mean_action_processing_ms": 0.21114650844655947, "mean_env_wait_ms": 2.047204783750308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008779764175415039, "StateBufferConnector_ms": 0.006269931793212891, "ViewRequirementAgentConnector_ms": 0.20326948165893555}, "num_episodes": 3, "episode_return_max": 22.0, "episode_return_min": 1.0, "episode_return_mean": 6.33, "episodes_this_iter": 3}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 138760, "num_agent_steps_trained": 138760, "num_env_steps_sampled": 34816, "num_env_steps_trained": 34816, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 33.175155992393336, "num_env_steps_trained_throughput_per_sec": 33.175155992393336, "timesteps_total": 34816, "num_env_steps_sampled_lifetime": 34816, "num_agent_steps_sampled_lifetime": 138760, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 138760, "timers": {"training_iteration_time_ms": 15265.388, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15265.35, "sample_time_ms": 14406.692, "load_time_ms": 0.262, "load_throughput": 1952435.356, "learn_time_ms": 850.953, "learn_throughput": 601.678, "synch_weights_time_ms": 7.218}, "counters": {"num_env_steps_sampled": 34816, "num_env_steps_trained": 34816, "num_agent_steps_sampled": 138760, "num_agent_steps_trained": 138760}, "done": false, "training_iteration": 68, "trial_id": "37af9_00000", "date": "2024-09-25_18-20-01", "timestamp": 1727288401, "time_this_iter_s": 15.436243772506714, "time_total_s": 1093.7652864456177, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1093.7652864456177, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 15.013636363636358, "ram_util_percent": 32.3681818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6487424818979156, "cur_kl_coeff": 8.673617379884035e-20, "cur_lr": 2e-05, "total_loss": -0.16266007431512397, "policy_loss": -0.003237230105385665, "vf_loss": 0.04855287162654642, "vf_explained_var": 0.3461211275669836, "kl": 0.0018946500457382289, "entropy": 1.7156105929805388, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21595.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 35328, "num_env_steps_trained": 35328, "num_agent_steps_sampled": 140795, "num_agent_steps_trained": 140795}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 1.0, "episode_reward_mean": 6.24, "episode_len_mean": 221.6, "episode_media": {}, "episodes_timesteps_total": 22160, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.56}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 6.0, 5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0, 17.0, 14.0, 3.0, 5.0, 6.0, 9.0, 7.0, 6.0, 3.0, 7.0, 4.0, 4.0, 12.0], "episode_lengths": [163, 223, 223, 163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243, 463, 383, 163, 183, 203, 263, 223, 183, 183, 243, 163, 183, 323], "policy_default_policy_reward": [0.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 13.0, 4.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.335632668687296, "mean_inference_ms": 1.1431329631186942, "mean_action_processing_ms": 0.21146938036004514, "mean_env_wait_ms": 2.0483007933833686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008768558502197266, "StateBufferConnector_ms": 0.006262779235839844, "ViewRequirementAgentConnector_ms": 0.20293235778808594}, "num_episodes": 3, "episode_return_max": 22.0, "episode_return_min": 1.0, "episode_return_mean": 6.24, "episodes_this_iter": 3}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140795, "num_agent_steps_trained": 140795, "num_env_steps_sampled": 35328, "num_env_steps_trained": 35328, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 24.77934758175323, "num_env_steps_trained_throughput_per_sec": 24.77934758175323, "timesteps_total": 35328, "num_env_steps_sampled_lifetime": 35328, "num_agent_steps_sampled_lifetime": 140795, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 140795, "timers": {"training_iteration_time_ms": 15555.778, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15555.74, "sample_time_ms": 14699.466, "load_time_ms": 0.265, "load_throughput": 1929281.869, "learn_time_ms": 848.662, "learn_throughput": 603.303, "synch_weights_time_ms": 7.122}, "counters": {"num_env_steps_sampled": 35328, "num_env_steps_trained": 35328, "num_agent_steps_sampled": 140795, "num_agent_steps_trained": 140795}, "done": false, "training_iteration": 69, "trial_id": "37af9_00000", "date": "2024-09-25_18-20-22", "timestamp": 1727288422, "time_this_iter_s": 20.66567873954773, "time_total_s": 1114.4309651851654, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1114.4309651851654, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 11.42, "ram_util_percent": 32.92666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6314047960264068, "cur_kl_coeff": 4.3368086899420174e-20, "cur_lr": 2e-05, "total_loss": -0.16170866531845662, "policy_loss": -0.003513384661487033, "vf_loss": 0.04932495848756404, "vf_explained_var": 0.0907646979055097, "kl": 0.004840771379187, "entropy": 1.7052651770653264, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21905.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 35840, "num_env_steps_trained": 35840, "num_agent_steps_sampled": 142833, "num_agent_steps_trained": 142833}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 1.0, "episode_reward_mean": 6.25, "episode_len_mean": 220.8, "episode_media": {}, "episodes_timesteps_total": 22080, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.5625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0, 5.0, 2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0, 17.0, 14.0, 3.0, 5.0, 6.0, 9.0, 7.0, 6.0, 3.0, 7.0, 4.0, 4.0, 12.0, 6.0, 4.0, 4.0], "episode_lengths": [163, 163, 203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243, 463, 383, 163, 183, 203, 263, 223, 183, 183, 243, 163, 183, 323, 183, 183, 163], "policy_default_policy_reward": [3.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 13.0, 4.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.379668856620185, "mean_inference_ms": 1.1435723045610409, "mean_action_processing_ms": 0.2118469429497611, "mean_env_wait_ms": 2.0494821004779338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008754730224609375, "StateBufferConnector_ms": 0.00626063346862793, "ViewRequirementAgentConnector_ms": 0.20270705223083496}, "num_episodes": 3, "episode_return_max": 22.0, "episode_return_min": 1.0, "episode_return_mean": 6.25, "episodes_this_iter": 3}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 142833, "num_agent_steps_trained": 142833, "num_env_steps_sampled": 35840, "num_env_steps_trained": 35840, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 40.66737128276565, "num_env_steps_trained_throughput_per_sec": 40.66737128276565, "timesteps_total": 35840, "num_env_steps_sampled_lifetime": 35840, "num_agent_steps_sampled_lifetime": 142833, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 142833, "timers": {"training_iteration_time_ms": 15310.696, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15310.655, "sample_time_ms": 14457.241, "load_time_ms": 0.265, "load_throughput": 1932928.576, "learn_time_ms": 845.648, "learn_throughput": 605.453, "synch_weights_time_ms": 7.28}, "counters": {"num_env_steps_sampled": 35840, "num_env_steps_trained": 35840, "num_agent_steps_sampled": 142833, "num_agent_steps_trained": 142833}, "done": false, "training_iteration": 70, "trial_id": "37af9_00000", "date": "2024-09-25_18-20-34", "timestamp": 1727288434, "time_this_iter_s": 12.593399047851562, "time_total_s": 1127.024364233017, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1127.024364233017, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 17.388235294117646, "ram_util_percent": 32.323529411764696}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6617956493410372, "cur_kl_coeff": 2.1684043449710087e-20, "cur_lr": 2e-05, "total_loss": -0.1609253861671013, "policy_loss": 0.00025153478547450036, "vf_loss": 0.04383815189921147, "vf_explained_var": 0.058571658403642715, "kl": 0.0019314891094282874, "entropy": 1.7213645527439734, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22215.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 36352, "num_env_steps_trained": 36352, "num_agent_steps_sampled": 144861, "num_agent_steps_trained": 144861}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 1.0, "episode_reward_mean": 6.27, "episode_len_mean": 221.6, "episode_media": {}, "episodes_timesteps_total": 22160, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.5675}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 6.0, 17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0, 17.0, 14.0, 3.0, 5.0, 6.0, 9.0, 7.0, 6.0, 3.0, 7.0, 4.0, 4.0, 12.0, 6.0, 4.0, 4.0, 6.0, 6.0], "episode_lengths": [203, 203, 423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243, 463, 383, 163, 183, 203, 263, 223, 183, 183, 243, 163, 183, 323, 183, 183, 163, 183, 223], "policy_default_policy_reward": [1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 13.0, 4.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.413011637600704, "mean_inference_ms": 1.1435925472630946, "mean_action_processing_ms": 0.21196069434024298, "mean_env_wait_ms": 2.0502609082483247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008757591247558594, "StateBufferConnector_ms": 0.006258487701416016, "ViewRequirementAgentConnector_ms": 0.2027425765991211}, "num_episodes": 2, "episode_return_max": 22.0, "episode_return_min": 1.0, "episode_return_mean": 6.27, "episodes_this_iter": 2}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144861, "num_agent_steps_trained": 144861, "num_env_steps_sampled": 36352, "num_env_steps_trained": 36352, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 35.30162758920711, "num_env_steps_trained_throughput_per_sec": 35.30162758920711, "timesteps_total": 36352, "num_env_steps_sampled_lifetime": 36352, "num_agent_steps_sampled_lifetime": 144861, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 144861, "timers": {"training_iteration_time_ms": 15360.752, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15360.71, "sample_time_ms": 14508.786, "load_time_ms": 0.251, "load_throughput": 2041140.241, "learn_time_ms": 844.276, "learn_throughput": 606.437, "synch_weights_time_ms": 7.178}, "counters": {"num_env_steps_sampled": 36352, "num_env_steps_trained": 36352, "num_agent_steps_sampled": 144861, "num_agent_steps_trained": 144861}, "done": false, "training_iteration": 71, "trial_id": "37af9_00000", "date": "2024-09-25_18-20-49", "timestamp": 1727288449, "time_this_iter_s": 14.507814168930054, "time_total_s": 1141.532178401947, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1141.532178401947, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 11.552380952380954, "ram_util_percent": 32.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6965044332668185, "cur_kl_coeff": 1.0842021724855043e-20, "cur_lr": 2e-05, "total_loss": -0.1662152259174036, "policy_loss": -0.0037933010375127197, "vf_loss": 0.04094357720423432, "vf_explained_var": 0.03839897606521845, "kl": 0.0018270916493671407, "entropy": 1.7265781868249177, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22530.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 36864, "num_env_steps_trained": 36864, "num_agent_steps_sampled": 146909, "num_agent_steps_trained": 146909}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 1.0, "episode_reward_mean": 6.34, "episode_len_mean": 222.0, "episode_media": {}, "episodes_timesteps_total": 22200, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.585}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.0, 10.0, 3.0, 9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0, 17.0, 14.0, 3.0, 5.0, 6.0, 9.0, 7.0, 6.0, 3.0, 7.0, 4.0, 4.0, 12.0, 6.0, 4.0, 4.0, 6.0, 6.0, 7.0, 8.0], "episode_lengths": [423, 243, 183, 263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243, 463, 383, 163, 183, 203, 263, 223, 183, 183, 243, 163, 183, 323, 183, 183, 163, 183, 223, 203, 243], "policy_default_policy_reward": [10.0, 6.0, 1.0, 0.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 13.0, 4.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.40870377599987, "mean_inference_ms": 1.1440007313844658, "mean_action_processing_ms": 0.21223897726324853, "mean_env_wait_ms": 2.0508571992274205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008729934692382812, "StateBufferConnector_ms": 0.006275177001953125, "ViewRequirementAgentConnector_ms": 0.20351266860961914}, "num_episodes": 2, "episode_return_max": 22.0, "episode_return_min": 1.0, "episode_return_mean": 6.34, "episodes_this_iter": 2}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 146909, "num_agent_steps_trained": 146909, "num_env_steps_sampled": 36864, "num_env_steps_trained": 36864, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 31.64304196110023, "num_env_steps_trained_throughput_per_sec": 31.64304196110023, "timesteps_total": 36864, "num_env_steps_sampled_lifetime": 36864, "num_agent_steps_sampled_lifetime": 146909, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 146909, "timers": {"training_iteration_time_ms": 15656.792, "restore_workers_time_ms": 0.016, "training_step_time_ms": 15656.748, "sample_time_ms": 14803.042, "load_time_ms": 0.254, "load_throughput": 2018311.699, "learn_time_ms": 846.41, "learn_throughput": 604.908, "synch_weights_time_ms": 6.822}, "counters": {"num_env_steps_sampled": 36864, "num_env_steps_trained": 36864, "num_agent_steps_sampled": 146909, "num_agent_steps_trained": 146909}, "done": false, "training_iteration": 72, "trial_id": "37af9_00000", "date": "2024-09-25_18-21-05", "timestamp": 1727288465, "time_this_iter_s": 16.18357229232788, "time_total_s": 1157.715750694275, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1157.715750694275, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 11.53913043478261, "ram_util_percent": 32.70434782608695}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5967785554705187, "cur_kl_coeff": 5.421010862427522e-21, "cur_lr": 2e-05, "total_loss": -0.16470896640857974, "policy_loss": -0.004013798965752357, "vf_loss": 0.04910956034527771, "vf_explained_var": 0.12230294365435838, "kl": 0.0028115837552565638, "entropy": 1.7297255508601665, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22850.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 37376, "num_env_steps_trained": 37376, "num_agent_steps_sampled": 148957, "num_agent_steps_trained": 148957}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 1.0, "episode_reward_mean": 6.22, "episode_len_mean": 219.6, "episode_media": {}, "episodes_timesteps_total": 21960, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0, 17.0, 14.0, 3.0, 5.0, 6.0, 9.0, 7.0, 6.0, 3.0, 7.0, 4.0, 4.0, 12.0, 6.0, 4.0, 4.0, 6.0, 6.0, 7.0, 8.0, 7.0, 3.0, 8.0], "episode_lengths": [263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243, 463, 383, 163, 183, 203, 263, 223, 183, 183, 243, 163, 183, 323, 183, 183, 163, 183, 223, 203, 243, 203, 183, 223], "policy_default_policy_reward": [5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 13.0, 4.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.45256401744896, "mean_inference_ms": 1.1443767141067551, "mean_action_processing_ms": 0.21248650207375117, "mean_env_wait_ms": 2.0522609612688005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008789539337158203, "StateBufferConnector_ms": 0.006283760070800781, "ViewRequirementAgentConnector_ms": 0.2040090560913086}, "num_episodes": 3, "episode_return_max": 22.0, "episode_return_min": 1.0, "episode_return_mean": 6.22, "episodes_this_iter": 3}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148957, "num_agent_steps_trained": 148957, "num_env_steps_sampled": 37376, "num_env_steps_trained": 37376, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 36.065834698079385, "num_env_steps_trained_throughput_per_sec": 36.065834698079385, "timesteps_total": 37376, "num_env_steps_sampled_lifetime": 37376, "num_agent_steps_sampled_lifetime": 148957, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 148957, "timers": {"training_iteration_time_ms": 16870.964, "restore_workers_time_ms": 0.016, "training_step_time_ms": 16870.921, "sample_time_ms": 16014.096, "load_time_ms": 0.25, "load_throughput": 2048539.204, "learn_time_ms": 849.174, "learn_throughput": 602.939, "synch_weights_time_ms": 7.176}, "counters": {"num_env_steps_sampled": 37376, "num_env_steps_trained": 37376, "num_agent_steps_sampled": 148957, "num_agent_steps_trained": 148957}, "done": false, "training_iteration": 73, "trial_id": "37af9_00000", "date": "2024-09-25_18-21-19", "timestamp": 1727288479, "time_this_iter_s": 14.201329708099365, "time_total_s": 1171.9170804023743, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1171.9170804023743, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 15.215, "ram_util_percent": 32.455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6293129113037139, "cur_kl_coeff": 2.710505431213761e-21, "cur_lr": 2e-05, "total_loss": -0.1652922688415856, "policy_loss": -0.004394946654792875, "vf_loss": 0.04356430060179264, "vf_explained_var": -0.32424993459135293, "kl": 0.003514942569015034, "entropy": 1.7178839776664971, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23170.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 37888, "num_env_steps_trained": 37888, "num_agent_steps_sampled": 151005, "num_agent_steps_trained": 151005}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 1.0, "episode_reward_mean": 6.22, "episode_len_mean": 219.6, "episode_media": {}, "episodes_timesteps_total": 21960, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.0, 5.0, 7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0, 17.0, 14.0, 3.0, 5.0, 6.0, 9.0, 7.0, 6.0, 3.0, 7.0, 4.0, 4.0, 12.0, 6.0, 4.0, 4.0, 6.0, 6.0, 7.0, 8.0, 7.0, 3.0, 8.0], "episode_lengths": [263, 163, 183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243, 463, 383, 163, 183, 203, 263, 223, 183, 183, 243, 163, 183, 323, 183, 183, 163, 183, 223, 203, 243, 203, 183, 223], "policy_default_policy_reward": [5.0, 3.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 13.0, 4.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.45256401744896, "mean_inference_ms": 1.1443767141067551, "mean_action_processing_ms": 0.21248650207375117, "mean_env_wait_ms": 2.0522609612688005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008789539337158203, "StateBufferConnector_ms": 0.006283760070800781, "ViewRequirementAgentConnector_ms": 0.2040090560913086}, "num_episodes": 0, "episode_return_max": 22.0, "episode_return_min": 1.0, "episode_return_mean": 6.22, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 151005, "num_agent_steps_trained": 151005, "num_env_steps_sampled": 37888, "num_env_steps_trained": 37888, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 254.57936920501518, "num_env_steps_trained_throughput_per_sec": 254.57936920501518, "timesteps_total": 37888, "num_env_steps_sampled_lifetime": 37888, "num_agent_steps_sampled_lifetime": 151005, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 151005, "timers": {"training_iteration_time_ms": 15286.957, "restore_workers_time_ms": 0.017, "training_step_time_ms": 15286.912, "sample_time_ms": 14430.501, "load_time_ms": 0.266, "load_throughput": 1922201.618, "learn_time_ms": 849.083, "learn_throughput": 603.004, "synch_weights_time_ms": 6.841}, "counters": {"num_env_steps_sampled": 37888, "num_env_steps_trained": 37888, "num_agent_steps_sampled": 151005, "num_agent_steps_trained": 151005}, "done": false, "training_iteration": 74, "trial_id": "37af9_00000", "date": "2024-09-25_18-21-21", "timestamp": 1727288481, "time_this_iter_s": 2.015869617462158, "time_total_s": 1173.9329500198364, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1173.9329500198364, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 14.133333333333335, "ram_util_percent": 32.36666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7063032964785253, "cur_kl_coeff": 1.3552527156068804e-21, "cur_lr": 2e-05, "total_loss": -0.15624959339958525, "policy_loss": 0.001561800627818992, "vf_loss": 0.055511967775096455, "vf_explained_var": -0.06622937571617865, "kl": 0.002802304555704664, "entropy": 1.7168938156097167, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23485.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 38400, "num_env_steps_trained": 38400, "num_agent_steps_sampled": 153036, "num_agent_steps_trained": 153036}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 1.0, "episode_reward_mean": 6.3, "episode_len_mean": 222.0, "episode_media": {}, "episodes_timesteps_total": 22200, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.575}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0, 17.0, 14.0, 3.0, 5.0, 6.0, 9.0, 7.0, 6.0, 3.0, 7.0, 4.0, 4.0, 12.0, 6.0, 4.0, 4.0, 6.0, 6.0, 7.0, 8.0, 7.0, 3.0, 8.0, 6.0, 16.0], "episode_lengths": [183, 163, 163, 203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243, 463, 383, 163, 183, 203, 263, 223, 183, 183, 243, 163, 183, 323, 183, 183, 163, 183, 223, 203, 243, 203, 183, 223, 263, 403], "policy_default_policy_reward": [2.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 13.0, 4.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 1.0, 2.0, 4.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.4583131452191, "mean_inference_ms": 1.1449602835771333, "mean_action_processing_ms": 0.21264717409750644, "mean_env_wait_ms": 2.0530861137004504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00876307487487793, "StateBufferConnector_ms": 0.006286144256591797, "ViewRequirementAgentConnector_ms": 0.20403289794921875}, "num_episodes": 2, "episode_return_max": 22.0, "episode_return_min": 1.0, "episode_return_mean": 6.3, "episodes_this_iter": 2}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 153036, "num_agent_steps_trained": 153036, "num_env_steps_sampled": 38400, "num_env_steps_trained": 38400, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 20.353563356035572, "num_env_steps_trained_throughput_per_sec": 20.353563356035572, "timesteps_total": 38400, "num_env_steps_sampled_lifetime": 38400, "num_agent_steps_sampled_lifetime": 153036, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 153036, "timers": {"training_iteration_time_ms": 15047.99, "restore_workers_time_ms": 0.017, "training_step_time_ms": 15047.944, "sample_time_ms": 14192.024, "load_time_ms": 0.269, "load_throughput": 1905825.034, "learn_time_ms": 848.43, "learn_throughput": 603.468, "synch_weights_time_ms": 7.0}, "counters": {"num_env_steps_sampled": 38400, "num_env_steps_trained": 38400, "num_agent_steps_sampled": 153036, "num_agent_steps_trained": 153036}, "done": false, "training_iteration": 75, "trial_id": "37af9_00000", "date": "2024-09-25_18-21-47", "timestamp": 1727288507, "time_this_iter_s": 25.159629106521606, "time_total_s": 1199.092579126358, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1199.092579126358, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 10.727777777777778, "ram_util_percent": 33.82499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.566766484361142, "cur_kl_coeff": 6.776263578034402e-22, "cur_lr": 2e-05, "total_loss": -0.17102632227761205, "policy_loss": -0.005262531175685581, "vf_loss": 0.030596626394799386, "vf_explained_var": 0.254748672246933, "kl": 0.0037778506316326955, "entropy": 1.7341294646263123, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23800.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 38912, "num_env_steps_trained": 38912, "num_agent_steps_sampled": 155084, "num_agent_steps_trained": 155084}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 1.0, "episode_reward_mean": 6.49, "episode_len_mean": 226.0, "episode_media": {}, "episodes_timesteps_total": 22600, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.6225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0, 5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0, 17.0, 14.0, 3.0, 5.0, 6.0, 9.0, 7.0, 6.0, 3.0, 7.0, 4.0, 4.0, 12.0, 6.0, 4.0, 4.0, 6.0, 6.0, 7.0, 8.0, 7.0, 3.0, 8.0, 6.0, 16.0, 10.0, 17.0, 5.0], "episode_lengths": [203, 183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243, 463, 383, 163, 183, 203, 263, 223, 183, 183, 243, 163, 183, 323, 183, 183, 163, 183, 223, 203, 243, 203, 183, 223, 263, 403, 283, 443, 183], "policy_default_policy_reward": [1.0, 4.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 13.0, 4.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 1.0, 2.0, 4.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0, 6.0, 4.0, 0.0, 0.0, 7.0, 10.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.480716756834944, "mean_inference_ms": 1.1450142531167584, "mean_action_processing_ms": 0.2128892617540833, "mean_env_wait_ms": 2.0541902704139803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008862972259521484, "StateBufferConnector_ms": 0.00627899169921875, "ViewRequirementAgentConnector_ms": 0.2040400505065918}, "num_episodes": 3, "episode_return_max": 22.0, "episode_return_min": 1.0, "episode_return_mean": 6.49, "episodes_this_iter": 3}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 155084, "num_agent_steps_trained": 155084, "num_env_steps_sampled": 38912, "num_env_steps_trained": 38912, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 18.95449617047416, "num_env_steps_trained_throughput_per_sec": 18.95449617047416, "timesteps_total": 38912, "num_env_steps_sampled_lifetime": 38912, "num_agent_steps_sampled_lifetime": 155084, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 155084, "timers": {"training_iteration_time_ms": 16434.948, "restore_workers_time_ms": 0.017, "training_step_time_ms": 16434.902, "sample_time_ms": 15576.346, "load_time_ms": 0.281, "load_throughput": 1824075.128, "learn_time_ms": 851.254, "learn_throughput": 601.465, "synch_weights_time_ms": 6.804}, "counters": {"num_env_steps_sampled": 38912, "num_env_steps_trained": 38912, "num_agent_steps_sampled": 155084, "num_agent_steps_trained": 155084}, "done": false, "training_iteration": 76, "trial_id": "37af9_00000", "date": "2024-09-25_18-22-14", "timestamp": 1727288534, "time_this_iter_s": 27.016437292099, "time_total_s": 1226.109016418457, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1226.109016418457, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 12.368421052631579, "ram_util_percent": 34.13421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6817586180986837, "cur_kl_coeff": 3.388131789017201e-22, "cur_lr": 2e-05, "total_loss": -0.16632028425010503, "policy_loss": -0.003125793777871877, "vf_loss": 0.04111988369986648, "vf_explained_var": -0.12679812554270029, "kl": 0.004246705503572201, "entropy": 1.73474455550313, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24120.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 39424, "num_env_steps_trained": 39424, "num_agent_steps_sampled": 157132, "num_agent_steps_trained": 157132}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 1.0, "episode_reward_mean": 6.49, "episode_len_mean": 225.8, "episode_media": {}, "episodes_timesteps_total": 22580, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.6225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0, 5.0, 5.0, 12.0, 7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0, 17.0, 14.0, 3.0, 5.0, 6.0, 9.0, 7.0, 6.0, 3.0, 7.0, 4.0, 4.0, 12.0, 6.0, 4.0, 4.0, 6.0, 6.0, 7.0, 8.0, 7.0, 3.0, 8.0, 6.0, 16.0, 10.0, 17.0, 5.0, 5.0], "episode_lengths": [183, 183, 183, 283, 243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243, 463, 383, 163, 183, 203, 263, 223, 183, 183, 243, 163, 183, 323, 183, 183, 163, 183, 223, 203, 243, 203, 183, 223, 263, 403, 283, 443, 183, 183], "policy_default_policy_reward": [2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 13.0, 4.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 1.0, 2.0, 4.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0, 6.0, 4.0, 0.0, 0.0, 7.0, 10.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.50318340772072, "mean_inference_ms": 1.145179624365101, "mean_action_processing_ms": 0.21274789019820362, "mean_env_wait_ms": 2.054647935183693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00887918472290039, "StateBufferConnector_ms": 0.006276130676269531, "ViewRequirementAgentConnector_ms": 0.20355606079101562}, "num_episodes": 1, "episode_return_max": 22.0, "episode_return_min": 1.0, "episode_return_mean": 6.49, "episodes_this_iter": 1}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 157132, "num_agent_steps_trained": 157132, "num_env_steps_sampled": 39424, "num_env_steps_trained": 39424, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 41.566094784463495, "num_env_steps_trained_throughput_per_sec": 41.566094784463495, "timesteps_total": 39424, "num_env_steps_sampled_lifetime": 39424, "num_agent_steps_sampled_lifetime": 157132, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 157132, "timers": {"training_iteration_time_ms": 16006.225, "restore_workers_time_ms": 0.017, "training_step_time_ms": 16006.179, "sample_time_ms": 15146.279, "load_time_ms": 0.284, "load_throughput": 1803547.197, "learn_time_ms": 852.468, "learn_throughput": 600.609, "synch_weights_time_ms": 6.93}, "counters": {"num_env_steps_sampled": 39424, "num_env_steps_trained": 39424, "num_agent_steps_sampled": 157132, "num_agent_steps_trained": 157132}, "done": false, "training_iteration": 77, "trial_id": "37af9_00000", "date": "2024-09-25_18-22-26", "timestamp": 1727288546, "time_this_iter_s": 12.321449041366577, "time_total_s": 1238.4304654598236, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1238.4304654598236, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 7.46111111111111, "ram_util_percent": 33.672222222222224}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.663809596939433, "cur_kl_coeff": 1.6940658945086005e-22, "cur_lr": 2e-05, "total_loss": -0.1625271519255494, "policy_loss": 8.58614341385903e-05, "vf_loss": 0.041318000829778614, "vf_explained_var": 0.29328650409175505, "kl": 0.004224542456202401, "entropy": 1.7294251138164152, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24435.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 39936, "num_env_steps_trained": 39936, "num_agent_steps_sampled": 159167, "num_agent_steps_trained": 159167}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 1.0, "episode_reward_mean": 6.44, "episode_len_mean": 225.8, "episode_media": {}, "episodes_timesteps_total": 22580, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.61}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.0, 4.0, 3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0, 17.0, 14.0, 3.0, 5.0, 6.0, 9.0, 7.0, 6.0, 3.0, 7.0, 4.0, 4.0, 12.0, 6.0, 4.0, 4.0, 6.0, 6.0, 7.0, 8.0, 7.0, 3.0, 8.0, 6.0, 16.0, 10.0, 17.0, 5.0, 5.0, 8.0, 7.0, 5.0, 2.0], "episode_lengths": [243, 163, 223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243, 463, 383, 163, 183, 203, 263, 223, 183, 183, 243, 163, 183, 323, 183, 183, 163, 183, 223, 203, 243, 203, 183, 223, 263, 403, 283, 443, 183, 183, 243, 243, 183, 163], "policy_default_policy_reward": [3.0, 4.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 13.0, 4.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 1.0, 2.0, 4.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0, 6.0, 4.0, 0.0, 0.0, 7.0, 10.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 1.0, 2.0, 5.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.512671455522465, "mean_inference_ms": 1.1459611899671232, "mean_action_processing_ms": 0.2125088788995538, "mean_env_wait_ms": 2.0560642551213926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00880289077758789, "StateBufferConnector_ms": 0.006288766860961914, "ViewRequirementAgentConnector_ms": 0.2041301727294922}, "num_episodes": 4, "episode_return_max": 22.0, "episode_return_min": 1.0, "episode_return_mean": 6.44, "episodes_this_iter": 4}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 159167, "num_agent_steps_trained": 159167, "num_env_steps_sampled": 39936, "num_env_steps_trained": 39936, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 32.67418237922625, "num_env_steps_trained_throughput_per_sec": 32.67418237922625, "timesteps_total": 39936, "num_env_steps_sampled_lifetime": 39936, "num_agent_steps_sampled_lifetime": 159167, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 159167, "timers": {"training_iteration_time_ms": 16029.888, "restore_workers_time_ms": 0.017, "training_step_time_ms": 16029.841, "sample_time_ms": 15173.349, "load_time_ms": 0.284, "load_throughput": 1802941.523, "learn_time_ms": 849.093, "learn_throughput": 602.996, "synch_weights_time_ms": 6.896}, "counters": {"num_env_steps_sampled": 39936, "num_env_steps_trained": 39936, "num_agent_steps_sampled": 159167, "num_agent_steps_trained": 159167}, "done": false, "training_iteration": 78, "trial_id": "37af9_00000", "date": "2024-09-25_18-22-42", "timestamp": 1727288562, "time_this_iter_s": 15.674636602401733, "time_total_s": 1254.1051020622253, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1254.1051020622253, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 19.595454545454547, "ram_util_percent": 33.863636363636374}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6661756531335413, "cur_kl_coeff": 8.470329472543003e-23, "cur_lr": 2e-05, "total_loss": -0.16775320146407466, "policy_loss": -0.0053480429953197016, "vf_loss": 0.0370475107083621, "vf_explained_var": -0.0769310586154461, "kl": 0.0032297524118713563, "entropy": 1.716670362278819, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24750.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 40448, "num_env_steps_trained": 40448, "num_agent_steps_sampled": 161215, "num_agent_steps_trained": 161215}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 1.0, "episode_reward_mean": 6.37, "episode_len_mean": 225.2, "episode_media": {}, "episodes_timesteps_total": 22520, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.5925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0, 6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0, 17.0, 14.0, 3.0, 5.0, 6.0, 9.0, 7.0, 6.0, 3.0, 7.0, 4.0, 4.0, 12.0, 6.0, 4.0, 4.0, 6.0, 6.0, 7.0, 8.0, 7.0, 3.0, 8.0, 6.0, 16.0, 10.0, 17.0, 5.0, 5.0, 8.0, 7.0, 5.0, 2.0, 2.0, 2.0], "episode_lengths": [223, 223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243, 463, 383, 163, 183, 203, 263, 223, 183, 183, 243, 163, 183, 323, 183, 183, 163, 183, 223, 203, 243, 203, 183, 223, 263, 403, 283, 443, 183, 183, 243, 243, 183, 163, 163, 183], "policy_default_policy_reward": [1.0, 2.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 13.0, 4.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 1.0, 2.0, 4.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0, 6.0, 4.0, 0.0, 0.0, 7.0, 10.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 1.0, 2.0, 5.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.52729997720601, "mean_inference_ms": 1.1457561653045074, "mean_action_processing_ms": 0.2125131930107667, "mean_env_wait_ms": 2.056515305554175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008780717849731445, "StateBufferConnector_ms": 0.0062673091888427734, "ViewRequirementAgentConnector_ms": 0.2038872241973877}, "num_episodes": 2, "episode_return_max": 22.0, "episode_return_min": 1.0, "episode_return_mean": 6.37, "episodes_this_iter": 2}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 161215, "num_agent_steps_trained": 161215, "num_env_steps_sampled": 40448, "num_env_steps_trained": 40448, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 41.861473083218726, "num_env_steps_trained_throughput_per_sec": 41.861473083218726, "timesteps_total": 40448, "num_env_steps_sampled_lifetime": 40448, "num_agent_steps_sampled_lifetime": 161215, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 161215, "timers": {"training_iteration_time_ms": 15186.733, "restore_workers_time_ms": 0.018, "training_step_time_ms": 15186.686, "sample_time_ms": 14326.14, "load_time_ms": 0.282, "load_throughput": 1814212.763, "learn_time_ms": 853.111, "learn_throughput": 600.157, "synch_weights_time_ms": 6.932}, "counters": {"num_env_steps_sampled": 40448, "num_env_steps_trained": 40448, "num_agent_steps_sampled": 161215, "num_agent_steps_trained": 161215}, "done": false, "training_iteration": 79, "trial_id": "37af9_00000", "date": "2024-09-25_18-22-54", "timestamp": 1727288574, "time_this_iter_s": 12.234652996063232, "time_total_s": 1266.3397550582886, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1266.3397550582886, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 11.11111111111111, "ram_util_percent": 33.64444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6494934838963673, "cur_kl_coeff": 4.2351647362715013e-23, "cur_lr": 2e-05, "total_loss": -0.16973609868146014, "policy_loss": -0.0050356865976937115, "vf_loss": 0.03180404965769412, "vf_explained_var": -0.034077832289040086, "kl": 0.003922844455190954, "entropy": 1.7265142314136028, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25070.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_agent_steps_sampled": 163263, "num_agent_steps_trained": 163263}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 1.0, "episode_reward_mean": 6.46, "episode_len_mean": 226.6, "episode_media": {}, "episodes_timesteps_total": 22660, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.615}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.0, 2.0, 6.0, 10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0, 17.0, 14.0, 3.0, 5.0, 6.0, 9.0, 7.0, 6.0, 3.0, 7.0, 4.0, 4.0, 12.0, 6.0, 4.0, 4.0, 6.0, 6.0, 7.0, 8.0, 7.0, 3.0, 8.0, 6.0, 16.0, 10.0, 17.0, 5.0, 5.0, 8.0, 7.0, 5.0, 2.0, 2.0, 2.0, 12.0], "episode_lengths": [223, 163, 203, 283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243, 463, 383, 163, 183, 203, 263, 223, 183, 183, 243, 163, 183, 323, 183, 183, 163, 183, 223, 203, 243, 203, 183, 223, 263, 403, 283, 443, 183, 183, 243, 243, 183, 163, 163, 183, 363], "policy_default_policy_reward": [3.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 13.0, 4.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 1.0, 2.0, 4.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0, 6.0, 4.0, 0.0, 0.0, 7.0, 10.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 1.0, 2.0, 5.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 9.0, 3.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.54102310622469, "mean_inference_ms": 1.1457952666973545, "mean_action_processing_ms": 0.21227824324560987, "mean_env_wait_ms": 2.056978107414219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00877690315246582, "StateBufferConnector_ms": 0.006264209747314453, "ViewRequirementAgentConnector_ms": 0.20382165908813477}, "num_episodes": 1, "episode_return_max": 22.0, "episode_return_min": 1.0, "episode_return_mean": 6.46, "episodes_this_iter": 1}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 163263, "num_agent_steps_trained": 163263, "num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 22.881333761236178, "num_env_steps_trained_throughput_per_sec": 22.881333761236178, "timesteps_total": 40960, "num_env_steps_sampled_lifetime": 40960, "num_agent_steps_sampled_lifetime": 163263, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 163263, "timers": {"training_iteration_time_ms": 16165.371, "restore_workers_time_ms": 0.018, "training_step_time_ms": 16165.323, "sample_time_ms": 15301.011, "load_time_ms": 0.276, "load_throughput": 1856881.667, "learn_time_ms": 856.695, "learn_throughput": 597.646, "synch_weights_time_ms": 7.12}, "counters": {"num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_agent_steps_sampled": 163263, "num_agent_steps_trained": 163263}, "done": false, "training_iteration": 80, "trial_id": "37af9_00000", "date": "2024-09-25_18-23-16", "timestamp": 1727288596, "time_this_iter_s": 22.380255937576294, "time_total_s": 1288.7200109958649, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1288.7200109958649, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 7.6499999999999995, "ram_util_percent": 34.1875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6650375502965142, "cur_kl_coeff": 2.1175823681357507e-23, "cur_lr": 2e-05, "total_loss": -0.17241396375391033, "policy_loss": -0.008439279813319444, "vf_loss": 0.031014889431929576, "vf_explained_var": 0.3047112834069037, "kl": 0.006074872355137133, "entropy": 1.717284030683579, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25385.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 41472, "num_env_steps_trained": 41472, "num_agent_steps_sampled": 165254, "num_agent_steps_trained": 165254}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 1.0, "episode_reward_mean": 6.57, "episode_len_mean": 229.0, "episode_media": {}, "episodes_timesteps_total": 22900, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.6425}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 5.0, 6.0, 2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0, 17.0, 14.0, 3.0, 5.0, 6.0, 9.0, 7.0, 6.0, 3.0, 7.0, 4.0, 4.0, 12.0, 6.0, 4.0, 4.0, 6.0, 6.0, 7.0, 8.0, 7.0, 3.0, 8.0, 6.0, 16.0, 10.0, 17.0, 5.0, 5.0, 8.0, 7.0, 5.0, 2.0, 2.0, 2.0, 12.0, 11.0, 3.0, 11.0], "episode_lengths": [283, 203, 203, 163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243, 463, 383, 163, 183, 203, 263, 223, 183, 183, 243, 163, 183, 323, 183, 183, 163, 183, 223, 203, 243, 203, 183, 223, 263, 403, 283, 443, 183, 183, 243, 243, 183, 163, 163, 183, 363, 303, 183, 343], "policy_default_policy_reward": [6.0, 2.0, 0.0, 2.0, 1.0, 3.0, 0.0, 1.0, 5.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 13.0, 4.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 1.0, 2.0, 4.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0, 6.0, 4.0, 0.0, 0.0, 7.0, 10.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 1.0, 2.0, 5.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 9.0, 3.0, 0.0, 0.0, 3.0, 8.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.546329097095104, "mean_inference_ms": 1.146268957043892, "mean_action_processing_ms": 0.2120522680026599, "mean_env_wait_ms": 2.057792034793039, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00876617431640625, "StateBufferConnector_ms": 0.006262302398681641, "ViewRequirementAgentConnector_ms": 0.20356988906860352}, "num_episodes": 3, "episode_return_max": 22.0, "episode_return_min": 1.0, "episode_return_mean": 6.57, "episodes_this_iter": 3}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 165254, "num_agent_steps_trained": 165254, "num_env_steps_sampled": 41472, "num_env_steps_trained": 41472, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 23.9232159071581, "num_env_steps_trained_throughput_per_sec": 23.9232159071581, "timesteps_total": 41472, "num_env_steps_sampled_lifetime": 41472, "num_agent_steps_sampled_lifetime": 165254, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 165254, "timers": {"training_iteration_time_ms": 16855.191, "restore_workers_time_ms": 0.017, "training_step_time_ms": 16855.146, "sample_time_ms": 15990.253, "load_time_ms": 0.289, "load_throughput": 1769223.635, "learn_time_ms": 856.938, "learn_throughput": 597.476, "synch_weights_time_ms": 7.444}, "counters": {"num_env_steps_sampled": 41472, "num_env_steps_trained": 41472, "num_agent_steps_sampled": 165254, "num_agent_steps_trained": 165254}, "done": false, "training_iteration": 81, "trial_id": "37af9_00000", "date": "2024-09-25_18-23-38", "timestamp": 1727288618, "time_this_iter_s": 21.404905796051025, "time_total_s": 1310.124916791916, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1310.124916791916, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 14.426666666666668, "ram_util_percent": 34.813333333333325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.691422018641606, "cur_kl_coeff": 2.1175823681357507e-23, "cur_lr": 2e-05, "total_loss": -0.16123011778108776, "policy_loss": -0.0051241338980617, "vf_loss": 0.05084218354531913, "vf_explained_var": 0.0034852081909775732, "kl": 0.0022217305240623377, "entropy": 1.6881652880460023, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25700.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 41984, "num_env_steps_trained": 41984, "num_agent_steps_sampled": 167302, "num_agent_steps_trained": 167302}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 1.0, "episode_reward_mean": 6.5, "episode_len_mean": 227.4, "episode_media": {}, "episodes_timesteps_total": 22740, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0, 17.0, 14.0, 3.0, 5.0, 6.0, 9.0, 7.0, 6.0, 3.0, 7.0, 4.0, 4.0, 12.0, 6.0, 4.0, 4.0, 6.0, 6.0, 7.0, 8.0, 7.0, 3.0, 8.0, 6.0, 16.0, 10.0, 17.0, 5.0, 5.0, 8.0, 7.0, 5.0, 2.0, 2.0, 2.0, 12.0, 11.0, 3.0, 11.0, 4.0, 6.0, 4.0], "episode_lengths": [163, 183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243, 463, 383, 163, 183, 203, 263, 223, 183, 183, 243, 163, 183, 323, 183, 183, 163, 183, 223, 203, 243, 203, 183, 223, 263, 403, 283, 443, 183, 183, 243, 243, 183, 163, 163, 183, 363, 303, 183, 343, 163, 203, 163], "policy_default_policy_reward": [1.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 13.0, 4.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 1.0, 2.0, 4.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0, 6.0, 4.0, 0.0, 0.0, 7.0, 10.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 1.0, 2.0, 5.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 9.0, 3.0, 0.0, 0.0, 3.0, 8.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.57073576139828, "mean_inference_ms": 1.1459151782782622, "mean_action_processing_ms": 0.21210335628365884, "mean_env_wait_ms": 2.0581369544117116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008791208267211914, "StateBufferConnector_ms": 0.006249189376831055, "ViewRequirementAgentConnector_ms": 0.2029705047607422}, "num_episodes": 3, "episode_return_max": 22.0, "episode_return_min": 1.0, "episode_return_mean": 6.5, "episodes_this_iter": 3}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 167302, "num_agent_steps_trained": 167302, "num_env_steps_sampled": 41984, "num_env_steps_trained": 41984, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 39.06324280754275, "num_env_steps_trained_throughput_per_sec": 39.06324280754275, "timesteps_total": 41984, "num_env_steps_sampled_lifetime": 41984, "num_agent_steps_sampled_lifetime": 167302, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 167302, "timers": {"training_iteration_time_ms": 16547.837, "restore_workers_time_ms": 0.018, "training_step_time_ms": 16547.79, "sample_time_ms": 15681.286, "load_time_ms": 0.301, "load_throughput": 1700977.147, "learn_time_ms": 858.164, "learn_throughput": 596.623, "synch_weights_time_ms": 7.816}, "counters": {"num_env_steps_sampled": 41984, "num_env_steps_trained": 41984, "num_agent_steps_sampled": 167302, "num_agent_steps_trained": 167302}, "done": false, "training_iteration": 82, "trial_id": "37af9_00000", "date": "2024-09-25_18-23-51", "timestamp": 1727288631, "time_this_iter_s": 13.110844850540161, "time_total_s": 1323.235761642456, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1323.235761642456, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 14.642105263157895, "ram_util_percent": 34.926315789473676}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6463095473358408, "cur_kl_coeff": 1.0587911840678753e-23, "cur_lr": 2e-05, "total_loss": -0.16798558961891102, "policy_loss": -0.0069066145544638856, "vf_loss": 0.033766540161195735, "vf_explained_var": -0.017000037990510464, "kl": 0.0074109675444290705, "entropy": 1.6952060770243407, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26020.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 42496, "num_env_steps_trained": 42496, "num_agent_steps_sampled": 169350, "num_agent_steps_trained": 169350}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 1.0, "episode_reward_mean": 6.51, "episode_len_mean": 227.6, "episode_media": {}, "episodes_timesteps_total": 22760, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.6275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0, 5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0, 17.0, 14.0, 3.0, 5.0, 6.0, 9.0, 7.0, 6.0, 3.0, 7.0, 4.0, 4.0, 12.0, 6.0, 4.0, 4.0, 6.0, 6.0, 7.0, 8.0, 7.0, 3.0, 8.0, 6.0, 16.0, 10.0, 17.0, 5.0, 5.0, 8.0, 7.0, 5.0, 2.0, 2.0, 2.0, 12.0, 11.0, 3.0, 11.0, 4.0, 6.0, 4.0, 3.0], "episode_lengths": [183, 163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243, 463, 383, 163, 183, 203, 263, 223, 183, 183, 243, 163, 183, 323, 183, 183, 163, 183, 223, 203, 243, 203, 183, 223, 263, 403, 283, 443, 183, 183, 243, 243, 183, 163, 163, 183, 363, 303, 183, 343, 163, 203, 163, 183], "policy_default_policy_reward": [3.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 13.0, 4.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 1.0, 2.0, 4.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0, 6.0, 4.0, 0.0, 0.0, 7.0, 10.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 1.0, 2.0, 5.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 9.0, 3.0, 0.0, 0.0, 3.0, 8.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.57352067349774, "mean_inference_ms": 1.1458046213759194, "mean_action_processing_ms": 0.21191376499609402, "mean_env_wait_ms": 2.05844796178347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008747577667236328, "StateBufferConnector_ms": 0.006247520446777344, "ViewRequirementAgentConnector_ms": 0.20284557342529297}, "num_episodes": 1, "episode_return_max": 22.0, "episode_return_min": 1.0, "episode_return_mean": 6.51, "episodes_this_iter": 1}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 169350, "num_agent_steps_trained": 169350, "num_env_steps_sampled": 42496, "num_env_steps_trained": 42496, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 42.02327737446974, "num_env_steps_trained_throughput_per_sec": 42.02327737446974, "timesteps_total": 42496, "num_env_steps_sampled_lifetime": 42496, "num_agent_steps_sampled_lifetime": 169350, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 169350, "timers": {"training_iteration_time_ms": 16346.584, "restore_workers_time_ms": 0.019, "training_step_time_ms": 16346.534, "sample_time_ms": 15483.103, "load_time_ms": 0.298, "load_throughput": 1717437.338, "learn_time_ms": 855.546, "learn_throughput": 598.448, "synch_weights_time_ms": 7.358}, "counters": {"num_env_steps_sampled": 42496, "num_env_steps_trained": 42496, "num_agent_steps_sampled": 169350, "num_agent_steps_trained": 169350}, "done": false, "training_iteration": 83, "trial_id": "37af9_00000", "date": "2024-09-25_18-24-03", "timestamp": 1727288643, "time_this_iter_s": 12.187337636947632, "time_total_s": 1335.4230992794037, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1335.4230992794037, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 9.18235294117647, "ram_util_percent": 34.90588235294118}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6751242352183908, "cur_kl_coeff": 1.0587911840678753e-23, "cur_lr": 2e-05, "total_loss": -0.15712576694204472, "policy_loss": -0.003891815387760289, "vf_loss": 0.062256076895209844, "vf_explained_var": -0.015248008072376251, "kl": 0.002822472231827078, "entropy": 1.687979654595256, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26340.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled": 171398, "num_agent_steps_trained": 171398}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 1.0, "episode_reward_mean": 6.61, "episode_len_mean": 229.6, "episode_media": {}, "episodes_timesteps_total": 22960, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.6525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0, 17.0, 14.0, 3.0, 5.0, 6.0, 9.0, 7.0, 6.0, 3.0, 7.0, 4.0, 4.0, 12.0, 6.0, 4.0, 4.0, 6.0, 6.0, 7.0, 8.0, 7.0, 3.0, 8.0, 6.0, 16.0, 10.0, 17.0, 5.0, 5.0, 8.0, 7.0, 5.0, 2.0, 2.0, 2.0, 12.0, 11.0, 3.0, 11.0, 4.0, 6.0, 4.0, 3.0, 15.0], "episode_lengths": [163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243, 463, 383, 163, 183, 203, 263, 223, 183, 183, 243, 163, 183, 323, 183, 183, 163, 183, 223, 203, 243, 203, 183, 223, 263, 403, 283, 443, 183, 183, 243, 243, 183, 163, 163, 183, 363, 303, 183, 343, 163, 203, 163, 183, 383], "policy_default_policy_reward": [4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 13.0, 4.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 1.0, 2.0, 4.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0, 6.0, 4.0, 0.0, 0.0, 7.0, 10.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 1.0, 2.0, 5.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 9.0, 3.0, 0.0, 0.0, 3.0, 8.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 10.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.57914002795218, "mean_inference_ms": 1.1459065193531657, "mean_action_processing_ms": 0.21184793384320255, "mean_env_wait_ms": 2.0587534969191514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008740901947021484, "StateBufferConnector_ms": 0.006242513656616211, "ViewRequirementAgentConnector_ms": 0.20275092124938965}, "num_episodes": 1, "episode_return_max": 22.0, "episode_return_min": 1.0, "episode_return_mean": 6.61, "episodes_this_iter": 1}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 171398, "num_agent_steps_trained": 171398, "num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 21.609245990058163, "num_env_steps_trained_throughput_per_sec": 21.609245990058163, "timesteps_total": 43008, "num_env_steps_sampled_lifetime": 43008, "num_agent_steps_sampled_lifetime": 171398, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 171398, "timers": {"training_iteration_time_ms": 18514.824, "restore_workers_time_ms": 0.019, "training_step_time_ms": 18514.774, "sample_time_ms": 17649.883, "load_time_ms": 0.296, "load_throughput": 1731701.998, "learn_time_ms": 856.972, "learn_throughput": 597.452, "synch_weights_time_ms": 7.396}, "counters": {"num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled": 171398, "num_agent_steps_trained": 171398}, "done": false, "training_iteration": 84, "trial_id": "37af9_00000", "date": "2024-09-25_18-24-27", "timestamp": 1727288667, "time_this_iter_s": 23.696484804153442, "time_total_s": 1359.1195840835571, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1359.1195840835571, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 7.238235294117648, "ram_util_percent": 34.7235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7951176472969593, "cur_kl_coeff": 5.293955920339377e-24, "cur_lr": 2e-05, "total_loss": -0.1636799288613181, "policy_loss": -0.012835433517372416, "vf_loss": 0.0763430004004359, "vf_explained_var": -0.18750349244763775, "kl": 0.012333717361664753, "entropy": 1.699302412617591, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26655.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 43520, "num_env_steps_trained": 43520, "num_agent_steps_sampled": 173405, "num_agent_steps_trained": 173405}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 1.0, "episode_reward_mean": 6.61, "episode_len_mean": 229.6, "episode_media": {}, "episodes_timesteps_total": 22960, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 14.0}, "policy_reward_mean": {"default_policy": 1.6525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0, 2.0, 10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0, 17.0, 14.0, 3.0, 5.0, 6.0, 9.0, 7.0, 6.0, 3.0, 7.0, 4.0, 4.0, 12.0, 6.0, 4.0, 4.0, 6.0, 6.0, 7.0, 8.0, 7.0, 3.0, 8.0, 6.0, 16.0, 10.0, 17.0, 5.0, 5.0, 8.0, 7.0, 5.0, 2.0, 2.0, 2.0, 12.0, 11.0, 3.0, 11.0, 4.0, 6.0, 4.0, 3.0, 15.0], "episode_lengths": [163, 163, 283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243, 463, 383, 163, 183, 203, 263, 223, 183, 183, 243, 163, 183, 323, 183, 183, 163, 183, 223, 203, 243, 203, 183, 223, 263, 403, 283, 443, 183, 183, 243, 243, 183, 163, 163, 183, 363, 303, 183, 343, 163, 203, 163, 183, 383], "policy_default_policy_reward": [4.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 13.0, 4.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 1.0, 2.0, 4.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0, 6.0, 4.0, 0.0, 0.0, 7.0, 10.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 1.0, 2.0, 5.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 9.0, 3.0, 0.0, 0.0, 3.0, 8.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 10.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.57914002795218, "mean_inference_ms": 1.1459065193531657, "mean_action_processing_ms": 0.21184793384320255, "mean_env_wait_ms": 2.0587534969191514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008740901947021484, "StateBufferConnector_ms": 0.006242513656616211, "ViewRequirementAgentConnector_ms": 0.20275092124938965}, "num_episodes": 0, "episode_return_max": 22.0, "episode_return_min": 1.0, "episode_return_mean": 6.61, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 173405, "num_agent_steps_trained": 173405, "num_env_steps_sampled": 43520, "num_env_steps_trained": 43520, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 246.98488084484538, "num_env_steps_trained_throughput_per_sec": 246.98488084484538, "timesteps_total": 43520, "num_env_steps_sampled_lifetime": 43520, "num_agent_steps_sampled_lifetime": 173405, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 173405, "timers": {"training_iteration_time_ms": 16206.594, "restore_workers_time_ms": 0.019, "training_step_time_ms": 16206.544, "sample_time_ms": 15341.231, "load_time_ms": 0.299, "load_throughput": 1714831.628, "learn_time_ms": 857.512, "learn_throughput": 597.076, "synch_weights_time_ms": 7.274}, "counters": {"num_env_steps_sampled": 43520, "num_env_steps_trained": 43520, "num_agent_steps_sampled": 173405, "num_agent_steps_trained": 173405}, "done": false, "training_iteration": 85, "trial_id": "37af9_00000", "date": "2024-09-25_18-24-29", "timestamp": 1727288669, "time_this_iter_s": 2.0759456157684326, "time_total_s": 1361.1955296993256, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1361.1955296993256, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 14.066666666666665, "ram_util_percent": 32.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7482292868917988, "cur_kl_coeff": 5.293955920339377e-24, "cur_lr": 2e-05, "total_loss": -0.1633993850239823, "policy_loss": -0.007671284615512817, "vf_loss": 0.05718309255316854, "vf_explained_var": 0.22006466734793878, "kl": 0.002037160131713504, "entropy": 1.7002387008359354, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26965.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 44032, "num_env_steps_trained": 44032, "num_agent_steps_sampled": 175412, "num_agent_steps_trained": 175412}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 1.0, "episode_reward_mean": 6.83, "episode_len_mean": 233.6, "episode_media": {}, "episodes_timesteps_total": 23360, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 15.0}, "policy_reward_mean": {"default_policy": 1.7075}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0, 17.0, 14.0, 3.0, 5.0, 6.0, 9.0, 7.0, 6.0, 3.0, 7.0, 4.0, 4.0, 12.0, 6.0, 4.0, 4.0, 6.0, 6.0, 7.0, 8.0, 7.0, 3.0, 8.0, 6.0, 16.0, 10.0, 17.0, 5.0, 5.0, 8.0, 7.0, 5.0, 2.0, 2.0, 2.0, 12.0, 11.0, 3.0, 11.0, 4.0, 6.0, 4.0, 3.0, 15.0, 20.0, 9.0], "episode_lengths": [283, 163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243, 463, 383, 163, 183, 203, 263, 223, 183, 183, 243, 163, 183, 323, 183, 183, 163, 183, 223, 203, 243, 203, 183, 223, 263, 403, 283, 443, 183, 183, 243, 243, 183, 163, 163, 183, 363, 303, 183, 343, 163, 203, 163, 183, 383, 483, 243], "policy_default_policy_reward": [5.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 13.0, 4.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 1.0, 2.0, 4.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0, 6.0, 4.0, 0.0, 0.0, 7.0, 10.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 1.0, 2.0, 5.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 9.0, 3.0, 0.0, 0.0, 3.0, 8.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 10.0, 0.0, 0.0, 15.0, 5.0, 0.0, 0.0, 6.0, 3.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.585532685278196, "mean_inference_ms": 1.14550219930884, "mean_action_processing_ms": 0.21187665578438414, "mean_env_wait_ms": 2.0589433424690533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008749008178710938, "StateBufferConnector_ms": 0.00624847412109375, "ViewRequirementAgentConnector_ms": 0.20327496528625488}, "num_episodes": 2, "episode_return_max": 22.0, "episode_return_min": 1.0, "episode_return_mean": 6.83, "episodes_this_iter": 2}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 175412, "num_agent_steps_trained": 175412, "num_env_steps_sampled": 44032, "num_env_steps_trained": 44032, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 17.327859640669985, "num_env_steps_trained_throughput_per_sec": 17.327859640669985, "timesteps_total": 44032, "num_env_steps_sampled_lifetime": 44032, "num_agent_steps_sampled_lifetime": 175412, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 175412, "timers": {"training_iteration_time_ms": 16460.167, "restore_workers_time_ms": 0.02, "training_step_time_ms": 16460.117, "sample_time_ms": 15597.822, "load_time_ms": 0.296, "load_throughput": 1732121.026, "learn_time_ms": 854.283, "learn_throughput": 599.333, "synch_weights_time_ms": 7.483}, "counters": {"num_env_steps_sampled": 44032, "num_env_steps_trained": 44032, "num_agent_steps_sampled": 175412, "num_agent_steps_trained": 175412}, "done": false, "training_iteration": 86, "trial_id": "37af9_00000", "date": "2024-09-25_18-24-58", "timestamp": 1727288698, "time_this_iter_s": 29.55179715156555, "time_total_s": 1390.747326850891, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1390.747326850891, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 9.792857142857143, "ram_util_percent": 34.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6856231092925995, "cur_kl_coeff": 2.6469779601696883e-24, "cur_lr": 2e-05, "total_loss": -0.1694684544818536, "policy_loss": -0.012352797556518306, "vf_loss": 0.05449790527984019, "vf_explained_var": -0.08597026063549904, "kl": 0.004721169277854092, "entropy": 1.7074013248566657, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27275.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 44544, "num_env_steps_trained": 44544, "num_agent_steps_sampled": 177419, "num_agent_steps_trained": 177419}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 1.0, "episode_reward_mean": 6.91, "episode_len_mean": 235.2, "episode_media": {}, "episodes_timesteps_total": 23520, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 15.0}, "policy_reward_mean": {"default_policy": 1.7275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0, 17.0, 14.0, 3.0, 5.0, 6.0, 9.0, 7.0, 6.0, 3.0, 7.0, 4.0, 4.0, 12.0, 6.0, 4.0, 4.0, 6.0, 6.0, 7.0, 8.0, 7.0, 3.0, 8.0, 6.0, 16.0, 10.0, 17.0, 5.0, 5.0, 8.0, 7.0, 5.0, 2.0, 2.0, 2.0, 12.0, 11.0, 3.0, 11.0, 4.0, 6.0, 4.0, 3.0, 15.0, 20.0, 9.0, 18.0], "episode_lengths": [163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243, 463, 383, 163, 183, 203, 263, 223, 183, 183, 243, 163, 183, 323, 183, 183, 163, 183, 223, 203, 243, 203, 183, 223, 263, 403, 283, 443, 183, 183, 243, 243, 183, 163, 163, 183, 363, 303, 183, 343, 163, 203, 163, 183, 383, 483, 243, 443], "policy_default_policy_reward": [0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 13.0, 4.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 1.0, 2.0, 4.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0, 6.0, 4.0, 0.0, 0.0, 7.0, 10.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 1.0, 2.0, 5.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 9.0, 3.0, 0.0, 0.0, 3.0, 8.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 10.0, 0.0, 0.0, 15.0, 5.0, 0.0, 0.0, 6.0, 3.0, 0.0, 0.0, 12.0, 5.0, 0.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.601912015486114, "mean_inference_ms": 1.1454758858900367, "mean_action_processing_ms": 0.21166287040069687, "mean_env_wait_ms": 2.0593632258879975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008736133575439453, "StateBufferConnector_ms": 0.006239891052246094, "ViewRequirementAgentConnector_ms": 0.20310473442077637}, "num_episodes": 1, "episode_return_max": 22.0, "episode_return_min": 1.0, "episode_return_mean": 6.91, "episodes_this_iter": 1}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 177419, "num_agent_steps_trained": 177419, "num_env_steps_sampled": 44544, "num_env_steps_trained": 44544, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 19.37304827343914, "num_env_steps_trained_throughput_per_sec": 19.37304827343914, "timesteps_total": 44544, "num_env_steps_sampled_lifetime": 44544, "num_agent_steps_sampled_lifetime": 177419, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 177419, "timers": {"training_iteration_time_ms": 17871.241, "restore_workers_time_ms": 0.02, "training_step_time_ms": 17871.19, "sample_time_ms": 17012.115, "load_time_ms": 0.293, "load_throughput": 1749762.607, "learn_time_ms": 850.986, "learn_throughput": 601.655, "synch_weights_time_ms": 7.562}, "counters": {"num_env_steps_sampled": 44544, "num_env_steps_trained": 44544, "num_agent_steps_sampled": 177419, "num_agent_steps_trained": 177419}, "done": false, "training_iteration": 87, "trial_id": "37af9_00000", "date": "2024-09-25_18-25-25", "timestamp": 1727288725, "time_this_iter_s": 26.43266010284424, "time_total_s": 1417.1799869537354, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1417.1799869537354, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 7.386486486486488, "ram_util_percent": 35.805405405405395}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7848689707702604, "cur_kl_coeff": 1.3234889800848442e-24, "cur_lr": 2e-05, "total_loss": -0.16773465107484112, "policy_loss": -0.018036623504655114, "vf_loss": 0.07304184291319087, "vf_explained_var": -0.0547421015542129, "kl": 0.008264131380091667, "entropy": 1.679584855457832, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27575.5, "diff_num_grad_updates_vs_sampler_policy": 144.5}}, "num_env_steps_sampled": 45056, "num_env_steps_trained": 45056, "num_agent_steps_sampled": 179312, "num_agent_steps_trained": 179312}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": 1.0, "episode_reward_mean": 6.91, "episode_len_mean": 235.2, "episode_media": {}, "episodes_timesteps_total": 23520, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 15.0}, "policy_reward_mean": {"default_policy": 1.7275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.0, 3.0, 4.0, 4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0, 17.0, 14.0, 3.0, 5.0, 6.0, 9.0, 7.0, 6.0, 3.0, 7.0, 4.0, 4.0, 12.0, 6.0, 4.0, 4.0, 6.0, 6.0, 7.0, 8.0, 7.0, 3.0, 8.0, 6.0, 16.0, 10.0, 17.0, 5.0, 5.0, 8.0, 7.0, 5.0, 2.0, 2.0, 2.0, 12.0, 11.0, 3.0, 11.0, 4.0, 6.0, 4.0, 3.0, 15.0, 20.0, 9.0, 18.0], "episode_lengths": [163, 163, 223, 183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243, 463, 383, 163, 183, 203, 263, 223, 183, 183, 243, 163, 183, 323, 183, 183, 163, 183, 223, 203, 243, 203, 183, 223, 263, 403, 283, 443, 183, 183, 243, 243, 183, 163, 163, 183, 363, 303, 183, 343, 163, 203, 163, 183, 383, 483, 243, 443], "policy_default_policy_reward": [0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 13.0, 4.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 1.0, 2.0, 4.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0, 6.0, 4.0, 0.0, 0.0, 7.0, 10.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 1.0, 2.0, 5.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 9.0, 3.0, 0.0, 0.0, 3.0, 8.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 10.0, 0.0, 0.0, 15.0, 5.0, 0.0, 0.0, 6.0, 3.0, 0.0, 0.0, 12.0, 5.0, 0.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.601912015486114, "mean_inference_ms": 1.1454758858900367, "mean_action_processing_ms": 0.21166287040069687, "mean_env_wait_ms": 2.0593632258879975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008736133575439453, "StateBufferConnector_ms": 0.006239891052246094, "ViewRequirementAgentConnector_ms": 0.20310473442077637}, "num_episodes": 0, "episode_return_max": 22.0, "episode_return_min": 1.0, "episode_return_mean": 6.91, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 179312, "num_agent_steps_trained": 179312, "num_env_steps_sampled": 45056, "num_env_steps_trained": 45056, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 259.24577652517956, "num_env_steps_trained_throughput_per_sec": 259.24577652517956, "timesteps_total": 45056, "num_env_steps_sampled_lifetime": 45056, "num_agent_steps_sampled_lifetime": 179312, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 179312, "timers": {"training_iteration_time_ms": 16501.751, "restore_workers_time_ms": 0.02, "training_step_time_ms": 16501.698, "sample_time_ms": 15650.943, "load_time_ms": 0.279, "load_throughput": 1835142.41, "learn_time_ms": 842.535, "learn_throughput": 607.69, "synch_weights_time_ms": 7.707}, "counters": {"num_env_steps_sampled": 45056, "num_env_steps_trained": 45056, "num_agent_steps_sampled": 179312, "num_agent_steps_trained": 179312}, "done": false, "training_iteration": 88, "trial_id": "37af9_00000", "date": "2024-09-25_18-25-27", "timestamp": 1727288727, "time_this_iter_s": 1.9793150424957275, "time_total_s": 1419.159301996231, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1419.159301996231, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 14.766666666666666, "ram_util_percent": 36.03333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7245526222744957, "cur_kl_coeff": 1.3234889800848442e-24, "cur_lr": 2e-05, "total_loss": -0.1627731156477239, "policy_loss": -0.015473696243134327, "vf_loss": 0.07842205088236369, "vf_explained_var": 0.21316881719976663, "kl": 0.005010229042980541, "entropy": 1.6690492898225784, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27880.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 45568, "num_env_steps_trained": 45568, "num_agent_steps_sampled": 181370, "num_agent_steps_trained": 181370}, "env_runners": {"episode_reward_max": 37.0, "episode_reward_min": 1.0, "episode_reward_mean": 7.46, "episode_len_mean": 245.52, "episode_media": {}, "episodes_timesteps_total": 24552, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 27.0}, "policy_reward_mean": {"default_policy": 1.865}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0, 17.0, 14.0, 3.0, 5.0, 6.0, 9.0, 7.0, 6.0, 3.0, 7.0, 4.0, 4.0, 12.0, 6.0, 4.0, 4.0, 6.0, 6.0, 7.0, 8.0, 7.0, 3.0, 8.0, 6.0, 16.0, 10.0, 17.0, 5.0, 5.0, 8.0, 7.0, 5.0, 2.0, 2.0, 2.0, 12.0, 11.0, 3.0, 11.0, 4.0, 6.0, 4.0, 3.0, 15.0, 20.0, 9.0, 18.0, 18.0, 8.0, 37.0], "episode_lengths": [183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243, 463, 383, 163, 183, 203, 263, 223, 183, 183, 243, 163, 183, 323, 183, 183, 163, 183, 223, 203, 243, 203, 183, 223, 263, 403, 283, 443, 183, 183, 243, 243, 183, 163, 163, 183, 363, 303, 183, 343, 163, 203, 163, 183, 383, 483, 243, 443, 443, 283, 855], "policy_default_policy_reward": [3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 13.0, 4.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 1.0, 2.0, 4.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0, 6.0, 4.0, 0.0, 0.0, 7.0, 10.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 1.0, 2.0, 5.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 9.0, 3.0, 0.0, 0.0, 3.0, 8.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 10.0, 0.0, 0.0, 15.0, 5.0, 0.0, 0.0, 6.0, 3.0, 0.0, 0.0, 12.0, 5.0, 0.0, 1.0, 14.0, 4.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 27.0, 8.0, 2.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.63011887034226, "mean_inference_ms": 1.1453564435308865, "mean_action_processing_ms": 0.21146336511626923, "mean_env_wait_ms": 2.059911747372062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008619546890258789, "StateBufferConnector_ms": 0.006178379058837891, "ViewRequirementAgentConnector_ms": 0.2002260684967041}, "num_episodes": 3, "episode_return_max": 37.0, "episode_return_min": 1.0, "episode_return_mean": 7.46, "episodes_this_iter": 3}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 181370, "num_agent_steps_trained": 181370, "num_env_steps_sampled": 45568, "num_env_steps_trained": 45568, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 10.035696686476527, "num_env_steps_trained_throughput_per_sec": 10.035696686476527, "timesteps_total": 45568, "num_env_steps_sampled_lifetime": 45568, "num_agent_steps_sampled_lifetime": 181370, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 181370, "timers": {"training_iteration_time_ms": 20380.457, "restore_workers_time_ms": 0.021, "training_step_time_ms": 20380.404, "sample_time_ms": 19533.361, "load_time_ms": 0.279, "load_throughput": 1837969.572, "learn_time_ms": 838.844, "learn_throughput": 610.364, "synch_weights_time_ms": 7.685}, "counters": {"num_env_steps_sampled": 45568, "num_env_steps_trained": 45568, "num_agent_steps_sampled": 181370, "num_agent_steps_trained": 181370}, "done": false, "training_iteration": 89, "trial_id": "37af9_00000", "date": "2024-09-25_18-26-18", "timestamp": 1727288778, "time_this_iter_s": 51.022462129592896, "time_total_s": 1470.181764125824, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1470.181764125824, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 11.434246575342467, "ram_util_percent": 37.31917808219178}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7761427402030676, "cur_kl_coeff": 1.3234889800848442e-24, "cur_lr": 2e-05, "total_loss": -0.16728673268444255, "policy_loss": -0.015319471617112867, "vf_loss": 0.04700946024568111, "vf_explained_var": -0.09553983751684428, "kl": 0.014616097991764576, "entropy": 1.637196236103773, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28200.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 46080, "num_env_steps_trained": 46080, "num_agent_steps_sampled": 183418, "num_agent_steps_trained": 183418}, "env_runners": {"episode_reward_max": 37.0, "episode_reward_min": 1.0, "episode_reward_mean": 7.46, "episode_len_mean": 245.52, "episode_media": {}, "episodes_timesteps_total": 24552, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 27.0}, "policy_reward_mean": {"default_policy": 1.865}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.0, 5.0, 3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0, 17.0, 14.0, 3.0, 5.0, 6.0, 9.0, 7.0, 6.0, 3.0, 7.0, 4.0, 4.0, 12.0, 6.0, 4.0, 4.0, 6.0, 6.0, 7.0, 8.0, 7.0, 3.0, 8.0, 6.0, 16.0, 10.0, 17.0, 5.0, 5.0, 8.0, 7.0, 5.0, 2.0, 2.0, 2.0, 12.0, 11.0, 3.0, 11.0, 4.0, 6.0, 4.0, 3.0, 15.0, 20.0, 9.0, 18.0, 18.0, 8.0, 37.0], "episode_lengths": [183, 223, 163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243, 463, 383, 163, 183, 203, 263, 223, 183, 183, 243, 163, 183, 323, 183, 183, 163, 183, 223, 203, 243, 203, 183, 223, 263, 403, 283, 443, 183, 183, 243, 243, 183, 163, 163, 183, 363, 303, 183, 343, 163, 203, 163, 183, 383, 483, 243, 443, 443, 283, 855], "policy_default_policy_reward": [3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 13.0, 4.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 1.0, 2.0, 4.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0, 6.0, 4.0, 0.0, 0.0, 7.0, 10.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 1.0, 2.0, 5.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 9.0, 3.0, 0.0, 0.0, 3.0, 8.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 10.0, 0.0, 0.0, 15.0, 5.0, 0.0, 0.0, 6.0, 3.0, 0.0, 0.0, 12.0, 5.0, 0.0, 1.0, 14.0, 4.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 27.0, 8.0, 2.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.63011887034226, "mean_inference_ms": 1.1453564435308865, "mean_action_processing_ms": 0.21146336511626923, "mean_env_wait_ms": 2.059911747372062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008619546890258789, "StateBufferConnector_ms": 0.006178379058837891, "ViewRequirementAgentConnector_ms": 0.2002260684967041}, "num_episodes": 0, "episode_return_max": 37.0, "episode_return_min": 1.0, "episode_return_mean": 7.46, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 183418, "num_agent_steps_trained": 183418, "num_env_steps_sampled": 46080, "num_env_steps_trained": 46080, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 243.3631499942091, "num_env_steps_trained_throughput_per_sec": 243.3631499942091, "timesteps_total": 46080, "num_env_steps_sampled_lifetime": 46080, "num_agent_steps_sampled_lifetime": 183418, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 183418, "timers": {"training_iteration_time_ms": 18353.21, "restore_workers_time_ms": 0.02, "training_step_time_ms": 18353.159, "sample_time_ms": 17507.095, "load_time_ms": 0.271, "load_throughput": 1890390.535, "learn_time_ms": 838.333, "learn_throughput": 610.736, "synch_weights_time_ms": 7.229}, "counters": {"num_env_steps_sampled": 46080, "num_env_steps_trained": 46080, "num_agent_steps_sampled": 183418, "num_agent_steps_trained": 183418}, "done": false, "training_iteration": 90, "trial_id": "37af9_00000", "date": "2024-09-25_18-26-20", "timestamp": 1727288780, "time_this_iter_s": 2.1083850860595703, "time_total_s": 1472.2901492118835, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1472.2901492118835, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 14.033333333333333, "ram_util_percent": 36.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7677263828535233, "cur_kl_coeff": 1.3234889800848442e-24, "cur_lr": 2e-05, "total_loss": -0.1601882491080511, "policy_loss": -0.008503091254181439, "vf_loss": 0.06927864776789061, "vf_explained_var": 0.006996914455967565, "kl": 0.005827997431691573, "entropy": 1.6900481620142538, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28515.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 46592, "num_env_steps_trained": 46592, "num_agent_steps_sampled": 185453, "num_agent_steps_trained": 185453}, "env_runners": {"episode_reward_max": 37.0, "episode_reward_min": 1.0, "episode_reward_mean": 7.55, "episode_len_mean": 246.72, "episode_media": {}, "episodes_timesteps_total": 24672, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 27.0}, "policy_reward_mean": {"default_policy": 1.8875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0, 3.0, 5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0, 17.0, 14.0, 3.0, 5.0, 6.0, 9.0, 7.0, 6.0, 3.0, 7.0, 4.0, 4.0, 12.0, 6.0, 4.0, 4.0, 6.0, 6.0, 7.0, 8.0, 7.0, 3.0, 8.0, 6.0, 16.0, 10.0, 17.0, 5.0, 5.0, 8.0, 7.0, 5.0, 2.0, 2.0, 2.0, 12.0, 11.0, 3.0, 11.0, 4.0, 6.0, 4.0, 3.0, 15.0, 20.0, 9.0, 18.0, 18.0, 8.0, 37.0, 8.0, 10.0], "episode_lengths": [163, 183, 223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243, 463, 383, 163, 183, 203, 263, 223, 183, 183, 243, 163, 183, 323, 183, 183, 163, 183, 223, 203, 243, 203, 183, 223, 263, 403, 283, 443, 183, 183, 243, 243, 183, 163, 163, 183, 363, 303, 183, 343, 163, 203, 163, 183, 383, 483, 243, 443, 443, 283, 855, 243, 283], "policy_default_policy_reward": [1.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 13.0, 4.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 1.0, 2.0, 4.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0, 6.0, 4.0, 0.0, 0.0, 7.0, 10.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 1.0, 2.0, 5.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 9.0, 3.0, 0.0, 0.0, 3.0, 8.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 10.0, 0.0, 0.0, 15.0, 5.0, 0.0, 0.0, 6.0, 3.0, 0.0, 0.0, 12.0, 5.0, 0.0, 1.0, 14.0, 4.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 27.0, 8.0, 2.0, 0.0, 2.0, 6.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.6432126402176, "mean_inference_ms": 1.1452525112036613, "mean_action_processing_ms": 0.2112219557452305, "mean_env_wait_ms": 2.0604649558878325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008573293685913086, "StateBufferConnector_ms": 0.006165266036987305, "ViewRequirementAgentConnector_ms": 0.19999051094055176}, "num_episodes": 2, "episode_return_max": 37.0, "episode_return_min": 1.0, "episode_return_mean": 7.55, "episodes_this_iter": 2}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 185453, "num_agent_steps_trained": 185453, "num_env_steps_sampled": 46592, "num_env_steps_trained": 46592, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 28.3058297166841, "num_env_steps_trained_throughput_per_sec": 28.3058297166841, "timesteps_total": 46592, "num_env_steps_sampled_lifetime": 46592, "num_agent_steps_sampled_lifetime": 185453, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 185453, "timers": {"training_iteration_time_ms": 18021.844, "restore_workers_time_ms": 0.019, "training_step_time_ms": 18021.794, "sample_time_ms": 17175.423, "load_time_ms": 0.268, "load_throughput": 1907009.722, "learn_time_ms": 838.879, "learn_throughput": 610.339, "synch_weights_time_ms": 6.993}, "counters": {"num_env_steps_sampled": 46592, "num_env_steps_trained": 46592, "num_agent_steps_sampled": 185453, "num_agent_steps_trained": 185453}, "done": false, "training_iteration": 91, "trial_id": "37af9_00000", "date": "2024-09-25_18-26-38", "timestamp": 1727288798, "time_this_iter_s": 18.092537879943848, "time_total_s": 1490.3826870918274, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1490.3826870918274, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 11.953846153846154, "ram_util_percent": 37.88461538461539}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6476670617237688, "cur_kl_coeff": 1.3234889800848442e-24, "cur_lr": 2e-05, "total_loss": -0.16198611729196272, "policy_loss": -0.004195411335240351, "vf_loss": 0.04849426503715222, "vf_explained_var": -0.19539051447063685, "kl": 0.0029676511809185514, "entropy": 1.6991426799446345, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28830.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 47104, "num_env_steps_trained": 47104, "num_agent_steps_sampled": 187501, "num_agent_steps_trained": 187501}, "env_runners": {"episode_reward_max": 37.0, "episode_reward_min": 1.0, "episode_reward_mean": 7.99, "episode_len_mean": 254.72, "episode_media": {}, "episodes_timesteps_total": 25472, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 27.0}, "policy_reward_mean": {"default_policy": 1.9975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0, 3.0, 7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0, 17.0, 14.0, 3.0, 5.0, 6.0, 9.0, 7.0, 6.0, 3.0, 7.0, 4.0, 4.0, 12.0, 6.0, 4.0, 4.0, 6.0, 6.0, 7.0, 8.0, 7.0, 3.0, 8.0, 6.0, 16.0, 10.0, 17.0, 5.0, 5.0, 8.0, 7.0, 5.0, 2.0, 2.0, 2.0, 12.0, 11.0, 3.0, 11.0, 4.0, 6.0, 4.0, 3.0, 15.0, 20.0, 9.0, 18.0, 18.0, 8.0, 37.0, 8.0, 10.0, 30.0, 20.0], "episode_lengths": [223, 163, 223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243, 463, 383, 163, 183, 203, 263, 223, 183, 183, 243, 163, 183, 323, 183, 183, 163, 183, 223, 203, 243, 203, 183, 223, 263, 403, 283, 443, 183, 183, 243, 243, 183, 163, 163, 183, 363, 303, 183, 343, 163, 203, 163, 183, 383, 483, 243, 443, 443, 283, 855, 243, 283, 683, 463], "policy_default_policy_reward": [5.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 13.0, 4.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 1.0, 2.0, 4.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0, 6.0, 4.0, 0.0, 0.0, 7.0, 10.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 1.0, 2.0, 5.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 9.0, 3.0, 0.0, 0.0, 3.0, 8.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 10.0, 0.0, 0.0, 15.0, 5.0, 0.0, 0.0, 6.0, 3.0, 0.0, 0.0, 12.0, 5.0, 0.0, 1.0, 14.0, 4.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 27.0, 8.0, 2.0, 0.0, 2.0, 6.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 16.0, 14.0, 0.0, 0.0, 13.0, 7.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.64795389614549, "mean_inference_ms": 1.145254173224887, "mean_action_processing_ms": 0.21129015051568095, "mean_env_wait_ms": 2.0604762709661277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008542299270629883, "StateBufferConnector_ms": 0.006172895431518555, "ViewRequirementAgentConnector_ms": 0.19996237754821777}, "num_episodes": 2, "episode_return_max": 37.0, "episode_return_min": 1.0, "episode_return_mean": 7.99, "episodes_this_iter": 2}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 187501, "num_agent_steps_trained": 187501, "num_env_steps_sampled": 47104, "num_env_steps_trained": 47104, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 12.670558360210167, "num_env_steps_trained_throughput_per_sec": 12.670558360210167, "timesteps_total": 47104, "num_env_steps_sampled_lifetime": 47104, "num_agent_steps_sampled_lifetime": 187501, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 187501, "timers": {"training_iteration_time_ms": 20752.012, "restore_workers_time_ms": 0.018, "training_step_time_ms": 20751.965, "sample_time_ms": 19905.711, "load_time_ms": 0.267, "load_throughput": 1916198.49, "learn_time_ms": 838.769, "learn_throughput": 610.418, "synch_weights_time_ms": 6.986}, "counters": {"num_env_steps_sampled": 47104, "num_env_steps_trained": 47104, "num_agent_steps_sampled": 187501, "num_agent_steps_trained": 187501}, "done": false, "training_iteration": 92, "trial_id": "37af9_00000", "date": "2024-09-25_18-27-19", "timestamp": 1727288839, "time_this_iter_s": 40.41325879096985, "time_total_s": 1530.7959458827972, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1530.7959458827972, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 10.449122807017542, "ram_util_percent": 38.15964912280702}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6625942918471992, "cur_kl_coeff": 6.617444900424221e-25, "cur_lr": 2e-05, "total_loss": -0.16420130541082473, "policy_loss": -0.005017204576870426, "vf_loss": 0.03989982271450572, "vf_explained_var": 0.02709714137017727, "kl": 0.0015315117793520071, "entropy": 1.6915905218571425, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29150.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 47616, "num_env_steps_trained": 47616, "num_agent_steps_sampled": 189549, "num_agent_steps_trained": 189549}, "env_runners": {"episode_reward_max": 37.0, "episode_reward_min": 1.0, "episode_reward_mean": 8.01, "episode_len_mean": 254.12, "episode_media": {}, "episodes_timesteps_total": 25412, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 27.0}, "policy_reward_mean": {"default_policy": 2.0025}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.0, 2.0, 22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0, 17.0, 14.0, 3.0, 5.0, 6.0, 9.0, 7.0, 6.0, 3.0, 7.0, 4.0, 4.0, 12.0, 6.0, 4.0, 4.0, 6.0, 6.0, 7.0, 8.0, 7.0, 3.0, 8.0, 6.0, 16.0, 10.0, 17.0, 5.0, 5.0, 8.0, 7.0, 5.0, 2.0, 2.0, 2.0, 12.0, 11.0, 3.0, 11.0, 4.0, 6.0, 4.0, 3.0, 15.0, 20.0, 9.0, 18.0, 18.0, 8.0, 37.0, 8.0, 10.0, 30.0, 20.0, 5.0, 5.0], "episode_lengths": [223, 163, 543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243, 463, 383, 163, 183, 203, 263, 223, 183, 183, 243, 163, 183, 323, 183, 183, 163, 183, 223, 203, 243, 203, 183, 223, 263, 403, 283, 443, 183, 183, 243, 243, 183, 163, 163, 183, 363, 303, 183, 343, 163, 203, 163, 183, 383, 483, 243, 443, 443, 283, 855, 243, 283, 683, 463, 163, 163], "policy_default_policy_reward": [5.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 13.0, 4.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 1.0, 2.0, 4.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0, 6.0, 4.0, 0.0, 0.0, 7.0, 10.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 1.0, 2.0, 5.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 9.0, 3.0, 0.0, 0.0, 3.0, 8.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 10.0, 0.0, 0.0, 15.0, 5.0, 0.0, 0.0, 6.0, 3.0, 0.0, 0.0, 12.0, 5.0, 0.0, 1.0, 14.0, 4.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 27.0, 8.0, 2.0, 0.0, 2.0, 6.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 16.0, 14.0, 0.0, 0.0, 13.0, 7.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.63457833663947, "mean_inference_ms": 1.1452096796311457, "mean_action_processing_ms": 0.211108583140249, "mean_env_wait_ms": 2.0608385152235416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00853109359741211, "StateBufferConnector_ms": 0.006158113479614258, "ViewRequirementAgentConnector_ms": 0.1998910903930664}, "num_episodes": 2, "episode_return_max": 37.0, "episode_return_min": 1.0, "episode_return_mean": 8.01, "episodes_this_iter": 2}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 189549, "num_agent_steps_trained": 189549, "num_env_steps_sampled": 47616, "num_env_steps_trained": 47616, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 46.513500129090836, "num_env_steps_trained_throughput_per_sec": 46.513500129090836, "timesteps_total": 47616, "num_env_steps_sampled_lifetime": 47616, "num_agent_steps_sampled_lifetime": 189549, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 189549, "timers": {"training_iteration_time_ms": 20634.395, "restore_workers_time_ms": 0.017, "training_step_time_ms": 20634.35, "sample_time_ms": 19788.033, "load_time_ms": 0.274, "load_throughput": 1867214.719, "learn_time_ms": 838.454, "learn_throughput": 610.648, "synch_weights_time_ms": 7.361}, "counters": {"num_env_steps_sampled": 47616, "num_env_steps_trained": 47616, "num_agent_steps_sampled": 189549, "num_agent_steps_trained": 189549}, "done": false, "training_iteration": 93, "trial_id": "37af9_00000", "date": "2024-09-25_18-27-30", "timestamp": 1727288850, "time_this_iter_s": 11.010594129562378, "time_total_s": 1541.8065400123596, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1541.8065400123596, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 11.68125, "ram_util_percent": 37.7125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6708143298904742, "cur_kl_coeff": 3.3087224502121104e-25, "cur_lr": 2e-05, "total_loss": -0.15633913305618108, "policy_loss": -0.0023330179628946127, "vf_loss": 0.059467942788145475, "vf_explained_var": -0.002429105389502741, "kl": 0.004119244542359792, "entropy": 1.6887309808884898, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29465.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 48128, "num_env_steps_trained": 48128, "num_agent_steps_sampled": 191586, "num_agent_steps_trained": 191586}, "env_runners": {"episode_reward_max": 37.0, "episode_reward_min": 1.0, "episode_reward_mean": 8.08, "episode_len_mean": 255.52, "episode_media": {}, "episodes_timesteps_total": 25552, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 27.0}, "policy_reward_mean": {"default_policy": 2.02}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.0, 4.0, 4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0, 17.0, 14.0, 3.0, 5.0, 6.0, 9.0, 7.0, 6.0, 3.0, 7.0, 4.0, 4.0, 12.0, 6.0, 4.0, 4.0, 6.0, 6.0, 7.0, 8.0, 7.0, 3.0, 8.0, 6.0, 16.0, 10.0, 17.0, 5.0, 5.0, 8.0, 7.0, 5.0, 2.0, 2.0, 2.0, 12.0, 11.0, 3.0, 11.0, 4.0, 6.0, 4.0, 3.0, 15.0, 20.0, 9.0, 18.0, 18.0, 8.0, 37.0, 8.0, 10.0, 30.0, 20.0, 5.0, 5.0, 13.0, 3.0], "episode_lengths": [543, 163, 163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243, 463, 383, 163, 183, 203, 263, 223, 183, 183, 243, 163, 183, 323, 183, 183, 163, 183, 223, 203, 243, 203, 183, 223, 263, 403, 283, 443, 183, 183, 243, 243, 183, 163, 163, 183, 363, 303, 183, 343, 163, 203, 163, 183, 383, 483, 243, 443, 443, 283, 855, 243, 283, 683, 463, 163, 163, 363, 163], "policy_default_policy_reward": [10.0, 12.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 13.0, 4.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 1.0, 2.0, 4.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0, 6.0, 4.0, 0.0, 0.0, 7.0, 10.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 1.0, 2.0, 5.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 9.0, 3.0, 0.0, 0.0, 3.0, 8.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 10.0, 0.0, 0.0, 15.0, 5.0, 0.0, 0.0, 6.0, 3.0, 0.0, 0.0, 12.0, 5.0, 0.0, 1.0, 14.0, 4.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 27.0, 8.0, 2.0, 0.0, 2.0, 6.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 16.0, 14.0, 0.0, 0.0, 13.0, 7.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.65050624017587, "mean_inference_ms": 1.14465054289955, "mean_action_processing_ms": 0.2110084594242441, "mean_env_wait_ms": 2.060990783232006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008513212203979492, "StateBufferConnector_ms": 0.006135702133178711, "ViewRequirementAgentConnector_ms": 0.1992950439453125}, "num_episodes": 2, "episode_return_max": 37.0, "episode_return_min": 1.0, "episode_return_mean": 8.08, "episodes_this_iter": 2}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 191586, "num_agent_steps_trained": 191586, "num_env_steps_sampled": 48128, "num_env_steps_trained": 48128, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 21.983808921727167, "num_env_steps_trained_throughput_per_sec": 21.983808921727167, "timesteps_total": 48128, "num_env_steps_sampled_lifetime": 48128, "num_agent_steps_sampled_lifetime": 191586, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 191586, "timers": {"training_iteration_time_ms": 20594.026, "restore_workers_time_ms": 0.016, "training_step_time_ms": 20593.981, "sample_time_ms": 19749.602, "load_time_ms": 0.264, "load_throughput": 1940088.218, "learn_time_ms": 836.592, "learn_throughput": 612.006, "synch_weights_time_ms": 7.292}, "counters": {"num_env_steps_sampled": 48128, "num_env_steps_trained": 48128, "num_agent_steps_sampled": 191586, "num_agent_steps_trained": 191586}, "done": false, "training_iteration": 94, "trial_id": "37af9_00000", "date": "2024-09-25_18-27-53", "timestamp": 1727288873, "time_this_iter_s": 23.293639183044434, "time_total_s": 1565.100179195404, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1565.100179195404, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 9.93939393939394, "ram_util_percent": 38.40909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7613637811954944, "cur_kl_coeff": 1.6543612251060552e-25, "cur_lr": 2e-05, "total_loss": -0.16039985070425655, "policy_loss": -0.009981498144747268, "vf_loss": 0.06952462434625974, "vf_explained_var": 0.11829094002323766, "kl": 0.004380306445182031, "entropy": 1.6779950291879715, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29775.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 48640, "num_env_steps_trained": 48640, "num_agent_steps_sampled": 193616, "num_agent_steps_trained": 193616}, "env_runners": {"episode_reward_max": 37.0, "episode_reward_min": 1.0, "episode_reward_mean": 7.9, "episode_len_mean": 251.92, "episode_media": {}, "episodes_timesteps_total": 25192, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 27.0}, "policy_reward_mean": {"default_policy": 1.975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0, 17.0, 14.0, 3.0, 5.0, 6.0, 9.0, 7.0, 6.0, 3.0, 7.0, 4.0, 4.0, 12.0, 6.0, 4.0, 4.0, 6.0, 6.0, 7.0, 8.0, 7.0, 3.0, 8.0, 6.0, 16.0, 10.0, 17.0, 5.0, 5.0, 8.0, 7.0, 5.0, 2.0, 2.0, 2.0, 12.0, 11.0, 3.0, 11.0, 4.0, 6.0, 4.0, 3.0, 15.0, 20.0, 9.0, 18.0, 18.0, 8.0, 37.0, 8.0, 10.0, 30.0, 20.0, 5.0, 5.0, 13.0, 3.0, 3.0, 5.0], "episode_lengths": [163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243, 463, 383, 163, 183, 203, 263, 223, 183, 183, 243, 163, 183, 323, 183, 183, 163, 183, 223, 203, 243, 203, 183, 223, 263, 403, 283, 443, 183, 183, 243, 243, 183, 163, 163, 183, 363, 303, 183, 343, 163, 203, 163, 183, 383, 483, 243, 443, 443, 283, 855, 243, 283, 683, 463, 163, 163, 363, 163, 163, 183], "policy_default_policy_reward": [1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 13.0, 4.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 1.0, 2.0, 4.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0, 6.0, 4.0, 0.0, 0.0, 7.0, 10.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 1.0, 2.0, 5.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 9.0, 3.0, 0.0, 0.0, 3.0, 8.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 10.0, 0.0, 0.0, 15.0, 5.0, 0.0, 0.0, 6.0, 3.0, 0.0, 0.0, 12.0, 5.0, 0.0, 1.0, 14.0, 4.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 27.0, 8.0, 2.0, 0.0, 2.0, 6.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 16.0, 14.0, 0.0, 0.0, 13.0, 7.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.676840755194014, "mean_inference_ms": 1.144202527421081, "mean_action_processing_ms": 0.21071014771300306, "mean_env_wait_ms": 2.0613541904698263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008463382720947266, "StateBufferConnector_ms": 0.006118059158325195, "ViewRequirementAgentConnector_ms": 0.19853711128234863}, "num_episodes": 2, "episode_return_max": 37.0, "episode_return_min": 1.0, "episode_return_mean": 7.9, "episodes_this_iter": 2}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 193616, "num_agent_steps_trained": 193616, "num_env_steps_sampled": 48640, "num_env_steps_trained": 48640, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 41.88422783609725, "num_env_steps_trained_throughput_per_sec": 41.88422783609725, "timesteps_total": 48640, "num_env_steps_sampled_lifetime": 48640, "num_agent_steps_sampled_lifetime": 193616, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 193616, "timers": {"training_iteration_time_ms": 21609.142, "restore_workers_time_ms": 0.016, "training_step_time_ms": 21609.1, "sample_time_ms": 20763.977, "load_time_ms": 0.268, "load_throughput": 1907179.083, "learn_time_ms": 837.231, "learn_throughput": 611.54, "synch_weights_time_ms": 7.391}, "counters": {"num_env_steps_sampled": 48640, "num_env_steps_trained": 48640, "num_agent_steps_sampled": 193616, "num_agent_steps_trained": 193616}, "done": false, "training_iteration": 95, "trial_id": "37af9_00000", "date": "2024-09-25_18-28-05", "timestamp": 1727288885, "time_this_iter_s": 12.227964401245117, "time_total_s": 1577.3281435966492, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1577.3281435966492, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 12.829411764705881, "ram_util_percent": 37.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7304664410185069, "cur_kl_coeff": 8.271806125530276e-26, "cur_lr": 2e-05, "total_loss": -0.1611779304788797, "policy_loss": -0.0037294415349606426, "vf_loss": 0.04114431319976575, "vf_explained_var": -0.1950252765789628, "kl": 0.0016441470737170506, "entropy": 1.677345609664917, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30090.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 49152, "num_env_steps_trained": 49152, "num_agent_steps_sampled": 195664, "num_agent_steps_trained": 195664}, "env_runners": {"episode_reward_max": 37.0, "episode_reward_min": 1.0, "episode_reward_mean": 7.9, "episode_len_mean": 251.92, "episode_media": {}, "episodes_timesteps_total": 25192, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 27.0}, "policy_reward_mean": {"default_policy": 1.975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.0, 4.0, 5.0, 14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0, 17.0, 14.0, 3.0, 5.0, 6.0, 9.0, 7.0, 6.0, 3.0, 7.0, 4.0, 4.0, 12.0, 6.0, 4.0, 4.0, 6.0, 6.0, 7.0, 8.0, 7.0, 3.0, 8.0, 6.0, 16.0, 10.0, 17.0, 5.0, 5.0, 8.0, 7.0, 5.0, 2.0, 2.0, 2.0, 12.0, 11.0, 3.0, 11.0, 4.0, 6.0, 4.0, 3.0, 15.0, 20.0, 9.0, 18.0, 18.0, 8.0, 37.0, 8.0, 10.0, 30.0, 20.0, 5.0, 5.0, 13.0, 3.0, 3.0, 5.0], "episode_lengths": [163, 163, 183, 323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243, 463, 383, 163, 183, 203, 263, 223, 183, 183, 243, 163, 183, 323, 183, 183, 163, 183, 223, 203, 243, 203, 183, 223, 263, 403, 283, 443, 183, 183, 243, 243, 183, 163, 163, 183, 363, 303, 183, 343, 163, 203, 163, 183, 383, 483, 243, 443, 443, 283, 855, 243, 283, 683, 463, 163, 163, 363, 163, 163, 183], "policy_default_policy_reward": [1.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 13.0, 4.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 1.0, 2.0, 4.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0, 6.0, 4.0, 0.0, 0.0, 7.0, 10.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 1.0, 2.0, 5.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 9.0, 3.0, 0.0, 0.0, 3.0, 8.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 10.0, 0.0, 0.0, 15.0, 5.0, 0.0, 0.0, 6.0, 3.0, 0.0, 0.0, 12.0, 5.0, 0.0, 1.0, 14.0, 4.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 27.0, 8.0, 2.0, 0.0, 2.0, 6.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 16.0, 14.0, 0.0, 0.0, 13.0, 7.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.676840755194014, "mean_inference_ms": 1.144202527421081, "mean_action_processing_ms": 0.21071014771300306, "mean_env_wait_ms": 2.0613541904698263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008463382720947266, "StateBufferConnector_ms": 0.006118059158325195, "ViewRequirementAgentConnector_ms": 0.19853711128234863}, "num_episodes": 0, "episode_return_max": 37.0, "episode_return_min": 1.0, "episode_return_mean": 7.9, "episodes_this_iter": 0}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 195664, "num_agent_steps_trained": 195664, "num_env_steps_sampled": 49152, "num_env_steps_trained": 49152, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 243.4896658117157, "num_env_steps_trained_throughput_per_sec": 243.4896658117157, "timesteps_total": 49152, "num_env_steps_sampled_lifetime": 49152, "num_agent_steps_sampled_lifetime": 195664, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 195664, "timers": {"training_iteration_time_ms": 18864.639, "restore_workers_time_ms": 0.015, "training_step_time_ms": 18864.597, "sample_time_ms": 18016.28, "load_time_ms": 0.259, "load_throughput": 1977789.324, "learn_time_ms": 840.708, "learn_throughput": 609.01, "synch_weights_time_ms": 7.123}, "counters": {"num_env_steps_sampled": 49152, "num_env_steps_trained": 49152, "num_agent_steps_sampled": 195664, "num_agent_steps_trained": 195664}, "done": false, "training_iteration": 96, "trial_id": "37af9_00000", "date": "2024-09-25_18-28-07", "timestamp": 1727288887, "time_this_iter_s": 2.1063239574432373, "time_total_s": 1579.4344675540924, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1579.4344675540924, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 14.266666666666667, "ram_util_percent": 36.833333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6065382977714762, "cur_kl_coeff": 4.135903062765138e-26, "cur_lr": 2e-05, "total_loss": -0.16670295053627343, "policy_loss": -0.009766151671647095, "vf_loss": 0.039343606928377996, "vf_explained_var": 0.03241817373782396, "kl": 0.009745499822805991, "entropy": 1.667726979032159, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30410.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 49664, "num_env_steps_trained": 49664, "num_agent_steps_sampled": 197712, "num_agent_steps_trained": 197712}, "env_runners": {"episode_reward_max": 37.0, "episode_reward_min": 1.0, "episode_reward_mean": 8.11, "episode_len_mean": 256.32, "episode_media": {}, "episodes_timesteps_total": 25632, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 27.0}, "policy_reward_mean": {"default_policy": 2.0275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.0, 20.0, 5.0, 4.0, 6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0, 17.0, 14.0, 3.0, 5.0, 6.0, 9.0, 7.0, 6.0, 3.0, 7.0, 4.0, 4.0, 12.0, 6.0, 4.0, 4.0, 6.0, 6.0, 7.0, 8.0, 7.0, 3.0, 8.0, 6.0, 16.0, 10.0, 17.0, 5.0, 5.0, 8.0, 7.0, 5.0, 2.0, 2.0, 2.0, 12.0, 11.0, 3.0, 11.0, 4.0, 6.0, 4.0, 3.0, 15.0, 20.0, 9.0, 18.0, 18.0, 8.0, 37.0, 8.0, 10.0, 30.0, 20.0, 5.0, 5.0, 13.0, 3.0, 3.0, 5.0, 3.0, 6.0, 25.0], "episode_lengths": [323, 503, 183, 183, 243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243, 463, 383, 163, 183, 203, 263, 223, 183, 183, 243, 163, 183, 323, 183, 183, 163, 183, 223, 203, 243, 203, 183, 223, 263, 403, 283, 443, 183, 183, 243, 243, 183, 163, 163, 183, 363, 303, 183, 343, 163, 203, 163, 183, 383, 483, 243, 443, 443, 283, 855, 243, 283, 683, 463, 163, 163, 363, 163, 163, 183, 163, 183, 603], "policy_default_policy_reward": [7.0, 7.0, 0.0, 0.0, 14.0, 4.0, 1.0, 1.0, 2.0, 3.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 13.0, 4.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 1.0, 2.0, 4.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0, 6.0, 4.0, 0.0, 0.0, 7.0, 10.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 1.0, 2.0, 5.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 9.0, 3.0, 0.0, 0.0, 3.0, 8.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 10.0, 0.0, 0.0, 15.0, 5.0, 0.0, 0.0, 6.0, 3.0, 0.0, 0.0, 12.0, 5.0, 0.0, 1.0, 14.0, 4.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 27.0, 8.0, 2.0, 0.0, 2.0, 6.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 16.0, 14.0, 0.0, 0.0, 13.0, 7.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 18.0, 7.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.71666494433024, "mean_inference_ms": 1.1434726721403874, "mean_action_processing_ms": 0.21069434978256216, "mean_env_wait_ms": 2.061324886530803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008430719375610352, "StateBufferConnector_ms": 0.0061092376708984375, "ViewRequirementAgentConnector_ms": 0.19813895225524902}, "num_episodes": 3, "episode_return_max": 37.0, "episode_return_min": 1.0, "episode_return_mean": 8.11, "episodes_this_iter": 3}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 197712, "num_agent_steps_trained": 197712, "num_env_steps_sampled": 49664, "num_env_steps_trained": 49664, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 14.0812296094784, "num_env_steps_trained_throughput_per_sec": 14.0812296094784, "timesteps_total": 49664, "num_env_steps_sampled_lifetime": 49664, "num_agent_steps_sampled_lifetime": 197712, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 197712, "timers": {"training_iteration_time_ms": 19857.838, "restore_workers_time_ms": 0.015, "training_step_time_ms": 19857.797, "sample_time_ms": 19006.888, "load_time_ms": 0.245, "load_throughput": 2092044.47, "learn_time_ms": 843.527, "learn_throughput": 606.975, "synch_weights_time_ms": 6.912}, "counters": {"num_env_steps_sampled": 49664, "num_env_steps_trained": 49664, "num_agent_steps_sampled": 197712, "num_agent_steps_trained": 197712}, "done": false, "training_iteration": 97, "trial_id": "37af9_00000", "date": "2024-09-25_18-28-44", "timestamp": 1727288924, "time_this_iter_s": 36.36333608627319, "time_total_s": 1615.7978036403656, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1615.7978036403656, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 10.45576923076923, "ram_util_percent": 37.123076923076916}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5788092826643297, "cur_kl_coeff": 4.135903062765138e-26, "cur_lr": 2e-05, "total_loss": -0.14904924873863498, "policy_loss": 0.010107230844216481, "vf_loss": 0.036462629514731344, "vf_explained_var": 0.5235581069223343, "kl": 0.002597270533865889, "entropy": 1.6827213083544086, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30725.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 50176, "num_env_steps_trained": 50176, "num_agent_steps_sampled": 199747, "num_agent_steps_trained": 199747}, "env_runners": {"episode_reward_max": 37.0, "episode_reward_min": 0.0, "episode_reward_mean": 8.0, "episode_len_mean": 255.92, "episode_media": {}, "episodes_timesteps_total": 25592, "policy_reward_min": {"default_policy": 0.0}, "policy_reward_max": {"default_policy": 27.0}, "policy_reward_mean": {"default_policy": 2.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.0, 5.0, 8.0, 6.0, 10.0, 7.0, 1.0, 5.0, 13.0, 5.0, 4.0, 5.0, 9.0, 15.0, 13.0, 6.0, 4.0, 3.0, 4.0, 12.0, 4.0, 10.0, 2.0, 10.0, 1.0, 6.0, 4.0, 7.0, 4.0, 6.0, 2.0, 10.0, 5.0, 17.0, 14.0, 3.0, 5.0, 6.0, 9.0, 7.0, 6.0, 3.0, 7.0, 4.0, 4.0, 12.0, 6.0, 4.0, 4.0, 6.0, 6.0, 7.0, 8.0, 7.0, 3.0, 8.0, 6.0, 16.0, 10.0, 17.0, 5.0, 5.0, 8.0, 7.0, 5.0, 2.0, 2.0, 2.0, 12.0, 11.0, 3.0, 11.0, 4.0, 6.0, 4.0, 3.0, 15.0, 20.0, 9.0, 18.0, 18.0, 8.0, 37.0, 8.0, 10.0, 30.0, 20.0, 5.0, 5.0, 13.0, 3.0, 3.0, 5.0, 3.0, 6.0, 25.0, 28.0, 2.0, 2.0, 0.0], "episode_lengths": [243, 163, 243, 203, 303, 203, 163, 203, 403, 223, 223, 163, 263, 383, 323, 163, 183, 163, 203, 383, 163, 283, 163, 243, 163, 223, 183, 223, 163, 203, 163, 283, 243, 463, 383, 163, 183, 203, 263, 223, 183, 183, 243, 163, 183, 323, 183, 183, 163, 183, 223, 203, 243, 203, 183, 223, 263, 403, 283, 443, 183, 183, 243, 243, 183, 163, 163, 183, 363, 303, 183, 343, 163, 203, 163, 183, 383, 483, 243, 443, 443, 283, 855, 243, 283, 683, 463, 163, 163, 363, 163, 163, 183, 163, 183, 603, 643, 183, 163, 163], "policy_default_policy_reward": [1.0, 5.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 2.0, 6.0, 0.0, 1.0, 7.0, 8.0, 0.0, 0.0, 7.0, 5.0, 0.0, 1.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 7.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 13.0, 4.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 4.0, 2.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 2.0, 0.0, 1.0, 2.0, 4.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0, 6.0, 4.0, 0.0, 0.0, 7.0, 10.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 1.0, 3.0, 0.0, 1.0, 2.0, 5.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 9.0, 3.0, 0.0, 0.0, 3.0, 8.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 5.0, 6.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 4.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 10.0, 0.0, 0.0, 15.0, 5.0, 0.0, 0.0, 6.0, 3.0, 0.0, 0.0, 12.0, 5.0, 0.0, 1.0, 14.0, 4.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 27.0, 8.0, 2.0, 0.0, 2.0, 6.0, 0.0, 0.0, 7.0, 3.0, 0.0, 0.0, 16.0, 14.0, 0.0, 0.0, 13.0, 7.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 18.0, 7.0, 0.0, 0.0, 17.0, 11.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 60.74657888567267, "mean_inference_ms": 1.142933795426093, "mean_action_processing_ms": 0.2102748475029695, "mean_env_wait_ms": 2.061654612673529, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008477449417114258, "StateBufferConnector_ms": 0.006081819534301758, "ViewRequirementAgentConnector_ms": 0.1971874237060547}, "num_episodes": 4, "episode_return_max": 37.0, "episode_return_min": 0.0, "episode_return_mean": 8.0, "episodes_this_iter": 4}, "num_healthy_workers": 4, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 199747, "num_agent_steps_trained": 199747, "num_env_steps_sampled": 50176, "num_env_steps_trained": 50176, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 13.324143552431345, "num_env_steps_trained_throughput_per_sec": 13.324143552431345, "timesteps_total": 50176, "num_env_steps_sampled_lifetime": 50176, "num_agent_steps_sampled_lifetime": 199747, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 199747, "timers": {"training_iteration_time_ms": 23502.99, "restore_workers_time_ms": 0.014, "training_step_time_ms": 23502.952, "sample_time_ms": 22648.254, "load_time_ms": 0.251, "load_throughput": 2036881.009, "learn_time_ms": 847.409, "learn_throughput": 604.194, "synch_weights_time_ms": 6.81}, "counters": {"num_env_steps_sampled": 50176, "num_env_steps_trained": 50176, "num_agent_steps_sampled": 199747, "num_agent_steps_trained": 199747}, "done": true, "training_iteration": 98, "trial_id": "37af9_00000", "date": "2024-09-25_18-29-22", "timestamp": 1727288962, "time_this_iter_s": 38.43077325820923, "time_total_s": 1654.2285768985748, "pid": 12279, "hostname": "03067f08a5d7", "node_ip": "172.30.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "knights_archers_zombies_v10", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7211569b25f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'app.callbacks.CustomLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1654.2285768985748, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 10.93272727272727, "ram_util_percent": 37.661818181818184}}
